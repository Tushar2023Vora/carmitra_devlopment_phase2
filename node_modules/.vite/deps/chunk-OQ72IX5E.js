// node_modules/@sendbird/chat/lib/__bundle-b80efdee.js
var e = function(t2, n2) {
  return e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(e2, t3) {
    e2.__proto__ = t3;
  } || function(e2, t3) {
    for (var n3 in t3) Object.prototype.hasOwnProperty.call(t3, n3) && (e2[n3] = t3[n3]);
  }, e(t2, n2);
};
function t(t2, n2) {
  if ("function" != typeof n2 && null !== n2) throw new TypeError("Class extends value " + String(n2) + " is not a constructor or null");
  function i2() {
    this.constructor = t2;
  }
  e(t2, n2), t2.prototype = null === n2 ? Object.create(n2) : (i2.prototype = n2.prototype, new i2());
}
var n = function() {
  return n = Object.assign || function(e2) {
    for (var t2, n2 = 1, i2 = arguments.length; n2 < i2; n2++) for (var r2 in t2 = arguments[n2]) Object.prototype.hasOwnProperty.call(t2, r2) && (e2[r2] = t2[r2]);
    return e2;
  }, n.apply(this, arguments);
};
function i(e2, t2) {
  var n2 = {};
  for (var i2 in e2) Object.prototype.hasOwnProperty.call(e2, i2) && t2.indexOf(i2) < 0 && (n2[i2] = e2[i2]);
  if (null != e2 && "function" == typeof Object.getOwnPropertySymbols) {
    var r2 = 0;
    for (i2 = Object.getOwnPropertySymbols(e2); r2 < i2.length; r2++) t2.indexOf(i2[r2]) < 0 && Object.prototype.propertyIsEnumerable.call(e2, i2[r2]) && (n2[i2[r2]] = e2[i2[r2]]);
  }
  return n2;
}
function r(e2, t2, n2, i2) {
  return new (n2 || (n2 = Promise))(function(r2, s2) {
    function o2(e3) {
      try {
        c2(i2.next(e3));
      } catch (e4) {
        s2(e4);
      }
    }
    function a2(e3) {
      try {
        c2(i2.throw(e3));
      } catch (e4) {
        s2(e4);
      }
    }
    function c2(e3) {
      var t3;
      e3.done ? r2(e3.value) : (t3 = e3.value, t3 instanceof n2 ? t3 : new n2(function(e4) {
        e4(t3);
      })).then(o2, a2);
    }
    c2((i2 = i2.apply(e2, t2 || [])).next());
  });
}
function s(e2, t2) {
  var n2, i2, r2, s2, o2 = { label: 0, sent: function() {
    if (1 & r2[0]) throw r2[1];
    return r2[1];
  }, trys: [], ops: [] };
  return s2 = { next: a2(0), throw: a2(1), return: a2(2) }, "function" == typeof Symbol && (s2[Symbol.iterator] = function() {
    return this;
  }), s2;
  function a2(a3) {
    return function(c2) {
      return function(a4) {
        if (n2) throw new TypeError("Generator is already executing.");
        for (; s2 && (s2 = 0, a4[0] && (o2 = 0)), o2; ) try {
          if (n2 = 1, i2 && (r2 = 2 & a4[0] ? i2.return : a4[0] ? i2.throw || ((r2 = i2.return) && r2.call(i2), 0) : i2.next) && !(r2 = r2.call(i2, a4[1])).done) return r2;
          switch (i2 = 0, r2 && (a4 = [2 & a4[0], r2.value]), a4[0]) {
            case 0:
            case 1:
              r2 = a4;
              break;
            case 4:
              return o2.label++, { value: a4[1], done: false };
            case 5:
              o2.label++, i2 = a4[1], a4 = [0];
              continue;
            case 7:
              a4 = o2.ops.pop(), o2.trys.pop();
              continue;
            default:
              if (!(r2 = o2.trys, (r2 = r2.length > 0 && r2[r2.length - 1]) || 6 !== a4[0] && 2 !== a4[0])) {
                o2 = 0;
                continue;
              }
              if (3 === a4[0] && (!r2 || a4[1] > r2[0] && a4[1] < r2[3])) {
                o2.label = a4[1];
                break;
              }
              if (6 === a4[0] && o2.label < r2[1]) {
                o2.label = r2[1], r2 = a4;
                break;
              }
              if (r2 && o2.label < r2[2]) {
                o2.label = r2[2], o2.ops.push(a4);
                break;
              }
              r2[2] && o2.ops.pop(), o2.trys.pop();
              continue;
          }
          a4 = t2.call(e2, o2);
        } catch (e3) {
          a4 = [6, e3], i2 = 0;
        } finally {
          n2 = r2 = 0;
        }
        if (5 & a4[0]) throw a4[1];
        return { value: a4[0] ? a4[1] : void 0, done: true };
      }([a3, c2]);
    };
  }
}
function o(e2) {
  var t2 = "function" == typeof Symbol && Symbol.iterator, n2 = t2 && e2[t2], i2 = 0;
  if (n2) return n2.call(e2);
  if (e2 && "number" == typeof e2.length) return { next: function() {
    return e2 && i2 >= e2.length && (e2 = void 0), { value: e2 && e2[i2++], done: !e2 };
  } };
  throw new TypeError(t2 ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function a(e2, t2) {
  var n2 = "function" == typeof Symbol && e2[Symbol.iterator];
  if (!n2) return e2;
  var i2, r2, s2 = n2.call(e2), o2 = [];
  try {
    for (; (void 0 === t2 || t2-- > 0) && !(i2 = s2.next()).done; ) o2.push(i2.value);
  } catch (e3) {
    r2 = { error: e3 };
  } finally {
    try {
      i2 && !i2.done && (n2 = s2.return) && n2.call(s2);
    } finally {
      if (r2) throw r2.error;
    }
  }
  return o2;
}
function c(e2, t2, n2) {
  if (n2 || 2 === arguments.length) for (var i2, r2 = 0, s2 = t2.length; r2 < s2; r2++) !i2 && r2 in t2 || (i2 || (i2 = Array.prototype.slice.call(t2, 0, r2)), i2[r2] = t2[r2]);
  return e2.concat(i2 || Array.prototype.slice.call(t2));
}
var u;
var l = "4.14.1";
var h = function() {
  function e2() {
  }
  return Object.defineProperty(e2, "OS_VERSION", { get: function() {
    return "undefined" != typeof navigator && navigator.userAgent ? navigator.userAgent.replace(/,/g, ".") : "noAgent";
  }, enumerable: false, configurable: true }), Object.defineProperty(e2, "SDK_VERSION", { get: function() {
    return l;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2, "SDK_MAJOR_VERSION", { get: function() {
    return e2.SDK_VERSION.split(".")[0];
  }, enumerable: false, configurable: true }), Object.defineProperty(e2, "DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL", { get: function() {
    return 100;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2, "INTERNAL_CALL", { get: function() {
    return "ic";
  }, enumerable: false, configurable: true }), e2;
}();
!function(e2) {
  e2[e2.NON_AUTHORIZED = 400108] = "NON_AUTHORIZED", e2[e2.INVALID_TOKEN = 400111] = "INVALID_TOKEN", e2[e2.NOT_FOUND_IN_DATABASE = 400201] = "NOT_FOUND_IN_DATABASE", e2[e2.USER_AUTH_DEACTIVATED = 400300] = "USER_AUTH_DEACTIVATED", e2[e2.USER_AUTH_DELETED_OR_NOT_FOUND = 400301] = "USER_AUTH_DELETED_OR_NOT_FOUND", e2[e2.SESSION_TOKEN_EXPIRED = 400302] = "SESSION_TOKEN_EXPIRED", e2[e2.APPLICATION_NOT_FOUND = 400304] = "APPLICATION_NOT_FOUND", e2[e2.SESSION_KEY_EXPIRED = 400309] = "SESSION_KEY_EXPIRED", e2[e2.SESSION_REVOKED = 400310] = "SESSION_REVOKED", e2[e2.INVALID_SESSION_TYPE = 400312] = "INVALID_SESSION_TYPE", e2[e2.INVALID_AUTH_FOR_SERVICE = 400313] = "INVALID_AUTH_FOR_SERVICE", e2[e2.STAT_UPLOAD_NOT_ALLOWED = 403200] = "STAT_UPLOAD_NOT_ALLOWED", e2[e2.NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE = 400940] = "NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE", e2[e2.INTERNAL_SERVER_ERROR = 500901] = "INTERNAL_SERVER_ERROR", e2[e2.RATE_LIMIT_EXCEEDED = 500910] = "RATE_LIMIT_EXCEEDED", e2[e2.INVALID_REQUIRED_FORM_VALUE = 400105] = "INVALID_REQUIRED_FORM_VALUE", e2[e2.UNKNOWN_SERVER_ERROR = 900200] = "UNKNOWN_SERVER_ERROR", e2[e2.NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE = 901500] = "NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE", e2[e2.ERR_DUPLICATED_DATA = 400202] = "ERR_DUPLICATED_DATA", e2[e2.DEBUG_MODE_REQUIRED = 7e5] = "DEBUG_MODE_REQUIRED", e2[e2.LOST_INSTANCE = 700100] = "LOST_INSTANCE", e2[e2.CONNECTION_RENEW = 700102] = "CONNECTION_RENEW", e2[e2.INVALID_CONNECTION_STATE_TRANSITION = 700200] = "INVALID_CONNECTION_STATE_TRANSITION", e2[e2.INVALID_COMMAND = 700700] = "INVALID_COMMAND", e2[e2.XMLHTTPREQUEST_NOT_SUPPORTED = 700800] = "XMLHTTPREQUEST_NOT_SUPPORTED", e2[e2.UNKNOWN_ERROR = 77e4] = "UNKNOWN_ERROR", e2[e2.INVALID_INITIALIZATION = 800100] = "INVALID_INITIALIZATION", e2[e2.CONNECTION_REQUIRED = 800101] = "CONNECTION_REQUIRED", e2[e2.CONNECTION_CANCELED = 800102] = "CONNECTION_CANCELED", e2[e2.INVALID_PARAMETER = 800110] = "INVALID_PARAMETER", e2[e2.NOT_SUPPORTED_ERROR = 800111] = "NOT_SUPPORTED_ERROR", e2[e2.NETWORK_ERROR = 800120] = "NETWORK_ERROR", e2[e2.NETWORK_ROUTING_ERROR = 800121] = "NETWORK_ROUTING_ERROR", e2[e2.MALFORMED_DATA = 800130] = "MALFORMED_DATA", e2[e2.MALFORMED_ERROR_DATA = 800140] = "MALFORMED_ERROR_DATA", e2[e2.WRONG_CHANNEL_TYPE = 800150] = "WRONG_CHANNEL_TYPE", e2[e2.MARK_AS_READ_RATE_LIMIT_EXCEEDED = 800160] = "MARK_AS_READ_RATE_LIMIT_EXCEEDED", e2[e2.QUERY_IN_PROGRESS = 800170] = "QUERY_IN_PROGRESS", e2[e2.ACK_TIMEOUT = 800180] = "ACK_TIMEOUT", e2[e2.LOGIN_TIMEOUT = 800190] = "LOGIN_TIMEOUT", e2[e2.WEBSOCKET_CONNECTION_CLOSED = 800200] = "WEBSOCKET_CONNECTION_CLOSED", e2[e2.WEBSOCKET_CONNECTION_FAILED = 800210] = "WEBSOCKET_CONNECTION_FAILED", e2[e2.REQUEST_FAILED = 800220] = "REQUEST_FAILED", e2[e2.FILE_UPLOAD_CANCEL_FAILED = 800230] = "FILE_UPLOAD_CANCEL_FAILED", e2[e2.REQUEST_CANCELED = 800240] = "REQUEST_CANCELED", e2[e2.REQUEST_DUPLICATED = 800250] = "REQUEST_DUPLICATED", e2[e2.FILE_SIZE_LIMIT_EXCEEDED = 800260] = "FILE_SIZE_LIMIT_EXCEEDED", e2[e2.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED = 800270] = "ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED", e2[e2.SESSION_TOKEN_REQUEST_FAILED = 800500] = "SESSION_TOKEN_REQUEST_FAILED", e2[e2.SESSION_TOKEN_REFRESHED = 800501] = "SESSION_TOKEN_REFRESHED", e2[e2.SESSION_TOKEN_REFRESH_FAILED = 800502] = "SESSION_TOKEN_REFRESH_FAILED", e2[e2.COLLECTION_DISPOSED = 800600] = "COLLECTION_DISPOSED", e2[e2.DATABASE_ERROR = 800700] = "DATABASE_ERROR", e2[e2.USER_DEACTIVATED = 900021] = "USER_DEACTIVATED", e2[e2.RECEIVER_USER_DEACTIVATED = 900081] = "RECEIVER_USER_DEACTIVATED";
}(u || (u = {}));
var d;
var _;
var f;
var p;
var E;
var g = function(e2) {
  return !(e2 instanceof v && !e2.shouldThrowOutside);
};
var v = function(e2) {
  function n2(t2) {
    var i2 = t2.code, r2 = void 0 === i2 ? 0 : i2, s2 = t2.message, o2 = void 0 === s2 ? "" : s2, a2 = e2.call(this, o2) || this;
    return a2.shouldThrowOutside = false, a2._detail = "", a2.name = "SendbirdError", a2.code = r2, Object.setPrototypeOf(a2, n2.prototype), a2;
  }
  return t(n2, e2), Object.defineProperty(n2.prototype, "detail", { get: function() {
    return this._detail;
  }, enumerable: false, configurable: true }), n2.prototype.setDetail = function(e3) {
    this._detail = e3;
  }, Object.defineProperty(n2.prototype, "isInvalidTokenError", { get: function() {
    return this.code === u.INVALID_TOKEN;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isSessionExpiredError", { get: function() {
    return this.isSessionTokenExpiredError || this.isSessionKeyExpiredError;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isSessionTokenExpiredError", { get: function() {
    return this.code === u.SESSION_TOKEN_EXPIRED;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isSessionKeyExpiredError", { get: function() {
    return this.code === u.SESSION_KEY_EXPIRED;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isSessionInvalidatedError", { get: function() {
    return this.isSessionRevokedError || this.isUserAuthDeactivedError || this.isUserAuthDeletedOrNotFoundError;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isSessionRevokedError", { get: function() {
    return this.code === u.SESSION_REVOKED;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isUserAuthDeactivedError", { get: function() {
    return this.code === u.USER_AUTH_DEACTIVATED;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isUserAuthDeletedOrNotFoundError", { get: function() {
    return this.code === u.USER_AUTH_DELETED_OR_NOT_FOUND;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isNetworkError", { get: function() {
    return this.code === u.NETWORK_ERROR || this.code === u.NETWORK_ROUTING_ERROR;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "debugModeRequired", { get: function() {
    return new n2({ code: u.DEBUG_MODE_REQUIRED, message: "Cannot run this operation in production mode." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "lostInstance", { get: function() {
    return new n2({ code: u.LOST_INSTANCE, message: "Instance ID is missing. It should belong to an instance." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "invalidCommand", { get: function() {
    return new n2({ code: u.INVALID_COMMAND, message: "Cannot send invalid command." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "unknown", { get: function() {
    return new n2({ code: u.UNKNOWN_ERROR, message: "Unknown error occurred." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "connectionRenew", { get: function() {
    return new n2({ code: u.CONNECTION_RENEW, message: "Connection restarts." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "invalidConnectionStateTransition", { get: function() {
    return new n2({ code: u.INVALID_CONNECTION_STATE_TRANSITION, message: "Invalid connection state transition." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "xmlHttpRequestNotSupported", { get: function() {
    return new n2({ code: u.XMLHTTPREQUEST_NOT_SUPPORTED, message: "Cannot upload file. XMLHttpRequest is not defined in this environment." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "connectionRequired", { get: function() {
    return new n2({ code: u.CONNECTION_REQUIRED, message: "Connection is required." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "connectionCanceled", { get: function() {
    return new n2({ code: u.CONNECTION_CANCELED, message: "Connection is canceled." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "invalidParameters", { get: function() {
    return new n2({ code: u.INVALID_PARAMETER, message: "Invalid parameters." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "notSupportedError", { get: function() {
    return new n2({ code: u.NOT_SUPPORTED_ERROR, message: "Given parameters are not supported." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "channelTypeNotSupportedError", { get: function() {
    return new n2({ code: u.NOT_SUPPORTED_ERROR, message: "Called method is not supported in the current channel's channel type." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "networkError", { get: function() {
    return new n2({ code: u.NETWORK_ERROR, message: "There was a network error." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "markAsReadAllRateLimitExceeded", { get: function() {
    return new n2({ code: u.MARK_AS_READ_RATE_LIMIT_EXCEEDED, message: "markAsRead rate limit exceeded." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "queryInProgress", { get: function() {
    return new n2({ code: u.QUERY_IN_PROGRESS, message: "Query in progress." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "noAckTimeout", { get: function() {
    return new n2({ code: u.ACK_TIMEOUT, message: "Command received no ack." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "loginTimeout", { get: function() {
    return new n2({ code: u.LOGIN_TIMEOUT, message: "Connection timeout." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "connectionClosed", { get: function() {
    return new n2({ code: u.WEBSOCKET_CONNECTION_CLOSED, message: "Connection is closed. Please reconnect." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "requestFailed", { get: function() {
    return new n2({ code: u.REQUEST_FAILED, message: "Request failed." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "tooManyRequests", { get: function() {
    return new n2({ code: u.REQUEST_DUPLICATED, message: "Too many requests." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "alreadyConnectedAsAnotherUser", { get: function() {
    return new n2({ code: u.REQUEST_FAILED, message: "Already logged in as a different user. Call disconnect() first." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "fileUploadCanceled", { get: function() {
    return new n2({ code: u.FILE_UPLOAD_CANCEL_FAILED, message: "File upload has been canceled." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "requestCanceled", { get: function() {
    return new n2({ code: u.REQUEST_CANCELED, message: "Request has been canceled." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "sessionTokenRefreshFailed", { get: function() {
    return new n2({ code: u.SESSION_TOKEN_REFRESH_FAILED, message: "Failed to refresh the session key." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "sessionTokenRequestFailed", { get: function() {
    return new n2({ code: u.SESSION_TOKEN_REQUEST_FAILED, message: "Failed to get the session token." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "databaseError", { get: function() {
    return new n2({ code: u.DATABASE_ERROR, message: "Database error." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "fileSizeLimitExceededError", { get: function() {
    return new n2({ code: u.FILE_SIZE_LIMIT_EXCEEDED, message: "File size exceeds the file size limit." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "statLogUploadLimitExceededError", { get: function() {
    return new n2({ code: u.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED, message: "The upload request failed due to the retry count being exceeded." });
  }, enumerable: false, configurable: true }), Object.defineProperty(n2, "malformedDataError", { get: function() {
    return new n2({ code: u.MALFORMED_DATA, message: "Malformed data." });
  }, enumerable: false, configurable: true }), n2.prototype.throwOutside = function() {
    throw this.shouldThrowOutside = true, this;
  }, n2;
}(Error);
var b = [u.CONNECTION_REQUIRED, u.NETWORK_ERROR, u.ACK_TIMEOUT, u.WEBSOCKET_CONNECTION_CLOSED, u.WEBSOCKET_CONNECTION_FAILED, u.FILE_UPLOAD_CANCEL_FAILED, u.REQUEST_CANCELED, u.INTERNAL_SERVER_ERROR, u.RATE_LIMIT_EXCEEDED, u.UNKNOWN_SERVER_ERROR, u.USER_DEACTIVATED, u.RECEIVER_USER_DEACTIVATED];
var m = [u.WEBSOCKET_CONNECTION_CLOSED, u.WEBSOCKET_CONNECTION_FAILED, u.CONNECTION_REQUIRED];
var y = function(e2, t2) {
  if (e2 !== t2) {
    var i2 = n({}, e2), r2 = n({}, t2);
    return (!i2.hasOwnProperty("messageId") || !r2.hasOwnProperty("messageId") || i2.messageId === r2.messageId) && ((!i2.hasOwnProperty("reqId") || !r2.hasOwnProperty("reqId") || i2.reqId === r2.reqId) && (i2.hasOwnProperty("messageId") && delete i2.messageId, i2.hasOwnProperty("reqId") && delete i2.reqId, r2.hasOwnProperty("messageId") && delete r2.messageId, r2.hasOwnProperty("reqId") && delete r2.reqId, JSON.stringify(i2) === JSON.stringify(r2)));
  }
  return true;
};
var w = function(e2, t2, n2) {
  return void 0 === n2 && (n2 = false), !(!n2 || !D(t2)) || ("string" != typeof e2 ? "object" == typeof e2 ? S(e2, t2) : T(e2, t2) : typeof t2 === e2);
};
var S = function(e2, t2, n2) {
  return void 0 === n2 && (n2 = false), !(!n2 || !D(t2)) || Object.values(e2).includes(t2);
};
var T = function(e2, t2) {
  return t2 instanceof e2;
};
var N = function(e2, t2, n2) {
  return void 0 === n2 && (n2 = false), !(!n2 || !D(t2)) || Array.isArray(t2) && t2.every(function(t3) {
    return w(e2, t3);
  });
};
var C = function(e2, t2) {
  return void 0 === t2 && (t2 = false), !(!t2 || !D(e2)) || "number" == typeof e2 && 13 === e2.toString().length;
};
var A = function(e2) {
  return e2 > 0 && b.indexOf(e2) >= 0;
};
var I = function(e2) {
  return e2 > 0 && m.indexOf(e2) >= 0;
};
var k = function(e2, t2) {
  if (void 0 === t2 && (t2 = false), t2 && D(e2)) return true;
  var n2 = "object" == typeof e2 && null !== e2 && e2.hasOwnProperty("name") && "string" == typeof e2.name && e2.hasOwnProperty("uri") && "string" == typeof e2.uri && e2.hasOwnProperty("type") && "string" == typeof e2.type;
  if (!n2) {
    if ("undefined" != typeof Blob) return e2 instanceof Blob;
    if ("undefined" != typeof File) return e2 instanceof File;
  }
  return n2;
};
var O = function(e2, t2) {
  if (e2 === t2) return true;
  if (null == e2 || null == t2) return false;
  if (e2.length !== t2.length) return false;
  for (var n2 = c([], a(e2), false).sort(), i2 = c([], a(t2), false).sort(), r2 = 0; r2 < n2.length; ++r2) if (n2[r2] !== i2[r2]) return false;
  return true;
};
var D = function(e2) {
  return null == e2;
};
var R = function() {
  function e2(e3) {
    var t2 = void 0 === e3 ? {} : e3, n2 = t2.useMemberInfoInMessage, i2 = void 0 === n2 || n2, r2 = t2.typingIndicatorInvalidateTime, s2 = void 0 === r2 ? 1e4 : r2, o2 = t2.typingIndicatorThrottle, a2 = void 0 === o2 ? 1e3 : o2, c2 = t2.websocketResponseTimeout, u2 = void 0 === c2 ? 1e4 : c2, l2 = t2.websocketPayloadDecompression, h2 = void 0 === l2 || l2, d2 = t2.sessionTokenRefreshTimeout, _2 = void 0 === d2 ? 60 : d2;
    this._useMemberInfoInMessage = true, this._typingIndicatorInvalidateTime = 1e4, this._typingIndicatorThrottle = 1e3, this._websocketResponseTimeout = 1e4, this._sessionTokenRefreshTimeout = 60, this._useMemberInfoInMessage = i2, this._typingIndicatorInvalidateTime = s2, this._typingIndicatorThrottle = a2, this._websocketResponseTimeout = u2, this._sessionTokenRefreshTimeout = _2, this.websocketPayloadDecompression = h2;
  }
  return Object.defineProperty(e2.prototype, "useMemberInfoInMessage", { get: function() {
    return this._useMemberInfoInMessage;
  }, set: function(e3) {
    w("boolean", e3) && (this._useMemberInfoInMessage = e3);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "typingIndicatorInvalidateTime", { get: function() {
    return this._typingIndicatorInvalidateTime;
  }, set: function(e3) {
    w("number", e3) && (this._typingIndicatorInvalidateTime = e3);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "typingIndicatorThrottle", { get: function() {
    return this._typingIndicatorThrottle;
  }, set: function(e3) {
    w("number", e3) && e3 >= 1e3 && e3 <= 9e3 && (this._typingIndicatorThrottle = e3);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "websocketResponseTimeout", { get: function() {
    return this._websocketResponseTimeout;
  }, set: function(e3) {
    w("number", e3) && e3 >= 5e3 && e3 <= 3e4 && (this._websocketResponseTimeout = e3);
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "sessionTokenRefreshTimeout", { get: function() {
    return this._sessionTokenRefreshTimeout;
  }, set: function(e3) {
    w("number", e3) && (e3 < 60 ? e3 = 60 : e3 > 1800 && (e3 = 1800), this._sessionTokenRefreshTimeout = e3);
  }, enumerable: false, configurable: true }), e2;
}();
var L = { encrypt: function(e2) {
  return e2;
}, decrypt: function(e2) {
  return e2;
} };
var x = function() {
  function e2(e3) {
    var t2 = e3.store;
    this._preference = /* @__PURE__ */ new Map(), this._store = t2;
  }
  return e2.prototype._savePreferenceKeys = function() {
    return r(this, void 0, void 0, function() {
      return s(this, function(e3) {
        switch (e3.label) {
          case 0:
            return [4, this._store.set({ key: this._keysAddress, value: c([], a(this._preference.keys()), false) })];
          case 1:
            return e3.sent(), [2];
        }
      });
    });
  }, e2.prototype.init = function(e3, t2) {
    var n2;
    return void 0 === t2 && (t2 = 1), r(this, void 0, void 0, function() {
      var i2, r2, a2, c2, u2, l2, h2, d2, _2, f2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return this._version = t2, this._keysAddress = e3, i2 = "".concat(e3, ".metadata.version"), [4, this._store.get(i2)];
          case 1:
            return r2 = s2.sent(), [4, this._store.get(e3)];
          case 2:
            return a2 = null !== (n2 = s2.sent()) && void 0 !== n2 ? n2 : [], !r2 || r2.version < this._version ? [4, this._resetPreferenceData(a2, i2)] : [3, 4];
          case 3:
            return s2.sent(), [3, 11];
          case 4:
            s2.trys.push([4, 9, 10, 11]), c2 = o(a2), u2 = c2.next(), s2.label = 5;
          case 5:
            return u2.done ? [3, 8] : (l2 = u2.value, [4, this._store.get(l2)]);
          case 6:
            (h2 = s2.sent()) && this._preference.set(l2, h2), s2.label = 7;
          case 7:
            return u2 = c2.next(), [3, 5];
          case 8:
            return [3, 11];
          case 9:
            return d2 = s2.sent(), _2 = { error: d2 }, [3, 11];
          case 10:
            try {
              u2 && !u2.done && (f2 = c2.return) && f2.call(c2);
            } finally {
              if (_2) throw _2.error;
            }
            return [7];
          case 11:
            return [2];
        }
      });
    });
  }, e2.prototype._resetPreferenceData = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return this._preference = /* @__PURE__ */ new Map(), [4, this._store.removeMany(e3)];
          case 1:
            return n2.sent(), [4, this._store.set({ key: t2, value: { version: this._version } })];
          case 2:
            return n2.sent(), [2];
        }
      });
    });
  }, e2.prototype.get = function(e3) {
    return r(this, void 0, void 0, function() {
      return s(this, function(t2) {
        return [2, this._preference.get(e3)];
      });
    });
  }, e2.prototype.set = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n2;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return n2 = !this._preference.has(e3), [4, this._store.set({ key: e3, value: t2 })];
          case 1:
            return i2.sent(), this._preference.set(e3, t2), n2 ? [4, this._savePreferenceKeys()] : [3, 3];
          case 2:
            i2.sent(), i2.label = 3;
          case 3:
            return [2];
        }
      });
    });
  }, e2.prototype.remove = function(e3) {
    return r(this, void 0, void 0, function() {
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return [4, this._store.remove(e3)];
          case 1:
            return t2.sent(), this._preference.delete(e3), [4, this._savePreferenceKeys()];
          case 2:
            return t2.sent(), [2];
        }
      });
    });
  }, e2.prototype.clear = function() {
    return r(this, void 0, void 0, function() {
      return s(this, function(e3) {
        switch (e3.label) {
          case 0:
            return [4, this._store.removeMany(c([], a(this._preference.keys()), false))];
          case 1:
            return e3.sent(), this._preference.clear(), [4, this._savePreferenceKeys()];
          case 2:
            return e3.sent(), [2];
        }
      });
    });
  }, e2;
}();
var U = function() {
  function e2(e3) {
    var t2 = e3.encryption, n2 = e3.store, i2 = e3.localCacheEnabled, r2 = e3.localCacheConfig;
    this.store = n2, this.preference = new x({ store: n2 }), this.encryption = null != t2 ? t2 : L, this.localCacheEnabled = i2, this.localCacheConfig = r2;
  }
  return e2.prototype.replaceStore = function(e3) {
    this.store = e3, this.preference = new x({ store: e3 });
  }, e2;
}();
!function(e2) {
  e2.SUCCESS = "success", e2.PENDING = "pending", e2.ERROR = "error";
}(d || (d = {})), function(e2) {
  e2.DEFAULT = "default", e2.ALL = "all", e2.MENTION_ONLY = "mention_only", e2.OFF = "off";
}(_ || (_ = {})), function(e2) {
  e2.FCM = "gcm", e2.APNS = "apns", e2.UNKNOWN = "unknown";
}(f || (f = {})), function(e2) {
  e2.ALTERNATIVE = "alternative", e2.DEFAULT = "default";
}(p || (p = {})), function(e2) {
  e2.CUSTOM = "custom", e2.MESSAGE_COLLECTION_ACCESSED_AT = "messagecollection_accessed_at";
}(E || (E = {}));
var P;
var M = function() {
  function e2(e3) {
    var t2 = e3.channel, n2 = e3.cachedMessageCount;
    this._cachedMessageCount = 0, this._channel = t2, this._cachedMessageCount = n2;
  }
  return Object.defineProperty(e2.prototype, "channel", { get: function() {
    return this._channel;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "cachedMessageCount", { get: function() {
    return this._cachedMessageCount;
  }, enumerable: false, configurable: true }), e2;
}();
var F = function() {
  function e2(e3) {
    var t2 = void 0 === e3 ? {} : e3, n2 = t2.maxSize, i2 = void 0 === n2 ? 256 : n2, r2 = t2.clearOrder, s2 = void 0 === r2 ? E.MESSAGE_COLLECTION_ACCESSED_AT : r2, o2 = t2.customClearOrderComparator, a2 = t2.enableAutoResend, c2 = void 0 === a2 || a2;
    this._clearOrderComparatorUseMessageCollectionAccessedAt = function(e4, t3) {
      return e4.channel.messageCollectionLastAccessedAt === t3.channel.messageCollectionLastAccessedAt ? e4.channel.lastMessage && !t3.channel.lastMessage ? 1 : !e4.channel.lastMessage && t3.channel.lastMessage ? -1 : e4.channel.lastMessage || t3.channel.lastMessage ? e4.channel.lastMessage.createdAt - t3.channel.lastMessage.createdAt : 0 : e4.channel.messageCollectionLastAccessedAt > t3.channel.messageCollectionLastAccessedAt ? 1 : -1;
    }, this._maxSize = Math.max(i2, 64), o2 ? (this._clearOrder = s2, this._customClearOrderComparator = o2) : this._clearOrder = E.MESSAGE_COLLECTION_ACCESSED_AT, this._enableAutoResend = c2;
  }
  return Object.defineProperty(e2.prototype, "maxSize", { get: function() {
    return this._maxSize;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "clearOrder", { get: function() {
    return this._clearOrder;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "clearOrderComparator", { get: function() {
    var e3;
    return this._clearOrder === E.MESSAGE_COLLECTION_ACCESSED_AT ? this._clearOrderComparatorUseMessageCollectionAccessedAt : null !== (e3 = this._customClearOrderComparator) && void 0 !== e3 ? e3 : this._clearOrderComparatorUseMessageCollectionAccessedAt;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "enableAutoResend", { get: function() {
    return this._enableAutoResend;
  }, enumerable: false, configurable: true }), e2;
}();
!function(e2) {
  e2.FEED = "feed", e2.CHAT = "chat", e2.CHAT_API = "chat_api";
}(P || (P = {}));
var q;
var V;
var H;
var z;
var G;
var j;
var K;
var B;
var Q;
var W;
var Z;
var Y;
var X;
var J = function() {
  function e2() {
    this.isRefreshing = false;
  }
  return Object.defineProperty(e2.prototype, "hasSession", { get: function() {
    return !!this.sessionKey;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "hasChatServicePermission", { get: function() {
    var e3;
    return !!(null === (e3 = this.services) || void 0 === e3 ? void 0 : e3.includes(P.CHAT));
  }, enumerable: false, configurable: true }), e2.prototype.clear = function() {
    this.authToken = void 0, this.sessionKey = void 0, this.services = [];
  }, e2;
}();
var $ = function() {
  var e2 = (/* @__PURE__ */ new Date()).getTime();
  return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(t2) {
    var n2 = (e2 + 16 * Math.random()) % 16 | 0;
    return e2 = Math.floor(e2 / 16), ("x" === t2 ? n2 : 3 & n2 | 8).toString(16);
  });
};
var ee = function() {
  function e2(e3) {
    var t2 = e3.container;
    this._container = {}, this._container = t2, this.key = $();
  }
  return e2.prototype._register = function(e3, t2, n2) {
    var i2;
    return e3 in this._container || (this._container[e3] = /* @__PURE__ */ new Map()), null === (i2 = this._container[e3]) || void 0 === i2 || i2.set(this.key, { occurence: t2, handler: n2 }), this;
  }, e2.prototype.on = function(e3, t2) {
    return this._register(e3, -1, t2);
  }, e2.prototype.once = function(e3, t2) {
    return this._register(e3, 1, t2);
  }, e2.prototype.close = function() {
    var e3 = this;
    Object.keys(this._container).forEach(function(t2) {
      var n2;
      null === (n2 = e3._container[t2]) || void 0 === n2 || n2.delete(e3.key);
    });
  }, e2;
}();
var te = function() {
  function e2() {
    this._container = {};
  }
  return e2.prototype.on = function(e3, t2) {
    return new ee({ container: this._container }).on(e3, t2);
  }, e2.prototype.once = function(e3, t2) {
    return new ee({ container: this._container }).once(e3, t2);
  }, e2.prototype.dispatch = function(e3, t2) {
    var n2, i2, r2 = this._container[e3];
    if (r2) {
      var s2 = [];
      try {
        for (var a2 = o(r2.keys()), c2 = a2.next(); !c2.done; c2 = a2.next()) {
          var u2 = c2.value, l2 = r2.get(u2);
          l2.handler(t2), l2.occurence > 0 && (l2.occurence--, 0 === l2.occurence && s2.push(u2));
        }
      } catch (e4) {
        n2 = { error: e4 };
      } finally {
        try {
          c2 && !c2.done && (i2 = a2.return) && i2.call(a2);
        } finally {
          if (n2) throw n2.error;
        }
      }
      s2.forEach(function(e4) {
        return r2.delete(e4);
      });
    }
  }, e2;
}();
var ne = function() {
  function e2() {
    this._dispatcher = new te();
  }
  return e2.prototype.on = function(e3) {
    return this._dispatcher.on("event", e3);
  }, e2.prototype.once = function(e3) {
    return this._dispatcher.once("event", e3);
  }, e2.prototype.dispatch = function(e3) {
    this._dispatcher.dispatch("event", e3);
  }, e2;
}();
var ie = function() {
};
var re = function(e2) {
  var t2 = {};
  return e2 && Object.keys(e2).forEach(function(n2) {
    void 0 === e2[n2] || Number.isNaN(e2[n2]) || null === e2[n2] || (t2[n2] = e2[n2]);
  }), t2;
};
var se = function(e2) {
  if (null != e2) {
    if ("object" == typeof e2) {
      if (Array.isArray(e2)) {
        for (var t2 = c([], a(e2), false), n2 = 0; n2 < t2.length; n2++) t2[n2] = se(t2[n2]);
        return t2;
      }
      return Object.keys(e2).forEach(function(t3) {
        null === e2[t3] && delete e2[t3];
      }), e2;
    }
    return e2;
  }
};
!function(e2) {
  e2.BASE = "base", e2.GROUP = "group", e2.OPEN = "open", e2.FEED = "feed";
}(q || (q = {})), function(e2) {
  e2.OPERATOR = "operator", e2.NONE = "none";
}(V || (V = {})), function(e2) {
  e2.MUTED = "muted", e2.UNMUTED = "unmuted";
}(H || (H = {})), function(e2) {
  e2.BASE = "base", e2.USER = "user", e2.FILE = "file", e2.ADMIN = "admin";
}(z || (z = {})), function(e2) {
  e2.ALL = "", e2.USER = "MESG", e2.FILE = "FILE", e2.ADMIN = "ADMM";
}(G || (G = {})), function(e2) {
  e2.USER = "MESG", e2.FILE = "FILE", e2.ADMIN = "ADMM";
}(j || (j = {})), function(e2) {
  e2.USERS = "users", e2.CHANNEL = "channel";
}(K || (K = {})), function(e2) {
  e2.ALL = "all", e2.NONE = "none", e2.ONLY_REPLY_TO_CHANNEL = "only_reply_to_channel";
}(B || (B = {})), function(e2) {
  e2.DEFAULT = "default", e2.SUPPRESS = "suppress";
}(Q || (Q = {})), function(e2) {
  e2.PENDING = "pending", e2.SCHEDULED = "scheduled", e2.SUCCEEDED = "succeeded", e2.FAILED = "failed", e2.CANCELED = "canceled";
}(W || (W = {})), function(e2) {
  e2.INREVIEW = "InReview", e2.APPROVED = "Approved";
}(Z || (Z = {})), function(e2) {
  e2.HIGH = "high", e2.NORMAL = "normal", e2.LOW = "low";
}(Y || (Y = {})), function(e2) {
  e2.CREATED_AT = "created_at", e2.UPDATED_AT = "updated_at";
}(X || (X = {}));
var oe;
var ae = "v3";
var ce = "/".concat(ae, "/users");
var ue = "/".concat(ae, "/sdk/users");
var le = "/".concat(ae, "/storage/file");
var he = "/".concat(ae, "/group_channels");
var de = "/".concat(ae, "/sdk/group_channels");
var _e = "/".concat(ae, "/open_channels");
var fe = "/".concat(ae, "/sdk/open_channels");
var pe = "/".concat(ae, "/search");
var Ee = "/".concat(ae, "/report");
var ge = "/".concat(ae, "/emojis");
var ve = "/".concat(ae, "/emoji_categories");
var be = "/".concat(ae, "/polls");
var me = "/".concat(ae, "/scheduled_messages");
var ye = "/".concat(ae, "/sdk/ui_kit/configuration");
var we = "/".concat(ae, "/sdk/statistics");
var Se = "/".concat(ae, "/notifications");
var Te = "/".concat(ae, "/notifications/users");
var Ne = "/".concat(ae, "/message_templates");
var Ce = "/".concat(ae, "/sdk/push_delivery");
var Ae = "/".concat(ae, "/forms");
var Ie = function(e2) {
  switch (e2) {
    case q.FEED:
    case q.GROUP:
      return he;
    case q.OPEN:
      return _e;
    default:
      return null;
  }
};
var ke = function(e2) {
  switch (e2) {
    case q.GROUP:
      return "".concat(Ee, "/group_channels");
    case q.OPEN:
      return "".concat(Ee, "/open_channels");
    default:
      return null;
  }
};
var Oe = function(e2, t2, n2) {
  var i2, r2;
  switch (e2) {
    case K.CHANNEL:
      return true;
    case K.USERS:
      if (t2) try {
        for (var s2 = o(t2), a2 = s2.next(); !a2.done; a2 = s2.next()) {
          if (a2.value === n2) return true;
        }
      } catch (e3) {
        i2 = { error: e3 };
      } finally {
        try {
          a2 && !a2.done && (r2 = s2.return) && r2.call(s2);
        } finally {
          if (i2) throw i2.error;
        }
      }
  }
  return false;
};
var De = function(e2, t2, n2) {
  var i2, r2, s2, o2, a2 = Oe(null !== (i2 = e2.mentionType) && void 0 !== i2 ? i2 : null, null !== (r2 = e2.mentionedUserIds) && void 0 !== r2 ? r2 : [], n2), c2 = Oe(null !== (s2 = t2.mentionType) && void 0 !== s2 ? s2 : null, null !== (o2 = t2.mentionedUserIds) && void 0 !== o2 ? o2 : [], n2);
  return !a2 && c2 ? 1 : a2 && !c2 ? -1 : 0;
};
var Re = function(e2, t2, n2) {
  var i2, r2 = t2 || new FormData();
  for (var s2 in e2) if (e2.hasOwnProperty(s2)) {
    var o2 = e2[s2], a2 = n2 ? "".concat(n2, "[").concat(s2, "]") : s2;
    k(o2) ? r2.append(a2, o2, null !== (i2 = o2.name) && void 0 !== i2 ? i2 : "filename") : "object" != typeof o2 || null === o2 || Array.isArray(o2) || o2 instanceof Blob ? r2.append(a2, String(o2)) : r2 = Re(o2, r2, a2);
  }
  return r2;
};
!function(e2) {
  e2.GET = "GET", e2.POST = "POST", e2.PUT = "PUT", e2.DELETE = "DELETE";
}(oe || (oe = {}));
var Le;
var xe = function(e2) {
  function n2() {
    var t2 = null !== e2 && e2.apply(this, arguments) || this;
    return t2.params = {}, t2.requireAuth = true, t2.headers = {}, t2.requestId = $(), t2;
  }
  return t(n2, e2), n2.prototype.encodeParams = function(e3) {
    var t2 = this;
    return null == e3 || "" === e3 ? encodeURIComponent("") : Array.isArray(e3) ? e3.map(function(e4) {
      return t2.encodeParams(e4);
    }).join(",") : "object" == typeof e3 ? encodeURIComponent(JSON.stringify(e3)) : encodeURIComponent(String(e3));
  }, Object.defineProperty(n2.prototype, "query", { get: function() {
    var e3 = this, t2 = re(this.params);
    return "?".concat(Object.keys(t2).map(function(n3) {
      return "".concat(encodeURIComponent(n3), "=").concat(e3.encodeParams(t2[n3]));
    }).join("&"));
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "payload", { get: function() {
    var e3 = re(this.params);
    return Object.keys(e3).some(function(t2) {
      return k(e3[t2]);
    }) ? Re(e3) : JSON.stringify(e3);
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "hasSessionKey", { get: function() {
    return void 0 !== this.headers["Session-Key"];
  }, enumerable: false, configurable: true }), n2;
}(ie);
var Ue = function(e2) {
  function i2(t2, n2) {
    var i3 = e2.call(this) || this;
    return i3._iid = t2, i3._payload = n2, i3;
  }
  return t(i2, e2), Object.defineProperty(i2.prototype, "payload", { get: function() {
    return n({}, this._payload);
  }, enumerable: false, configurable: true }), i2.prototype.as = function(e3) {
    return new e3(this._iid, this.payload);
  }, i2;
}(ie);
var Pe = function(e2) {
  function n2(t2) {
    var n3 = e2.call(this) || this;
    return n3.requestId = t2, n3;
  }
  return t(n2, e2), n2;
}(ie);
var Me = function(e2) {
  function n2(t2) {
    var n3 = t2.expires_in, i2 = t2.reason, r2 = void 0 === i2 ? u.SESSION_KEY_EXPIRED : i2, s2 = t2.message, o2 = void 0 === s2 ? "" : s2, a2 = e2.call(this) || this;
    switch (a2.expiresIn = null != n3 ? n3 : 0, r2) {
      case u.SESSION_KEY_EXPIRED:
      case u.SESSION_TOKEN_EXPIRED:
      case u.SESSION_REVOKED:
      case u.USER_AUTH_DEACTIVATED:
      case u.USER_AUTH_DELETED_OR_NOT_FOUND:
        a2.error = new v({ code: r2, message: o2 });
    }
    return a2;
  }
  return t(n2, e2), Object.defineProperty(n2.prototype, "invalidateSessionToken", { get: function() {
    var e3;
    return !!(null === (e3 = this.error) || void 0 === e3 ? void 0 : e3.isSessionTokenExpiredError);
  }, enumerable: false, configurable: true }), n2;
}(ie);
var Fe = function(e2) {
  function n2(t2, n3, i2, r2) {
    void 0 === r2 && (r2 = "");
    var s2, o2 = this;
    return (o2 = e2.call(this) || this)._iid = t2, o2.code = n3, o2.payload = i2, o2.requestId = null !== (s2 = i2.req_id) && void 0 !== s2 ? s2 : r2, o2;
  }
  return t(n2, e2), n2.createFromRawMessage = function(e3, t2) {
    var i2 = t2.substring(0, 4), r2 = {};
    try {
      r2 = JSON.parse(t2.substring(4));
    } catch (e4) {
      i2 = "NOOP";
    } finally {
      return new n2(e3, i2, r2);
    }
  }, n2.prototype.convertToMessage = function() {
    return "".concat(this.code).concat(JSON.stringify(this.payload), "\n");
  }, n2.prototype.as = function(e3) {
    return new e3(this._iid, this.code, this.payload);
  }, n2;
}(ie);
var qe = function(e2) {
  function n2(t2) {
    var n3, i2 = t2.code, r2 = t2.ackRequired, s2 = t2.payload, o2 = void 0 === s2 ? {} : s2, a2 = this;
    return (a2 = e2.call(this) || this).code = i2, a2.payload = o2, a2.requestId = null !== (n3 = a2.payload.req_id) && void 0 !== n3 ? n3 : $(), a2.ackRequired = r2, a2.payload.req_id = a2.requestId, a2;
  }
  return t(n2, e2), n2.prototype.convertToMessage = function() {
    return "".concat(this.code).concat(JSON.stringify(this.payload), "\n");
  }, n2;
}(ie);
var Ve = function(e2) {
  function n2(t2) {
    var n3 = t2.userId, i2 = t2.authToken, r2 = t2.services, s2 = t2.expiringSession, o2 = void 0 === s2 || s2, a2 = e2.call(this) || this;
    return a2.path = "".concat(ce, "/").concat(n3, "/session_key"), a2.method = oe.POST, a2.params = re({ token: i2, services: r2, expiring_session: !!o2 }), a2.requireAuth = false, a2;
  }
  return t(n2, e2), n2;
}(xe);
var He = function(e2) {
  function n2(t2) {
    var n3 = t2.authToken, i2 = t2.expiringSession, r2 = void 0 === i2 || i2, s2 = t2.requestId, o2 = void 0 === s2 ? void 0 : s2;
    return e2.call(this, { code: "LOGI", payload: re({ token: n3, expiring_session: r2 ? 1 : 0, req_id: o2 }), ackRequired: true }) || this;
  }
  return t(n2, e2), n2;
}(qe);
var ze = function(e2) {
  function n2(t2, n3) {
    var i2 = e2.call(this, t2, n3) || this, r2 = n3.key, s2 = n3.expires_at, o2 = n3.services;
    return i2.key = r2, i2.expiresAt = s2, i2.services = o2, i2;
  }
  return t(n2, e2), n2;
}(Ue);
var Ge = function(e2) {
  function n2(t2, n3, i2) {
    var r2, s2 = this;
    return (s2 = e2.call(this, t2, "LOGI", i2) || this).error = null, s2.newKey = null, s2.newKey = null !== (r2 = i2.new_key) && void 0 !== r2 ? r2 : null, s2.error = i2.error ? new v(i2) : null, s2;
  }
  return t(n2, e2), n2;
}(Fe);
var je = function(e2) {
  function n2(t2) {
    var n3 = e2.call(this) || this;
    return n3.statLog = t2, n3;
  }
  return t(n2, e2), n2;
}(ie);
var Ke = function(e2) {
  function n2(t2) {
    var n3 = t2.request, i2 = t2.deferred, r2 = t2.error, s2 = void 0 === r2 ? v.requestFailed : r2, o2 = e2.call(this) || this;
    return o2.request = n3, o2.deferred = i2, o2.error = s2, o2;
  }
  return t(n2, e2), n2;
}(ie);
!function(e2) {
  e2.FEATURE_LOCALCACHE = "feature:local_cache", e2.FEATURE_LOCALCACHE_EVENT = "feature:local_cache_event", e2.NOTIFICATION = "noti:stats", e2.WEBSOCKET_CONNECT = "ws:connect", e2.API_RESULT = "api:result";
}(Le || (Le = {}));
var Be;
var Qe;
var We;
var Ze = function() {
  function e2(e3) {
    var t2 = e3.type, n2 = e3.data, i2 = e3.ts, r2 = void 0 === i2 ? Date.now() : i2;
    this.type = t2, this.createdAt = r2, this.data = n2;
  }
  return e2.payloadify = function(e3) {
    return re({ stat_type: e3.type, ts: e3.createdAt, data: re(e3.data) });
  }, e2;
}();
var Ye = function() {
  return "undefined" == typeof document && "undefined" != typeof navigator && "ReactNative" == navigator.product;
};
var Xe = function() {
  return !("undefined" == typeof navigator || !/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent));
};
!function(e2) {
  e2.CHAT = "chat", e2.CALLS = "calls", e2.DESK = "desk", e2.LIVE = "live", e2.UIKIT_CHAT = "uikit-chat", e2.UIKIT_LIVE = "uikit-live";
}(Be || (Be = {})), function(e2) {
  e2.ANDROID = "android", e2.IOS = "ios", e2.JS = "js", e2.UNREAL = "unreal", e2.UNITY = "unity", e2.REACT_NATIVE = "react-native", e2.FLUTTER = "flutter";
}(Qe || (Qe = {})), function(e2) {
  e2.ANDROID = "android", e2.IOS = "ios", e2.WEB = "web", e2.MOBILE_WEB = "mobile_web", e2.WINDOWS = "windows";
}(We || (We = {}));
var Je = "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$";
var $e = function() {
  function e2() {
  }
  return e2.sendbirdSdkUserAgentWithExtension = function(e3) {
    var t2 = Ye() ? Qe.REACT_NATIVE : Qe.JS, i2 = { main_sdk_info: "chat/".concat(t2, "/").concat(h.SDK_VERSION), device_os_platform: Xe() ? "mobile-web" : "web", os_version: h.OS_VERSION };
    if (e3) {
      var r2 = e3.sendbirdExtensions, s2 = e3.deviceOS, o2 = e3.customData, c2 = void 0 === o2 ? {} : o2;
      s2.version && (i2.os_version = s2.version), s2.platform && (i2.device_os_platform = s2.platform), r2.length > 0 && (i2.extension_sdk_info = r2.map(function(e4) {
        var t3 = e4.product, n2 = e4.platform, i3 = e4.version;
        return "".concat(t3, "/").concat(n2, "/").concat(i3);
      }).join(",")), Object.keys(i2).forEach(function(e4) {
        return delete c2[e4];
      }), Object.keys(c2).length > 0 && (i2 = n(n({}, i2), c2));
    }
    return Object.entries(i2).map(function(e4) {
      var t3 = a(e4, 2), n2 = t3[0], i3 = t3[1];
      return "".concat(n2, "=").concat(i3);
    }).join("&");
  }, e2.userAgentWithExtension = function(e3) {
    var t2 = Ye() ? "reactnative" : "JS", n2 = e3.sb_syncmanager ? "s".concat(e3.sb_syncmanager) : "", i2 = e3.sb_uikit ? "u".concat(e3.sb_uikit) : "", r2 = e3["device-os-platform"] ? "o".concat(e3["device-os-platform"]) : Xe() ? "omobile-web" : "oweb";
    return "".concat(t2, "/c").concat(h.SDK_VERSION, "/").concat(n2, "/").concat(i2, "/").concat(r2);
  }, e2;
}();
var et = function() {
  var e2 = this;
  this.promise = new Promise(function(t2, n2) {
    e2.resolve = t2, e2.reject = function(e3) {
      n2(e3);
    };
  });
};
var tt = function(e2) {
  function n2(t2) {
    var n3 = e2.call(this) || this;
    return n3.requestId = t2.requestId, n3;
  }
  return t(n2, e2), n2;
}(ie);
var nt = function(e2) {
  function n2(t2) {
    var n3 = e2.call(this) || this;
    return n3.method = oe.DELETE, n3.path = "".concat(Ie(t2.channelType), "/").concat(t2.channelUrl, "/messages/").concat(t2.messageId), t2.messageToken && (n3.params = re({ mesg_token: t2.messageToken })), n3;
  }
  return t(n2, e2), n2;
}(xe);
!function(e2) {
  function n2() {
    return null !== e2 && e2.apply(this, arguments) || this;
  }
  t(n2, e2);
}(Ue);
var it = function(e2) {
  function n2(t2, n3, i2) {
    var r2, s2 = this;
    return (s2 = e2.call(this, t2, "DELM", i2) || this).channelUrl = i2.channel_url, s2.channelType = i2.channel_type, s2.messageId = Number(i2.msg_id), s2.silent = i2.silent, s2.messageCreatedAt = i2.message_created_at ? Number(i2.message_created_at) : -1, s2.senderId = null !== (r2 = i2.sender_id) && void 0 !== r2 ? r2 : void 0, s2;
  }
  return t(n2, e2), n2;
}(Fe);
var rt = function() {
  function e2(e3, t2) {
    var n2 = t2.session, i2 = t2.sdkState, r2 = t2.dispatcher, s2 = t2.logger, o2 = t2.useFetchCompat, a2 = void 0 !== o2 && o2, c2 = this;
    this._abortControl = /* @__PURE__ */ new Map(), this._shouldImportFetchCompat = false, this._iid = e3, this._session = n2, this._sdkState = i2, this._dispatcher = r2, this._dispatcher.on(function(e4) {
      e4 instanceof Pe && c2.cancel(e4.requestId);
    }), this._logger = s2, this._shouldImportFetchCompat = a2;
  }
  return e2.prototype._createHeader = function(e3, t2) {
    var i2 = this._sdkState, r2 = i2.appId, s2 = i2.appVersion, o2 = i2.sendbirdRuntimeEnvironment, a2 = n(n({}, e3.headers), { SendBird: "JS,".concat(h.OS_VERSION, ",").concat(h.SDK_VERSION, ",").concat(r2).concat(s2 ? ",".concat(s2) : ""), "SB-User-Agent": $e.userAgentWithExtension(this._sdkState.extensions), "Request-Sent-Timestamp": Date.now().toString(), "SB-SDK-User-Agent": $e.sendbirdSdkUserAgentWithExtension(o2) });
    return t2 || (a2["Content-Type"] = "application/json; charset=utf-8"), e3.requireAuth && !e3.hasSessionKey && this._session.hasSession && (a2["Session-Key"] = this._session.sessionKey), a2["App-Id"] = r2, this._session && this._session.authToken && (a2["Access-Token"] = this._session.authToken), a2;
  }, e2.prototype._statLogApiResult = function(e3, t2, n2) {
    this._dispatcher.dispatch(new je(new Ze({ type: Le.API_RESULT, data: { endpoint: e3.path, method: e3.method, success: !n2, latency: Date.now() - t2, error_code: null == n2 ? void 0 : n2.code, error_description: null == n2 ? void 0 : n2.message } })));
  }, e2.prototype._isBodyRequired = function(e3) {
    var t2 = e3.method;
    return t2 !== oe.GET && (t2 !== oe.DELETE || e3 instanceof nt);
  }, e2.prototype.send = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n2, i2, r2, o2, a2, c2, l2, h2, d2, _2, f2, p2, E2, g2, b2, m2, y2, w2, S2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            t2 = e3.path, n2 = e3.method, i2 = e3.uploadProgressHandler, r2 = this._isBodyRequired(e3), o2 = this._sdkState.api, a2 = "".concat(o2.host).concat(t2).concat(r2 ? "" : e3.query), c2 = r2 ? e3.payload : null, l2 = this._createHeader(e3, c2 instanceof FormData ? c2 : void 0), h2 = new AbortController(), d2 = h2.signal, this._abortControl.set(e3.requestId, h2), _2 = Date.now(), s2.label = 1;
          case 1:
            return s2.trys.push([1, 13, , 14]), i2 ? [4, import("./__bundle-91b5ecea-WUMNPU6A.js")] : [3, 6];
          case 2:
            f2 = s2.sent().xmlHttpRequest, s2.label = 3;
          case 3:
            return s2.trys.push([3, 5, , 6]), [4, f2(this._iid, { requestId: e3.requestId, method: e3.method, url: a2, headers: l2, data: null != c2 ? c2 : void 0, uploadProgressHandler: i2 })];
          case 4:
            return p2 = s2.sent(), this._logger.debug("receive api response", e3.requestId), this._statLogApiResult(e3, _2), [2, p2];
          case 5:
            if (!((E2 = s2.sent()) instanceof v && E2.code === u.XMLHTTPREQUEST_NOT_SUPPORTED)) throw E2;
            return this._logger.debug("XMLHttpRequest is not available in this environment. progressHandler is ignored."), [3, 6];
          case 6:
            return this._shouldImportFetchCompat && (this._shouldImportFetchCompat = false, ("undefined" != typeof globalThis && globalThis || "undefined" != typeof self && self || "undefined" != typeof global && global || { fetch: null }).fetch = null), "undefined" != typeof AbortController ? [3, 8] : [4, import("./__bundle-7c3d40f4-EPFSPIH3.js")];
          case 7:
            s2.sent(), s2.label = 8;
          case 8:
            return "function" == typeof fetch ? [3, 10] : [4, import("./__bundle-46d64517-AQ3IUQMU.js")];
          case 9:
            s2.sent(), s2.label = 10;
          case 10:
            return [4, fetch(a2, { method: n2, body: c2, headers: l2, signal: d2 })];
          case 11:
            return [4, (g2 = s2.sent()).json()];
          case 12:
            if (b2 = s2.sent(), g2.ok || g2.redirected) return this._logger.debug("receive api response", e3.requestId), this._statLogApiResult(e3, _2), [2, new Ue(this._iid, b2)];
            if (b2) {
              if ((m2 = new v(b2)).isSessionExpiredError) {
                if (this._dispatcher.dispatch(new Me({ reason: m2.code, message: m2.message })), !(e3 instanceof Ve)) return y2 = new et(), this._dispatcher.dispatch(new Ke({ request: e3, deferred: y2, error: m2 })), [2, y2.promise];
                throw m2;
              }
              throw m2.isSessionInvalidatedError ? (this._dispatcher.dispatch(new Me({ reason: m2.code, message: m2.message })), m2) : m2;
            }
            throw v.requestFailed;
          case 13:
            throw w2 = s2.sent(), this._statLogApiResult(e3, _2, w2), w2 instanceof v ? (this._logger.debug("fail api request", w2), w2) : "AbortError" === (null == w2 ? void 0 : w2.name) ? v.requestCanceled : (S2 = v.networkError, this._logger.debug("fail api request", S2), S2);
          case 14:
            return [2];
        }
      });
    });
  }, e2.prototype.cancel = function(e3) {
    this._abortControl.has(e3) && (this._abortControl.get(e3).abort(), this._abortControl.delete(e3));
    this._dispatcher.dispatch(new tt({ requestId: e3 }));
  }, e2.prototype.cancelAll = function() {
    var e3, t2;
    try {
      for (var n2 = o(this._abortControl.values()), i2 = n2.next(); !i2.done; i2 = n2.next()) {
        i2.value.abort();
      }
    } catch (t3) {
      e3 = { error: t3 };
    } finally {
      try {
        i2 && !i2.done && (t2 = n2.return) && t2.call(n2);
      } finally {
        if (e3) throw e3.error;
      }
    }
    this._abortControl.clear(), this._dispatcher.dispatch(new tt({}));
  }, e2;
}();
var st = function() {
};
function ot(e2) {
  let t2 = e2.length;
  for (; --t2 >= 0; ) e2[t2] = 0;
}
var at = 256;
var ct = 286;
var ut = 30;
var lt = 15;
var ht = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0]);
var dt = new Uint8Array([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13]);
var _t = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7]);
var ft = new Uint8Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);
var pt = new Array(576);
ot(pt);
var Et = new Array(60);
ot(Et);
var gt = new Array(512);
ot(gt);
var vt = new Array(256);
ot(vt);
var bt = new Array(29);
ot(bt);
var mt = new Array(ut);
function yt(e2, t2, n2, i2, r2) {
  this.static_tree = e2, this.extra_bits = t2, this.extra_base = n2, this.elems = i2, this.max_length = r2, this.has_stree = e2 && e2.length;
}
var wt;
var St;
var Tt;
function Nt(e2, t2) {
  this.dyn_tree = e2, this.max_code = 0, this.stat_desc = t2;
}
ot(mt);
var Ct = (e2) => e2 < 256 ? gt[e2] : gt[256 + (e2 >>> 7)];
var At = (e2, t2) => {
  e2.pending_buf[e2.pending++] = 255 & t2, e2.pending_buf[e2.pending++] = t2 >>> 8 & 255;
};
var It = (e2, t2, n2) => {
  e2.bi_valid > 16 - n2 ? (e2.bi_buf |= t2 << e2.bi_valid & 65535, At(e2, e2.bi_buf), e2.bi_buf = t2 >> 16 - e2.bi_valid, e2.bi_valid += n2 - 16) : (e2.bi_buf |= t2 << e2.bi_valid & 65535, e2.bi_valid += n2);
};
var kt = (e2, t2, n2) => {
  It(e2, n2[2 * t2], n2[2 * t2 + 1]);
};
var Ot = (e2, t2) => {
  let n2 = 0;
  do {
    n2 |= 1 & e2, e2 >>>= 1, n2 <<= 1;
  } while (--t2 > 0);
  return n2 >>> 1;
};
var Dt = (e2, t2, n2) => {
  const i2 = new Array(16);
  let r2, s2, o2 = 0;
  for (r2 = 1; r2 <= lt; r2++) o2 = o2 + n2[r2 - 1] << 1, i2[r2] = o2;
  for (s2 = 0; s2 <= t2; s2++) {
    let t3 = e2[2 * s2 + 1];
    0 !== t3 && (e2[2 * s2] = Ot(i2[t3]++, t3));
  }
};
var Rt = (e2) => {
  let t2;
  for (t2 = 0; t2 < ct; t2++) e2.dyn_ltree[2 * t2] = 0;
  for (t2 = 0; t2 < ut; t2++) e2.dyn_dtree[2 * t2] = 0;
  for (t2 = 0; t2 < 19; t2++) e2.bl_tree[2 * t2] = 0;
  e2.dyn_ltree[512] = 1, e2.opt_len = e2.static_len = 0, e2.sym_next = e2.matches = 0;
};
var Lt = (e2) => {
  e2.bi_valid > 8 ? At(e2, e2.bi_buf) : e2.bi_valid > 0 && (e2.pending_buf[e2.pending++] = e2.bi_buf), e2.bi_buf = 0, e2.bi_valid = 0;
};
var xt = (e2, t2, n2, i2) => {
  const r2 = 2 * t2, s2 = 2 * n2;
  return e2[r2] < e2[s2] || e2[r2] === e2[s2] && i2[t2] <= i2[n2];
};
var Ut = (e2, t2, n2) => {
  const i2 = e2.heap[n2];
  let r2 = n2 << 1;
  for (; r2 <= e2.heap_len && (r2 < e2.heap_len && xt(t2, e2.heap[r2 + 1], e2.heap[r2], e2.depth) && r2++, !xt(t2, i2, e2.heap[r2], e2.depth)); ) e2.heap[n2] = e2.heap[r2], n2 = r2, r2 <<= 1;
  e2.heap[n2] = i2;
};
var Pt = (e2, t2, n2) => {
  let i2, r2, s2, o2, a2 = 0;
  if (0 !== e2.sym_next) do {
    i2 = 255 & e2.pending_buf[e2.sym_buf + a2++], i2 += (255 & e2.pending_buf[e2.sym_buf + a2++]) << 8, r2 = e2.pending_buf[e2.sym_buf + a2++], 0 === i2 ? kt(e2, r2, t2) : (s2 = vt[r2], kt(e2, s2 + at + 1, t2), o2 = ht[s2], 0 !== o2 && (r2 -= bt[s2], It(e2, r2, o2)), i2--, s2 = Ct(i2), kt(e2, s2, n2), o2 = dt[s2], 0 !== o2 && (i2 -= mt[s2], It(e2, i2, o2)));
  } while (a2 < e2.sym_next);
  kt(e2, 256, t2);
};
var Mt = (e2, t2) => {
  const n2 = t2.dyn_tree, i2 = t2.stat_desc.static_tree, r2 = t2.stat_desc.has_stree, s2 = t2.stat_desc.elems;
  let o2, a2, c2, u2 = -1;
  for (e2.heap_len = 0, e2.heap_max = 573, o2 = 0; o2 < s2; o2++) 0 !== n2[2 * o2] ? (e2.heap[++e2.heap_len] = u2 = o2, e2.depth[o2] = 0) : n2[2 * o2 + 1] = 0;
  for (; e2.heap_len < 2; ) c2 = e2.heap[++e2.heap_len] = u2 < 2 ? ++u2 : 0, n2[2 * c2] = 1, e2.depth[c2] = 0, e2.opt_len--, r2 && (e2.static_len -= i2[2 * c2 + 1]);
  for (t2.max_code = u2, o2 = e2.heap_len >> 1; o2 >= 1; o2--) Ut(e2, n2, o2);
  c2 = s2;
  do {
    o2 = e2.heap[1], e2.heap[1] = e2.heap[e2.heap_len--], Ut(e2, n2, 1), a2 = e2.heap[1], e2.heap[--e2.heap_max] = o2, e2.heap[--e2.heap_max] = a2, n2[2 * c2] = n2[2 * o2] + n2[2 * a2], e2.depth[c2] = (e2.depth[o2] >= e2.depth[a2] ? e2.depth[o2] : e2.depth[a2]) + 1, n2[2 * o2 + 1] = n2[2 * a2 + 1] = c2, e2.heap[1] = c2++, Ut(e2, n2, 1);
  } while (e2.heap_len >= 2);
  e2.heap[--e2.heap_max] = e2.heap[1], ((e3, t3) => {
    const n3 = t3.dyn_tree, i3 = t3.max_code, r3 = t3.stat_desc.static_tree, s3 = t3.stat_desc.has_stree, o3 = t3.stat_desc.extra_bits, a3 = t3.stat_desc.extra_base, c3 = t3.stat_desc.max_length;
    let u3, l2, h2, d2, _2, f2, p2 = 0;
    for (d2 = 0; d2 <= lt; d2++) e3.bl_count[d2] = 0;
    for (n3[2 * e3.heap[e3.heap_max] + 1] = 0, u3 = e3.heap_max + 1; u3 < 573; u3++) l2 = e3.heap[u3], d2 = n3[2 * n3[2 * l2 + 1] + 1] + 1, d2 > c3 && (d2 = c3, p2++), n3[2 * l2 + 1] = d2, l2 > i3 || (e3.bl_count[d2]++, _2 = 0, l2 >= a3 && (_2 = o3[l2 - a3]), f2 = n3[2 * l2], e3.opt_len += f2 * (d2 + _2), s3 && (e3.static_len += f2 * (r3[2 * l2 + 1] + _2)));
    if (0 !== p2) {
      do {
        for (d2 = c3 - 1; 0 === e3.bl_count[d2]; ) d2--;
        e3.bl_count[d2]--, e3.bl_count[d2 + 1] += 2, e3.bl_count[c3]--, p2 -= 2;
      } while (p2 > 0);
      for (d2 = c3; 0 !== d2; d2--) for (l2 = e3.bl_count[d2]; 0 !== l2; ) h2 = e3.heap[--u3], h2 > i3 || (n3[2 * h2 + 1] !== d2 && (e3.opt_len += (d2 - n3[2 * h2 + 1]) * n3[2 * h2], n3[2 * h2 + 1] = d2), l2--);
    }
  })(e2, t2), Dt(n2, u2, e2.bl_count);
};
var Ft = (e2, t2, n2) => {
  let i2, r2, s2 = -1, o2 = t2[1], a2 = 0, c2 = 7, u2 = 4;
  for (0 === o2 && (c2 = 138, u2 = 3), t2[2 * (n2 + 1) + 1] = 65535, i2 = 0; i2 <= n2; i2++) r2 = o2, o2 = t2[2 * (i2 + 1) + 1], ++a2 < c2 && r2 === o2 || (a2 < u2 ? e2.bl_tree[2 * r2] += a2 : 0 !== r2 ? (r2 !== s2 && e2.bl_tree[2 * r2]++, e2.bl_tree[32]++) : a2 <= 10 ? e2.bl_tree[34]++ : e2.bl_tree[36]++, a2 = 0, s2 = r2, 0 === o2 ? (c2 = 138, u2 = 3) : r2 === o2 ? (c2 = 6, u2 = 3) : (c2 = 7, u2 = 4));
};
var qt = (e2, t2, n2) => {
  let i2, r2, s2 = -1, o2 = t2[1], a2 = 0, c2 = 7, u2 = 4;
  for (0 === o2 && (c2 = 138, u2 = 3), i2 = 0; i2 <= n2; i2++) if (r2 = o2, o2 = t2[2 * (i2 + 1) + 1], !(++a2 < c2 && r2 === o2)) {
    if (a2 < u2) do {
      kt(e2, r2, e2.bl_tree);
    } while (0 != --a2);
    else 0 !== r2 ? (r2 !== s2 && (kt(e2, r2, e2.bl_tree), a2--), kt(e2, 16, e2.bl_tree), It(e2, a2 - 3, 2)) : a2 <= 10 ? (kt(e2, 17, e2.bl_tree), It(e2, a2 - 3, 3)) : (kt(e2, 18, e2.bl_tree), It(e2, a2 - 11, 7));
    a2 = 0, s2 = r2, 0 === o2 ? (c2 = 138, u2 = 3) : r2 === o2 ? (c2 = 6, u2 = 3) : (c2 = 7, u2 = 4);
  }
};
var Vt = false;
var Ht = (e2, t2, n2, i2) => {
  It(e2, 0 + (i2 ? 1 : 0), 3), Lt(e2), At(e2, n2), At(e2, ~n2), n2 && e2.pending_buf.set(e2.window.subarray(t2, t2 + n2), e2.pending), e2.pending += n2;
};
var zt = (e2, t2, n2, i2) => {
  let r2, s2, o2 = 0;
  e2.level > 0 ? (2 === e2.strm.data_type && (e2.strm.data_type = ((e3) => {
    let t3, n3 = 4093624447;
    for (t3 = 0; t3 <= 31; t3++, n3 >>>= 1) if (1 & n3 && 0 !== e3.dyn_ltree[2 * t3]) return 0;
    if (0 !== e3.dyn_ltree[18] || 0 !== e3.dyn_ltree[20] || 0 !== e3.dyn_ltree[26]) return 1;
    for (t3 = 32; t3 < at; t3++) if (0 !== e3.dyn_ltree[2 * t3]) return 1;
    return 0;
  })(e2)), Mt(e2, e2.l_desc), Mt(e2, e2.d_desc), o2 = ((e3) => {
    let t3;
    for (Ft(e3, e3.dyn_ltree, e3.l_desc.max_code), Ft(e3, e3.dyn_dtree, e3.d_desc.max_code), Mt(e3, e3.bl_desc), t3 = 18; t3 >= 3 && 0 === e3.bl_tree[2 * ft[t3] + 1]; t3--) ;
    return e3.opt_len += 3 * (t3 + 1) + 5 + 5 + 4, t3;
  })(e2), r2 = e2.opt_len + 3 + 7 >>> 3, s2 = e2.static_len + 3 + 7 >>> 3, s2 <= r2 && (r2 = s2)) : r2 = s2 = n2 + 5, n2 + 4 <= r2 && -1 !== t2 ? Ht(e2, t2, n2, i2) : 4 === e2.strategy || s2 === r2 ? (It(e2, 2 + (i2 ? 1 : 0), 3), Pt(e2, pt, Et)) : (It(e2, 4 + (i2 ? 1 : 0), 3), ((e3, t3, n3, i3) => {
    let r3;
    for (It(e3, t3 - 257, 5), It(e3, n3 - 1, 5), It(e3, i3 - 4, 4), r3 = 0; r3 < i3; r3++) It(e3, e3.bl_tree[2 * ft[r3] + 1], 3);
    qt(e3, e3.dyn_ltree, t3 - 1), qt(e3, e3.dyn_dtree, n3 - 1);
  })(e2, e2.l_desc.max_code + 1, e2.d_desc.max_code + 1, o2 + 1), Pt(e2, e2.dyn_ltree, e2.dyn_dtree)), Rt(e2), i2 && Lt(e2);
};
var Gt = { _tr_init: (e2) => {
  Vt || ((() => {
    let e3, t2, n2, i2, r2;
    const s2 = new Array(16);
    for (n2 = 0, i2 = 0; i2 < 28; i2++) for (bt[i2] = n2, e3 = 0; e3 < 1 << ht[i2]; e3++) vt[n2++] = i2;
    for (vt[n2 - 1] = i2, r2 = 0, i2 = 0; i2 < 16; i2++) for (mt[i2] = r2, e3 = 0; e3 < 1 << dt[i2]; e3++) gt[r2++] = i2;
    for (r2 >>= 7; i2 < ut; i2++) for (mt[i2] = r2 << 7, e3 = 0; e3 < 1 << dt[i2] - 7; e3++) gt[256 + r2++] = i2;
    for (t2 = 0; t2 <= lt; t2++) s2[t2] = 0;
    for (e3 = 0; e3 <= 143; ) pt[2 * e3 + 1] = 8, e3++, s2[8]++;
    for (; e3 <= 255; ) pt[2 * e3 + 1] = 9, e3++, s2[9]++;
    for (; e3 <= 279; ) pt[2 * e3 + 1] = 7, e3++, s2[7]++;
    for (; e3 <= 287; ) pt[2 * e3 + 1] = 8, e3++, s2[8]++;
    for (Dt(pt, 287, s2), e3 = 0; e3 < ut; e3++) Et[2 * e3 + 1] = 5, Et[2 * e3] = Ot(e3, 5);
    wt = new yt(pt, ht, 257, ct, lt), St = new yt(Et, dt, 0, ut, lt), Tt = new yt(new Array(0), _t, 0, 19, 7);
  })(), Vt = true), e2.l_desc = new Nt(e2.dyn_ltree, wt), e2.d_desc = new Nt(e2.dyn_dtree, St), e2.bl_desc = new Nt(e2.bl_tree, Tt), e2.bi_buf = 0, e2.bi_valid = 0, Rt(e2);
}, _tr_stored_block: Ht, _tr_flush_block: zt, _tr_tally: (e2, t2, n2) => (e2.pending_buf[e2.sym_buf + e2.sym_next++] = t2, e2.pending_buf[e2.sym_buf + e2.sym_next++] = t2 >> 8, e2.pending_buf[e2.sym_buf + e2.sym_next++] = n2, 0 === t2 ? e2.dyn_ltree[2 * n2]++ : (e2.matches++, t2--, e2.dyn_ltree[2 * (vt[n2] + at + 1)]++, e2.dyn_dtree[2 * Ct(t2)]++), e2.sym_next === e2.sym_end), _tr_align: (e2) => {
  It(e2, 2, 3), kt(e2, 256, pt), ((e3) => {
    16 === e3.bi_valid ? (At(e3, e3.bi_buf), e3.bi_buf = 0, e3.bi_valid = 0) : e3.bi_valid >= 8 && (e3.pending_buf[e3.pending++] = 255 & e3.bi_buf, e3.bi_buf >>= 8, e3.bi_valid -= 8);
  })(e2);
} };
var jt = (e2, t2, n2, i2) => {
  let r2 = 65535 & e2, s2 = e2 >>> 16 & 65535, o2 = 0;
  for (; 0 !== n2; ) {
    o2 = n2 > 2e3 ? 2e3 : n2, n2 -= o2;
    do {
      r2 = r2 + t2[i2++] | 0, s2 = s2 + r2 | 0;
    } while (--o2);
    r2 %= 65521, s2 %= 65521;
  }
  return r2 | s2 << 16;
};
var Kt = new Uint32Array((() => {
  let e2, t2 = [];
  for (var n2 = 0; n2 < 256; n2++) {
    e2 = n2;
    for (var i2 = 0; i2 < 8; i2++) e2 = 1 & e2 ? 3988292384 ^ e2 >>> 1 : e2 >>> 1;
    t2[n2] = e2;
  }
  return t2;
})());
var Bt = (e2, t2, n2, i2) => {
  const r2 = Kt, s2 = i2 + n2;
  e2 ^= -1;
  for (let n3 = i2; n3 < s2; n3++) e2 = e2 >>> 8 ^ r2[255 & (e2 ^ t2[n3])];
  return ~e2;
};
var Qt = { 2: "need dictionary", 1: "stream end", 0: "", "-1": "file error", "-2": "stream error", "-3": "data error", "-4": "insufficient memory", "-5": "buffer error", "-6": "incompatible version" };
var Wt = { Z_NO_FLUSH: 0, Z_PARTIAL_FLUSH: 1, Z_SYNC_FLUSH: 2, Z_FULL_FLUSH: 3, Z_FINISH: 4, Z_BLOCK: 5, Z_TREES: 6, Z_OK: 0, Z_STREAM_END: 1, Z_NEED_DICT: 2, Z_ERRNO: -1, Z_STREAM_ERROR: -2, Z_DATA_ERROR: -3, Z_MEM_ERROR: -4, Z_BUF_ERROR: -5, Z_NO_COMPRESSION: 0, Z_BEST_SPEED: 1, Z_BEST_COMPRESSION: 9, Z_DEFAULT_COMPRESSION: -1, Z_FILTERED: 1, Z_HUFFMAN_ONLY: 2, Z_RLE: 3, Z_FIXED: 4, Z_DEFAULT_STRATEGY: 0, Z_BINARY: 0, Z_TEXT: 1, Z_UNKNOWN: 2, Z_DEFLATED: 8 };
var { _tr_init: Zt, _tr_stored_block: Yt, _tr_flush_block: Xt, _tr_tally: Jt, _tr_align: $t } = Gt;
var { Z_NO_FLUSH: en, Z_PARTIAL_FLUSH: tn, Z_FULL_FLUSH: nn, Z_FINISH: rn, Z_BLOCK: sn, Z_OK: on, Z_STREAM_END: an, Z_STREAM_ERROR: cn, Z_DATA_ERROR: un, Z_BUF_ERROR: ln, Z_DEFAULT_COMPRESSION: hn, Z_FILTERED: dn, Z_HUFFMAN_ONLY: _n, Z_RLE: fn, Z_FIXED: pn, Z_DEFAULT_STRATEGY: En, Z_UNKNOWN: gn, Z_DEFLATED: vn } = Wt;
var bn = 258;
var mn = 262;
var yn = 42;
var wn = 113;
var Sn = 666;
var Tn = (e2, t2) => (e2.msg = Qt[t2], t2);
var Nn = (e2) => 2 * e2 - (e2 > 4 ? 9 : 0);
var Cn = (e2) => {
  let t2 = e2.length;
  for (; --t2 >= 0; ) e2[t2] = 0;
};
var An = (e2) => {
  let t2, n2, i2, r2 = e2.w_size;
  t2 = e2.hash_size, i2 = t2;
  do {
    n2 = e2.head[--i2], e2.head[i2] = n2 >= r2 ? n2 - r2 : 0;
  } while (--t2);
  t2 = r2, i2 = t2;
  do {
    n2 = e2.prev[--i2], e2.prev[i2] = n2 >= r2 ? n2 - r2 : 0;
  } while (--t2);
};
var In = (e2, t2, n2) => (t2 << e2.hash_shift ^ n2) & e2.hash_mask;
var kn = (e2) => {
  const t2 = e2.state;
  let n2 = t2.pending;
  n2 > e2.avail_out && (n2 = e2.avail_out), 0 !== n2 && (e2.output.set(t2.pending_buf.subarray(t2.pending_out, t2.pending_out + n2), e2.next_out), e2.next_out += n2, t2.pending_out += n2, e2.total_out += n2, e2.avail_out -= n2, t2.pending -= n2, 0 === t2.pending && (t2.pending_out = 0));
};
var On = (e2, t2) => {
  Xt(e2, e2.block_start >= 0 ? e2.block_start : -1, e2.strstart - e2.block_start, t2), e2.block_start = e2.strstart, kn(e2.strm);
};
var Dn = (e2, t2) => {
  e2.pending_buf[e2.pending++] = t2;
};
var Rn = (e2, t2) => {
  e2.pending_buf[e2.pending++] = t2 >>> 8 & 255, e2.pending_buf[e2.pending++] = 255 & t2;
};
var Ln = (e2, t2, n2, i2) => {
  let r2 = e2.avail_in;
  return r2 > i2 && (r2 = i2), 0 === r2 ? 0 : (e2.avail_in -= r2, t2.set(e2.input.subarray(e2.next_in, e2.next_in + r2), n2), 1 === e2.state.wrap ? e2.adler = jt(e2.adler, t2, r2, n2) : 2 === e2.state.wrap && (e2.adler = Bt(e2.adler, t2, r2, n2)), e2.next_in += r2, e2.total_in += r2, r2);
};
var xn = (e2, t2) => {
  let n2, i2, r2 = e2.max_chain_length, s2 = e2.strstart, o2 = e2.prev_length, a2 = e2.nice_match;
  const c2 = e2.strstart > e2.w_size - mn ? e2.strstart - (e2.w_size - mn) : 0, u2 = e2.window, l2 = e2.w_mask, h2 = e2.prev, d2 = e2.strstart + bn;
  let _2 = u2[s2 + o2 - 1], f2 = u2[s2 + o2];
  e2.prev_length >= e2.good_match && (r2 >>= 2), a2 > e2.lookahead && (a2 = e2.lookahead);
  do {
    if (n2 = t2, u2[n2 + o2] === f2 && u2[n2 + o2 - 1] === _2 && u2[n2] === u2[s2] && u2[++n2] === u2[s2 + 1]) {
      s2 += 2, n2++;
      do {
      } while (u2[++s2] === u2[++n2] && u2[++s2] === u2[++n2] && u2[++s2] === u2[++n2] && u2[++s2] === u2[++n2] && u2[++s2] === u2[++n2] && u2[++s2] === u2[++n2] && u2[++s2] === u2[++n2] && u2[++s2] === u2[++n2] && s2 < d2);
      if (i2 = bn - (d2 - s2), s2 = d2 - bn, i2 > o2) {
        if (e2.match_start = t2, o2 = i2, i2 >= a2) break;
        _2 = u2[s2 + o2 - 1], f2 = u2[s2 + o2];
      }
    }
  } while ((t2 = h2[t2 & l2]) > c2 && 0 != --r2);
  return o2 <= e2.lookahead ? o2 : e2.lookahead;
};
var Un = (e2) => {
  const t2 = e2.w_size;
  let n2, i2, r2;
  do {
    if (i2 = e2.window_size - e2.lookahead - e2.strstart, e2.strstart >= t2 + (t2 - mn) && (e2.window.set(e2.window.subarray(t2, t2 + t2 - i2), 0), e2.match_start -= t2, e2.strstart -= t2, e2.block_start -= t2, e2.insert > e2.strstart && (e2.insert = e2.strstart), An(e2), i2 += t2), 0 === e2.strm.avail_in) break;
    if (n2 = Ln(e2.strm, e2.window, e2.strstart + e2.lookahead, i2), e2.lookahead += n2, e2.lookahead + e2.insert >= 3) for (r2 = e2.strstart - e2.insert, e2.ins_h = e2.window[r2], e2.ins_h = In(e2, e2.ins_h, e2.window[r2 + 1]); e2.insert && (e2.ins_h = In(e2, e2.ins_h, e2.window[r2 + 3 - 1]), e2.prev[r2 & e2.w_mask] = e2.head[e2.ins_h], e2.head[e2.ins_h] = r2, r2++, e2.insert--, !(e2.lookahead + e2.insert < 3)); ) ;
  } while (e2.lookahead < mn && 0 !== e2.strm.avail_in);
};
var Pn = (e2, t2) => {
  let n2, i2, r2, s2 = e2.pending_buf_size - 5 > e2.w_size ? e2.w_size : e2.pending_buf_size - 5, o2 = 0, a2 = e2.strm.avail_in;
  do {
    if (n2 = 65535, r2 = e2.bi_valid + 42 >> 3, e2.strm.avail_out < r2) break;
    if (r2 = e2.strm.avail_out - r2, i2 = e2.strstart - e2.block_start, n2 > i2 + e2.strm.avail_in && (n2 = i2 + e2.strm.avail_in), n2 > r2 && (n2 = r2), n2 < s2 && (0 === n2 && t2 !== rn || t2 === en || n2 !== i2 + e2.strm.avail_in)) break;
    o2 = t2 === rn && n2 === i2 + e2.strm.avail_in ? 1 : 0, Yt(e2, 0, 0, o2), e2.pending_buf[e2.pending - 4] = n2, e2.pending_buf[e2.pending - 3] = n2 >> 8, e2.pending_buf[e2.pending - 2] = ~n2, e2.pending_buf[e2.pending - 1] = ~n2 >> 8, kn(e2.strm), i2 && (i2 > n2 && (i2 = n2), e2.strm.output.set(e2.window.subarray(e2.block_start, e2.block_start + i2), e2.strm.next_out), e2.strm.next_out += i2, e2.strm.avail_out -= i2, e2.strm.total_out += i2, e2.block_start += i2, n2 -= i2), n2 && (Ln(e2.strm, e2.strm.output, e2.strm.next_out, n2), e2.strm.next_out += n2, e2.strm.avail_out -= n2, e2.strm.total_out += n2);
  } while (0 === o2);
  return a2 -= e2.strm.avail_in, a2 && (a2 >= e2.w_size ? (e2.matches = 2, e2.window.set(e2.strm.input.subarray(e2.strm.next_in - e2.w_size, e2.strm.next_in), 0), e2.strstart = e2.w_size, e2.insert = e2.strstart) : (e2.window_size - e2.strstart <= a2 && (e2.strstart -= e2.w_size, e2.window.set(e2.window.subarray(e2.w_size, e2.w_size + e2.strstart), 0), e2.matches < 2 && e2.matches++, e2.insert > e2.strstart && (e2.insert = e2.strstart)), e2.window.set(e2.strm.input.subarray(e2.strm.next_in - a2, e2.strm.next_in), e2.strstart), e2.strstart += a2, e2.insert += a2 > e2.w_size - e2.insert ? e2.w_size - e2.insert : a2), e2.block_start = e2.strstart), e2.high_water < e2.strstart && (e2.high_water = e2.strstart), o2 ? 4 : t2 !== en && t2 !== rn && 0 === e2.strm.avail_in && e2.strstart === e2.block_start ? 2 : (r2 = e2.window_size - e2.strstart, e2.strm.avail_in > r2 && e2.block_start >= e2.w_size && (e2.block_start -= e2.w_size, e2.strstart -= e2.w_size, e2.window.set(e2.window.subarray(e2.w_size, e2.w_size + e2.strstart), 0), e2.matches < 2 && e2.matches++, r2 += e2.w_size, e2.insert > e2.strstart && (e2.insert = e2.strstart)), r2 > e2.strm.avail_in && (r2 = e2.strm.avail_in), r2 && (Ln(e2.strm, e2.window, e2.strstart, r2), e2.strstart += r2, e2.insert += r2 > e2.w_size - e2.insert ? e2.w_size - e2.insert : r2), e2.high_water < e2.strstart && (e2.high_water = e2.strstart), r2 = e2.bi_valid + 42 >> 3, r2 = e2.pending_buf_size - r2 > 65535 ? 65535 : e2.pending_buf_size - r2, s2 = r2 > e2.w_size ? e2.w_size : r2, i2 = e2.strstart - e2.block_start, (i2 >= s2 || (i2 || t2 === rn) && t2 !== en && 0 === e2.strm.avail_in && i2 <= r2) && (n2 = i2 > r2 ? r2 : i2, o2 = t2 === rn && 0 === e2.strm.avail_in && n2 === i2 ? 1 : 0, Yt(e2, e2.block_start, n2, o2), e2.block_start += n2, kn(e2.strm)), o2 ? 3 : 1);
};
var Mn = (e2, t2) => {
  let n2, i2;
  for (; ; ) {
    if (e2.lookahead < mn) {
      if (Un(e2), e2.lookahead < mn && t2 === en) return 1;
      if (0 === e2.lookahead) break;
    }
    if (n2 = 0, e2.lookahead >= 3 && (e2.ins_h = In(e2, e2.ins_h, e2.window[e2.strstart + 3 - 1]), n2 = e2.prev[e2.strstart & e2.w_mask] = e2.head[e2.ins_h], e2.head[e2.ins_h] = e2.strstart), 0 !== n2 && e2.strstart - n2 <= e2.w_size - mn && (e2.match_length = xn(e2, n2)), e2.match_length >= 3) if (i2 = Jt(e2, e2.strstart - e2.match_start, e2.match_length - 3), e2.lookahead -= e2.match_length, e2.match_length <= e2.max_lazy_match && e2.lookahead >= 3) {
      e2.match_length--;
      do {
        e2.strstart++, e2.ins_h = In(e2, e2.ins_h, e2.window[e2.strstart + 3 - 1]), n2 = e2.prev[e2.strstart & e2.w_mask] = e2.head[e2.ins_h], e2.head[e2.ins_h] = e2.strstart;
      } while (0 != --e2.match_length);
      e2.strstart++;
    } else e2.strstart += e2.match_length, e2.match_length = 0, e2.ins_h = e2.window[e2.strstart], e2.ins_h = In(e2, e2.ins_h, e2.window[e2.strstart + 1]);
    else i2 = Jt(e2, 0, e2.window[e2.strstart]), e2.lookahead--, e2.strstart++;
    if (i2 && (On(e2, false), 0 === e2.strm.avail_out)) return 1;
  }
  return e2.insert = e2.strstart < 2 ? e2.strstart : 2, t2 === rn ? (On(e2, true), 0 === e2.strm.avail_out ? 3 : 4) : e2.sym_next && (On(e2, false), 0 === e2.strm.avail_out) ? 1 : 2;
};
var Fn = (e2, t2) => {
  let n2, i2, r2;
  for (; ; ) {
    if (e2.lookahead < mn) {
      if (Un(e2), e2.lookahead < mn && t2 === en) return 1;
      if (0 === e2.lookahead) break;
    }
    if (n2 = 0, e2.lookahead >= 3 && (e2.ins_h = In(e2, e2.ins_h, e2.window[e2.strstart + 3 - 1]), n2 = e2.prev[e2.strstart & e2.w_mask] = e2.head[e2.ins_h], e2.head[e2.ins_h] = e2.strstart), e2.prev_length = e2.match_length, e2.prev_match = e2.match_start, e2.match_length = 2, 0 !== n2 && e2.prev_length < e2.max_lazy_match && e2.strstart - n2 <= e2.w_size - mn && (e2.match_length = xn(e2, n2), e2.match_length <= 5 && (e2.strategy === dn || 3 === e2.match_length && e2.strstart - e2.match_start > 4096) && (e2.match_length = 2)), e2.prev_length >= 3 && e2.match_length <= e2.prev_length) {
      r2 = e2.strstart + e2.lookahead - 3, i2 = Jt(e2, e2.strstart - 1 - e2.prev_match, e2.prev_length - 3), e2.lookahead -= e2.prev_length - 1, e2.prev_length -= 2;
      do {
        ++e2.strstart <= r2 && (e2.ins_h = In(e2, e2.ins_h, e2.window[e2.strstart + 3 - 1]), n2 = e2.prev[e2.strstart & e2.w_mask] = e2.head[e2.ins_h], e2.head[e2.ins_h] = e2.strstart);
      } while (0 != --e2.prev_length);
      if (e2.match_available = 0, e2.match_length = 2, e2.strstart++, i2 && (On(e2, false), 0 === e2.strm.avail_out)) return 1;
    } else if (e2.match_available) {
      if (i2 = Jt(e2, 0, e2.window[e2.strstart - 1]), i2 && On(e2, false), e2.strstart++, e2.lookahead--, 0 === e2.strm.avail_out) return 1;
    } else e2.match_available = 1, e2.strstart++, e2.lookahead--;
  }
  return e2.match_available && (i2 = Jt(e2, 0, e2.window[e2.strstart - 1]), e2.match_available = 0), e2.insert = e2.strstart < 2 ? e2.strstart : 2, t2 === rn ? (On(e2, true), 0 === e2.strm.avail_out ? 3 : 4) : e2.sym_next && (On(e2, false), 0 === e2.strm.avail_out) ? 1 : 2;
};
function qn(e2, t2, n2, i2, r2) {
  this.good_length = e2, this.max_lazy = t2, this.nice_length = n2, this.max_chain = i2, this.func = r2;
}
var Vn = [new qn(0, 0, 0, 0, Pn), new qn(4, 4, 8, 4, Mn), new qn(4, 5, 16, 8, Mn), new qn(4, 6, 32, 32, Mn), new qn(4, 4, 16, 16, Fn), new qn(8, 16, 32, 32, Fn), new qn(8, 16, 128, 128, Fn), new qn(8, 32, 128, 256, Fn), new qn(32, 128, 258, 1024, Fn), new qn(32, 258, 258, 4096, Fn)];
function Hn() {
  this.strm = null, this.status = 0, this.pending_buf = null, this.pending_buf_size = 0, this.pending_out = 0, this.pending = 0, this.wrap = 0, this.gzhead = null, this.gzindex = 0, this.method = vn, this.last_flush = -1, this.w_size = 0, this.w_bits = 0, this.w_mask = 0, this.window = null, this.window_size = 0, this.prev = null, this.head = null, this.ins_h = 0, this.hash_size = 0, this.hash_bits = 0, this.hash_mask = 0, this.hash_shift = 0, this.block_start = 0, this.match_length = 0, this.prev_match = 0, this.match_available = 0, this.strstart = 0, this.match_start = 0, this.lookahead = 0, this.prev_length = 0, this.max_chain_length = 0, this.max_lazy_match = 0, this.level = 0, this.strategy = 0, this.good_match = 0, this.nice_match = 0, this.dyn_ltree = new Uint16Array(1146), this.dyn_dtree = new Uint16Array(122), this.bl_tree = new Uint16Array(78), Cn(this.dyn_ltree), Cn(this.dyn_dtree), Cn(this.bl_tree), this.l_desc = null, this.d_desc = null, this.bl_desc = null, this.bl_count = new Uint16Array(16), this.heap = new Uint16Array(573), Cn(this.heap), this.heap_len = 0, this.heap_max = 0, this.depth = new Uint16Array(573), Cn(this.depth), this.sym_buf = 0, this.lit_bufsize = 0, this.sym_next = 0, this.sym_end = 0, this.opt_len = 0, this.static_len = 0, this.matches = 0, this.insert = 0, this.bi_buf = 0, this.bi_valid = 0;
}
var zn = (e2) => {
  if (!e2) return 1;
  const t2 = e2.state;
  return !t2 || t2.strm !== e2 || t2.status !== yn && 57 !== t2.status && 69 !== t2.status && 73 !== t2.status && 91 !== t2.status && 103 !== t2.status && t2.status !== wn && t2.status !== Sn ? 1 : 0;
};
var Gn = (e2) => {
  if (zn(e2)) return Tn(e2, cn);
  e2.total_in = e2.total_out = 0, e2.data_type = gn;
  const t2 = e2.state;
  return t2.pending = 0, t2.pending_out = 0, t2.wrap < 0 && (t2.wrap = -t2.wrap), t2.status = 2 === t2.wrap ? 57 : t2.wrap ? yn : wn, e2.adler = 2 === t2.wrap ? 0 : 1, t2.last_flush = -2, Zt(t2), on;
};
var jn = (e2) => {
  const t2 = Gn(e2);
  var n2;
  return t2 === on && ((n2 = e2.state).window_size = 2 * n2.w_size, Cn(n2.head), n2.max_lazy_match = Vn[n2.level].max_lazy, n2.good_match = Vn[n2.level].good_length, n2.nice_match = Vn[n2.level].nice_length, n2.max_chain_length = Vn[n2.level].max_chain, n2.strstart = 0, n2.block_start = 0, n2.lookahead = 0, n2.insert = 0, n2.match_length = n2.prev_length = 2, n2.match_available = 0, n2.ins_h = 0), t2;
};
var Kn = (e2, t2, n2, i2, r2, s2) => {
  if (!e2) return cn;
  let o2 = 1;
  if (t2 === hn && (t2 = 6), i2 < 0 ? (o2 = 0, i2 = -i2) : i2 > 15 && (o2 = 2, i2 -= 16), r2 < 1 || r2 > 9 || n2 !== vn || i2 < 8 || i2 > 15 || t2 < 0 || t2 > 9 || s2 < 0 || s2 > pn || 8 === i2 && 1 !== o2) return Tn(e2, cn);
  8 === i2 && (i2 = 9);
  const a2 = new Hn();
  return e2.state = a2, a2.strm = e2, a2.status = yn, a2.wrap = o2, a2.gzhead = null, a2.w_bits = i2, a2.w_size = 1 << a2.w_bits, a2.w_mask = a2.w_size - 1, a2.hash_bits = r2 + 7, a2.hash_size = 1 << a2.hash_bits, a2.hash_mask = a2.hash_size - 1, a2.hash_shift = ~~((a2.hash_bits + 3 - 1) / 3), a2.window = new Uint8Array(2 * a2.w_size), a2.head = new Uint16Array(a2.hash_size), a2.prev = new Uint16Array(a2.w_size), a2.lit_bufsize = 1 << r2 + 6, a2.pending_buf_size = 4 * a2.lit_bufsize, a2.pending_buf = new Uint8Array(a2.pending_buf_size), a2.sym_buf = a2.lit_bufsize, a2.sym_end = 3 * (a2.lit_bufsize - 1), a2.level = t2, a2.strategy = s2, a2.method = n2, jn(e2);
};
var Bn = { deflateInit: (e2, t2) => Kn(e2, t2, vn, 15, 8, En), deflateInit2: Kn, deflateReset: jn, deflateResetKeep: Gn, deflateSetHeader: (e2, t2) => zn(e2) || 2 !== e2.state.wrap ? cn : (e2.state.gzhead = t2, on), deflate: (e2, t2) => {
  if (zn(e2) || t2 > sn || t2 < 0) return e2 ? Tn(e2, cn) : cn;
  const n2 = e2.state;
  if (!e2.output || 0 !== e2.avail_in && !e2.input || n2.status === Sn && t2 !== rn) return Tn(e2, 0 === e2.avail_out ? ln : cn);
  const i2 = n2.last_flush;
  if (n2.last_flush = t2, 0 !== n2.pending) {
    if (kn(e2), 0 === e2.avail_out) return n2.last_flush = -1, on;
  } else if (0 === e2.avail_in && Nn(t2) <= Nn(i2) && t2 !== rn) return Tn(e2, ln);
  if (n2.status === Sn && 0 !== e2.avail_in) return Tn(e2, ln);
  if (n2.status === yn && 0 === n2.wrap && (n2.status = wn), n2.status === yn) {
    let t3 = vn + (n2.w_bits - 8 << 4) << 8, i3 = -1;
    if (i3 = n2.strategy >= _n || n2.level < 2 ? 0 : n2.level < 6 ? 1 : 6 === n2.level ? 2 : 3, t3 |= i3 << 6, 0 !== n2.strstart && (t3 |= 32), t3 += 31 - t3 % 31, Rn(n2, t3), 0 !== n2.strstart && (Rn(n2, e2.adler >>> 16), Rn(n2, 65535 & e2.adler)), e2.adler = 1, n2.status = wn, kn(e2), 0 !== n2.pending) return n2.last_flush = -1, on;
  }
  if (57 === n2.status) {
    if (e2.adler = 0, Dn(n2, 31), Dn(n2, 139), Dn(n2, 8), n2.gzhead) Dn(n2, (n2.gzhead.text ? 1 : 0) + (n2.gzhead.hcrc ? 2 : 0) + (n2.gzhead.extra ? 4 : 0) + (n2.gzhead.name ? 8 : 0) + (n2.gzhead.comment ? 16 : 0)), Dn(n2, 255 & n2.gzhead.time), Dn(n2, n2.gzhead.time >> 8 & 255), Dn(n2, n2.gzhead.time >> 16 & 255), Dn(n2, n2.gzhead.time >> 24 & 255), Dn(n2, 9 === n2.level ? 2 : n2.strategy >= _n || n2.level < 2 ? 4 : 0), Dn(n2, 255 & n2.gzhead.os), n2.gzhead.extra && n2.gzhead.extra.length && (Dn(n2, 255 & n2.gzhead.extra.length), Dn(n2, n2.gzhead.extra.length >> 8 & 255)), n2.gzhead.hcrc && (e2.adler = Bt(e2.adler, n2.pending_buf, n2.pending, 0)), n2.gzindex = 0, n2.status = 69;
    else if (Dn(n2, 0), Dn(n2, 0), Dn(n2, 0), Dn(n2, 0), Dn(n2, 0), Dn(n2, 9 === n2.level ? 2 : n2.strategy >= _n || n2.level < 2 ? 4 : 0), Dn(n2, 3), n2.status = wn, kn(e2), 0 !== n2.pending) return n2.last_flush = -1, on;
  }
  if (69 === n2.status) {
    if (n2.gzhead.extra) {
      let t3 = n2.pending, i3 = (65535 & n2.gzhead.extra.length) - n2.gzindex;
      for (; n2.pending + i3 > n2.pending_buf_size; ) {
        let r3 = n2.pending_buf_size - n2.pending;
        if (n2.pending_buf.set(n2.gzhead.extra.subarray(n2.gzindex, n2.gzindex + r3), n2.pending), n2.pending = n2.pending_buf_size, n2.gzhead.hcrc && n2.pending > t3 && (e2.adler = Bt(e2.adler, n2.pending_buf, n2.pending - t3, t3)), n2.gzindex += r3, kn(e2), 0 !== n2.pending) return n2.last_flush = -1, on;
        t3 = 0, i3 -= r3;
      }
      let r2 = new Uint8Array(n2.gzhead.extra);
      n2.pending_buf.set(r2.subarray(n2.gzindex, n2.gzindex + i3), n2.pending), n2.pending += i3, n2.gzhead.hcrc && n2.pending > t3 && (e2.adler = Bt(e2.adler, n2.pending_buf, n2.pending - t3, t3)), n2.gzindex = 0;
    }
    n2.status = 73;
  }
  if (73 === n2.status) {
    if (n2.gzhead.name) {
      let t3, i3 = n2.pending;
      do {
        if (n2.pending === n2.pending_buf_size) {
          if (n2.gzhead.hcrc && n2.pending > i3 && (e2.adler = Bt(e2.adler, n2.pending_buf, n2.pending - i3, i3)), kn(e2), 0 !== n2.pending) return n2.last_flush = -1, on;
          i3 = 0;
        }
        t3 = n2.gzindex < n2.gzhead.name.length ? 255 & n2.gzhead.name.charCodeAt(n2.gzindex++) : 0, Dn(n2, t3);
      } while (0 !== t3);
      n2.gzhead.hcrc && n2.pending > i3 && (e2.adler = Bt(e2.adler, n2.pending_buf, n2.pending - i3, i3)), n2.gzindex = 0;
    }
    n2.status = 91;
  }
  if (91 === n2.status) {
    if (n2.gzhead.comment) {
      let t3, i3 = n2.pending;
      do {
        if (n2.pending === n2.pending_buf_size) {
          if (n2.gzhead.hcrc && n2.pending > i3 && (e2.adler = Bt(e2.adler, n2.pending_buf, n2.pending - i3, i3)), kn(e2), 0 !== n2.pending) return n2.last_flush = -1, on;
          i3 = 0;
        }
        t3 = n2.gzindex < n2.gzhead.comment.length ? 255 & n2.gzhead.comment.charCodeAt(n2.gzindex++) : 0, Dn(n2, t3);
      } while (0 !== t3);
      n2.gzhead.hcrc && n2.pending > i3 && (e2.adler = Bt(e2.adler, n2.pending_buf, n2.pending - i3, i3));
    }
    n2.status = 103;
  }
  if (103 === n2.status) {
    if (n2.gzhead.hcrc) {
      if (n2.pending + 2 > n2.pending_buf_size && (kn(e2), 0 !== n2.pending)) return n2.last_flush = -1, on;
      Dn(n2, 255 & e2.adler), Dn(n2, e2.adler >> 8 & 255), e2.adler = 0;
    }
    if (n2.status = wn, kn(e2), 0 !== n2.pending) return n2.last_flush = -1, on;
  }
  if (0 !== e2.avail_in || 0 !== n2.lookahead || t2 !== en && n2.status !== Sn) {
    let i3 = 0 === n2.level ? Pn(n2, t2) : n2.strategy === _n ? ((e3, t3) => {
      let n3;
      for (; ; ) {
        if (0 === e3.lookahead && (Un(e3), 0 === e3.lookahead)) {
          if (t3 === en) return 1;
          break;
        }
        if (e3.match_length = 0, n3 = Jt(e3, 0, e3.window[e3.strstart]), e3.lookahead--, e3.strstart++, n3 && (On(e3, false), 0 === e3.strm.avail_out)) return 1;
      }
      return e3.insert = 0, t3 === rn ? (On(e3, true), 0 === e3.strm.avail_out ? 3 : 4) : e3.sym_next && (On(e3, false), 0 === e3.strm.avail_out) ? 1 : 2;
    })(n2, t2) : n2.strategy === fn ? ((e3, t3) => {
      let n3, i4, r2, s2;
      const o2 = e3.window;
      for (; ; ) {
        if (e3.lookahead <= bn) {
          if (Un(e3), e3.lookahead <= bn && t3 === en) return 1;
          if (0 === e3.lookahead) break;
        }
        if (e3.match_length = 0, e3.lookahead >= 3 && e3.strstart > 0 && (r2 = e3.strstart - 1, i4 = o2[r2], i4 === o2[++r2] && i4 === o2[++r2] && i4 === o2[++r2])) {
          s2 = e3.strstart + bn;
          do {
          } while (i4 === o2[++r2] && i4 === o2[++r2] && i4 === o2[++r2] && i4 === o2[++r2] && i4 === o2[++r2] && i4 === o2[++r2] && i4 === o2[++r2] && i4 === o2[++r2] && r2 < s2);
          e3.match_length = bn - (s2 - r2), e3.match_length > e3.lookahead && (e3.match_length = e3.lookahead);
        }
        if (e3.match_length >= 3 ? (n3 = Jt(e3, 1, e3.match_length - 3), e3.lookahead -= e3.match_length, e3.strstart += e3.match_length, e3.match_length = 0) : (n3 = Jt(e3, 0, e3.window[e3.strstart]), e3.lookahead--, e3.strstart++), n3 && (On(e3, false), 0 === e3.strm.avail_out)) return 1;
      }
      return e3.insert = 0, t3 === rn ? (On(e3, true), 0 === e3.strm.avail_out ? 3 : 4) : e3.sym_next && (On(e3, false), 0 === e3.strm.avail_out) ? 1 : 2;
    })(n2, t2) : Vn[n2.level].func(n2, t2);
    if (3 !== i3 && 4 !== i3 || (n2.status = Sn), 1 === i3 || 3 === i3) return 0 === e2.avail_out && (n2.last_flush = -1), on;
    if (2 === i3 && (t2 === tn ? $t(n2) : t2 !== sn && (Yt(n2, 0, 0, false), t2 === nn && (Cn(n2.head), 0 === n2.lookahead && (n2.strstart = 0, n2.block_start = 0, n2.insert = 0))), kn(e2), 0 === e2.avail_out)) return n2.last_flush = -1, on;
  }
  return t2 !== rn ? on : n2.wrap <= 0 ? an : (2 === n2.wrap ? (Dn(n2, 255 & e2.adler), Dn(n2, e2.adler >> 8 & 255), Dn(n2, e2.adler >> 16 & 255), Dn(n2, e2.adler >> 24 & 255), Dn(n2, 255 & e2.total_in), Dn(n2, e2.total_in >> 8 & 255), Dn(n2, e2.total_in >> 16 & 255), Dn(n2, e2.total_in >> 24 & 255)) : (Rn(n2, e2.adler >>> 16), Rn(n2, 65535 & e2.adler)), kn(e2), n2.wrap > 0 && (n2.wrap = -n2.wrap), 0 !== n2.pending ? on : an);
}, deflateEnd: (e2) => {
  if (zn(e2)) return cn;
  const t2 = e2.state.status;
  return e2.state = null, t2 === wn ? Tn(e2, un) : on;
}, deflateSetDictionary: (e2, t2) => {
  let n2 = t2.length;
  if (zn(e2)) return cn;
  const i2 = e2.state, r2 = i2.wrap;
  if (2 === r2 || 1 === r2 && i2.status !== yn || i2.lookahead) return cn;
  if (1 === r2 && (e2.adler = jt(e2.adler, t2, n2, 0)), i2.wrap = 0, n2 >= i2.w_size) {
    0 === r2 && (Cn(i2.head), i2.strstart = 0, i2.block_start = 0, i2.insert = 0);
    let e3 = new Uint8Array(i2.w_size);
    e3.set(t2.subarray(n2 - i2.w_size, n2), 0), t2 = e3, n2 = i2.w_size;
  }
  const s2 = e2.avail_in, o2 = e2.next_in, a2 = e2.input;
  for (e2.avail_in = n2, e2.next_in = 0, e2.input = t2, Un(i2); i2.lookahead >= 3; ) {
    let e3 = i2.strstart, t3 = i2.lookahead - 2;
    do {
      i2.ins_h = In(i2, i2.ins_h, i2.window[e3 + 3 - 1]), i2.prev[e3 & i2.w_mask] = i2.head[i2.ins_h], i2.head[i2.ins_h] = e3, e3++;
    } while (--t3);
    i2.strstart = e3, i2.lookahead = 2, Un(i2);
  }
  return i2.strstart += i2.lookahead, i2.block_start = i2.strstart, i2.insert = i2.lookahead, i2.lookahead = 0, i2.match_length = i2.prev_length = 2, i2.match_available = 0, e2.next_in = o2, e2.input = a2, e2.avail_in = s2, i2.wrap = r2, on;
}, deflateInfo: "pako deflate (from Nodeca project)" };
var Qn = (e2, t2) => Object.prototype.hasOwnProperty.call(e2, t2);
var Wn = { assign: function(e2) {
  const t2 = Array.prototype.slice.call(arguments, 1);
  for (; t2.length; ) {
    const n2 = t2.shift();
    if (n2) {
      if ("object" != typeof n2) throw new TypeError(n2 + "must be non-object");
      for (const t3 in n2) Qn(n2, t3) && (e2[t3] = n2[t3]);
    }
  }
  return e2;
}, flattenChunks: (e2) => {
  let t2 = 0;
  for (let n3 = 0, i2 = e2.length; n3 < i2; n3++) t2 += e2[n3].length;
  const n2 = new Uint8Array(t2);
  for (let t3 = 0, i2 = 0, r2 = e2.length; t3 < r2; t3++) {
    let r3 = e2[t3];
    n2.set(r3, i2), i2 += r3.length;
  }
  return n2;
} };
var Zn = true;
try {
  String.fromCharCode.apply(null, new Uint8Array(1));
} catch (e2) {
  Zn = false;
}
var Yn = new Uint8Array(256);
for (let e2 = 0; e2 < 256; e2++) Yn[e2] = e2 >= 252 ? 6 : e2 >= 248 ? 5 : e2 >= 240 ? 4 : e2 >= 224 ? 3 : e2 >= 192 ? 2 : 1;
Yn[254] = Yn[254] = 1;
var Xn = { string2buf: (e2) => {
  if ("function" == typeof TextEncoder && TextEncoder.prototype.encode) return new TextEncoder().encode(e2);
  let t2, n2, i2, r2, s2, o2 = e2.length, a2 = 0;
  for (r2 = 0; r2 < o2; r2++) n2 = e2.charCodeAt(r2), 55296 == (64512 & n2) && r2 + 1 < o2 && (i2 = e2.charCodeAt(r2 + 1), 56320 == (64512 & i2) && (n2 = 65536 + (n2 - 55296 << 10) + (i2 - 56320), r2++)), a2 += n2 < 128 ? 1 : n2 < 2048 ? 2 : n2 < 65536 ? 3 : 4;
  for (t2 = new Uint8Array(a2), s2 = 0, r2 = 0; s2 < a2; r2++) n2 = e2.charCodeAt(r2), 55296 == (64512 & n2) && r2 + 1 < o2 && (i2 = e2.charCodeAt(r2 + 1), 56320 == (64512 & i2) && (n2 = 65536 + (n2 - 55296 << 10) + (i2 - 56320), r2++)), n2 < 128 ? t2[s2++] = n2 : n2 < 2048 ? (t2[s2++] = 192 | n2 >>> 6, t2[s2++] = 128 | 63 & n2) : n2 < 65536 ? (t2[s2++] = 224 | n2 >>> 12, t2[s2++] = 128 | n2 >>> 6 & 63, t2[s2++] = 128 | 63 & n2) : (t2[s2++] = 240 | n2 >>> 18, t2[s2++] = 128 | n2 >>> 12 & 63, t2[s2++] = 128 | n2 >>> 6 & 63, t2[s2++] = 128 | 63 & n2);
  return t2;
}, buf2string: (e2, t2) => {
  const n2 = t2 || e2.length;
  if ("function" == typeof TextDecoder && TextDecoder.prototype.decode) return new TextDecoder().decode(e2.subarray(0, t2));
  let i2, r2;
  const s2 = new Array(2 * n2);
  for (r2 = 0, i2 = 0; i2 < n2; ) {
    let t3 = e2[i2++];
    if (t3 < 128) {
      s2[r2++] = t3;
      continue;
    }
    let o2 = Yn[t3];
    if (o2 > 4) s2[r2++] = 65533, i2 += o2 - 1;
    else {
      for (t3 &= 2 === o2 ? 31 : 3 === o2 ? 15 : 7; o2 > 1 && i2 < n2; ) t3 = t3 << 6 | 63 & e2[i2++], o2--;
      o2 > 1 ? s2[r2++] = 65533 : t3 < 65536 ? s2[r2++] = t3 : (t3 -= 65536, s2[r2++] = 55296 | t3 >> 10 & 1023, s2[r2++] = 56320 | 1023 & t3);
    }
  }
  return ((e3, t3) => {
    if (t3 < 65534 && e3.subarray && Zn) return String.fromCharCode.apply(null, e3.length === t3 ? e3 : e3.subarray(0, t3));
    let n3 = "";
    for (let i3 = 0; i3 < t3; i3++) n3 += String.fromCharCode(e3[i3]);
    return n3;
  })(s2, r2);
}, utf8border: (e2, t2) => {
  (t2 = t2 || e2.length) > e2.length && (t2 = e2.length);
  let n2 = t2 - 1;
  for (; n2 >= 0 && 128 == (192 & e2[n2]); ) n2--;
  return n2 < 0 || 0 === n2 ? t2 : n2 + Yn[e2[n2]] > t2 ? n2 : t2;
} };
var Jn = function() {
  this.input = null, this.next_in = 0, this.avail_in = 0, this.total_in = 0, this.output = null, this.next_out = 0, this.avail_out = 0, this.total_out = 0, this.msg = "", this.state = null, this.data_type = 2, this.adler = 0;
};
var $n = Object.prototype.toString;
var { Z_NO_FLUSH: ei, Z_SYNC_FLUSH: ti, Z_FULL_FLUSH: ni, Z_FINISH: ii, Z_OK: ri, Z_STREAM_END: si, Z_DEFAULT_COMPRESSION: oi, Z_DEFAULT_STRATEGY: ai, Z_DEFLATED: ci } = Wt;
function ui(e2) {
  this.options = Wn.assign({ level: oi, method: ci, chunkSize: 16384, windowBits: 15, memLevel: 8, strategy: ai }, e2 || {});
  let t2 = this.options;
  t2.raw && t2.windowBits > 0 ? t2.windowBits = -t2.windowBits : t2.gzip && t2.windowBits > 0 && t2.windowBits < 16 && (t2.windowBits += 16), this.err = 0, this.msg = "", this.ended = false, this.chunks = [], this.strm = new Jn(), this.strm.avail_out = 0;
  let n2 = Bn.deflateInit2(this.strm, t2.level, t2.method, t2.windowBits, t2.memLevel, t2.strategy);
  if (n2 !== ri) throw new Error(Qt[n2]);
  if (t2.header && Bn.deflateSetHeader(this.strm, t2.header), t2.dictionary) {
    let e3;
    if (e3 = "string" == typeof t2.dictionary ? Xn.string2buf(t2.dictionary) : "[object ArrayBuffer]" === $n.call(t2.dictionary) ? new Uint8Array(t2.dictionary) : t2.dictionary, n2 = Bn.deflateSetDictionary(this.strm, e3), n2 !== ri) throw new Error(Qt[n2]);
    this._dict_set = true;
  }
}
function li(e2, t2) {
  const n2 = new ui(t2);
  if (n2.push(e2, true), n2.err) throw n2.msg || Qt[n2.err];
  return n2.result;
}
ui.prototype.push = function(e2, t2) {
  const n2 = this.strm, i2 = this.options.chunkSize;
  let r2, s2;
  if (this.ended) return false;
  for (s2 = t2 === ~~t2 ? t2 : true === t2 ? ii : ei, "string" == typeof e2 ? n2.input = Xn.string2buf(e2) : "[object ArrayBuffer]" === $n.call(e2) ? n2.input = new Uint8Array(e2) : n2.input = e2, n2.next_in = 0, n2.avail_in = n2.input.length; ; ) if (0 === n2.avail_out && (n2.output = new Uint8Array(i2), n2.next_out = 0, n2.avail_out = i2), (s2 === ti || s2 === ni) && n2.avail_out <= 6) this.onData(n2.output.subarray(0, n2.next_out)), n2.avail_out = 0;
  else {
    if (r2 = Bn.deflate(n2, s2), r2 === si) return n2.next_out > 0 && this.onData(n2.output.subarray(0, n2.next_out)), r2 = Bn.deflateEnd(this.strm), this.onEnd(r2), this.ended = true, r2 === ri;
    if (0 !== n2.avail_out) {
      if (s2 > 0 && n2.next_out > 0) this.onData(n2.output.subarray(0, n2.next_out)), n2.avail_out = 0;
      else if (0 === n2.avail_in) break;
    } else this.onData(n2.output);
  }
  return true;
}, ui.prototype.onData = function(e2) {
  this.chunks.push(e2);
}, ui.prototype.onEnd = function(e2) {
  e2 === ri && (this.result = Wn.flattenChunks(this.chunks)), this.chunks = [], this.err = e2, this.msg = this.strm.msg;
};
var hi = { Deflate: ui, deflate: li, deflateRaw: function(e2, t2) {
  return (t2 = t2 || {}).raw = true, li(e2, t2);
}, gzip: function(e2, t2) {
  return (t2 = t2 || {}).gzip = true, li(e2, t2);
}, constants: Wt };
var di = 16209;
var _i = function(e2, t2) {
  let n2, i2, r2, s2, o2, a2, c2, u2, l2, h2, d2, _2, f2, p2, E2, g2, v2, b2, m2, y2, w2, S2, T2, N2;
  const C2 = e2.state;
  n2 = e2.next_in, T2 = e2.input, i2 = n2 + (e2.avail_in - 5), r2 = e2.next_out, N2 = e2.output, s2 = r2 - (t2 - e2.avail_out), o2 = r2 + (e2.avail_out - 257), a2 = C2.dmax, c2 = C2.wsize, u2 = C2.whave, l2 = C2.wnext, h2 = C2.window, d2 = C2.hold, _2 = C2.bits, f2 = C2.lencode, p2 = C2.distcode, E2 = (1 << C2.lenbits) - 1, g2 = (1 << C2.distbits) - 1;
  e: do {
    _2 < 15 && (d2 += T2[n2++] << _2, _2 += 8, d2 += T2[n2++] << _2, _2 += 8), v2 = f2[d2 & E2];
    t: for (; ; ) {
      if (b2 = v2 >>> 24, d2 >>>= b2, _2 -= b2, b2 = v2 >>> 16 & 255, 0 === b2) N2[r2++] = 65535 & v2;
      else {
        if (!(16 & b2)) {
          if (64 & b2) {
            if (32 & b2) {
              C2.mode = 16191;
              break e;
            }
            e2.msg = "invalid literal/length code", C2.mode = di;
            break e;
          }
          v2 = f2[(65535 & v2) + (d2 & (1 << b2) - 1)];
          continue t;
        }
        for (m2 = 65535 & v2, b2 &= 15, b2 && (_2 < b2 && (d2 += T2[n2++] << _2, _2 += 8), m2 += d2 & (1 << b2) - 1, d2 >>>= b2, _2 -= b2), _2 < 15 && (d2 += T2[n2++] << _2, _2 += 8, d2 += T2[n2++] << _2, _2 += 8), v2 = p2[d2 & g2]; ; ) {
          if (b2 = v2 >>> 24, d2 >>>= b2, _2 -= b2, b2 = v2 >>> 16 & 255, 16 & b2) {
            if (y2 = 65535 & v2, b2 &= 15, _2 < b2 && (d2 += T2[n2++] << _2, _2 += 8, _2 < b2 && (d2 += T2[n2++] << _2, _2 += 8)), y2 += d2 & (1 << b2) - 1, y2 > a2) {
              e2.msg = "invalid distance too far back", C2.mode = di;
              break e;
            }
            if (d2 >>>= b2, _2 -= b2, b2 = r2 - s2, y2 > b2) {
              if (b2 = y2 - b2, b2 > u2 && C2.sane) {
                e2.msg = "invalid distance too far back", C2.mode = di;
                break e;
              }
              if (w2 = 0, S2 = h2, 0 === l2) {
                if (w2 += c2 - b2, b2 < m2) {
                  m2 -= b2;
                  do {
                    N2[r2++] = h2[w2++];
                  } while (--b2);
                  w2 = r2 - y2, S2 = N2;
                }
              } else if (l2 < b2) {
                if (w2 += c2 + l2 - b2, b2 -= l2, b2 < m2) {
                  m2 -= b2;
                  do {
                    N2[r2++] = h2[w2++];
                  } while (--b2);
                  if (w2 = 0, l2 < m2) {
                    b2 = l2, m2 -= b2;
                    do {
                      N2[r2++] = h2[w2++];
                    } while (--b2);
                    w2 = r2 - y2, S2 = N2;
                  }
                }
              } else if (w2 += l2 - b2, b2 < m2) {
                m2 -= b2;
                do {
                  N2[r2++] = h2[w2++];
                } while (--b2);
                w2 = r2 - y2, S2 = N2;
              }
              for (; m2 > 2; ) N2[r2++] = S2[w2++], N2[r2++] = S2[w2++], N2[r2++] = S2[w2++], m2 -= 3;
              m2 && (N2[r2++] = S2[w2++], m2 > 1 && (N2[r2++] = S2[w2++]));
            } else {
              w2 = r2 - y2;
              do {
                N2[r2++] = N2[w2++], N2[r2++] = N2[w2++], N2[r2++] = N2[w2++], m2 -= 3;
              } while (m2 > 2);
              m2 && (N2[r2++] = N2[w2++], m2 > 1 && (N2[r2++] = N2[w2++]));
            }
            break;
          }
          if (64 & b2) {
            e2.msg = "invalid distance code", C2.mode = di;
            break e;
          }
          v2 = p2[(65535 & v2) + (d2 & (1 << b2) - 1)];
        }
      }
      break;
    }
  } while (n2 < i2 && r2 < o2);
  m2 = _2 >> 3, n2 -= m2, _2 -= m2 << 3, d2 &= (1 << _2) - 1, e2.next_in = n2, e2.next_out = r2, e2.avail_in = n2 < i2 ? i2 - n2 + 5 : 5 - (n2 - i2), e2.avail_out = r2 < o2 ? o2 - r2 + 257 : 257 - (r2 - o2), C2.hold = d2, C2.bits = _2;
};
var fi = 15;
var pi = new Uint16Array([3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0]);
var Ei = new Uint8Array([16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78]);
var gi = new Uint16Array([1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0]);
var vi = new Uint8Array([16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64]);
var bi = (e2, t2, n2, i2, r2, s2, o2, a2) => {
  const c2 = a2.bits;
  let u2, l2, h2, d2, _2, f2, p2 = 0, E2 = 0, g2 = 0, v2 = 0, b2 = 0, m2 = 0, y2 = 0, w2 = 0, S2 = 0, T2 = 0, N2 = null;
  const C2 = new Uint16Array(16), A2 = new Uint16Array(16);
  let I2, k2, O2, D2 = null;
  for (p2 = 0; p2 <= fi; p2++) C2[p2] = 0;
  for (E2 = 0; E2 < i2; E2++) C2[t2[n2 + E2]]++;
  for (b2 = c2, v2 = fi; v2 >= 1 && 0 === C2[v2]; v2--) ;
  if (b2 > v2 && (b2 = v2), 0 === v2) return r2[s2++] = 20971520, r2[s2++] = 20971520, a2.bits = 1, 0;
  for (g2 = 1; g2 < v2 && 0 === C2[g2]; g2++) ;
  for (b2 < g2 && (b2 = g2), w2 = 1, p2 = 1; p2 <= fi; p2++) if (w2 <<= 1, w2 -= C2[p2], w2 < 0) return -1;
  if (w2 > 0 && (0 === e2 || 1 !== v2)) return -1;
  for (A2[1] = 0, p2 = 1; p2 < fi; p2++) A2[p2 + 1] = A2[p2] + C2[p2];
  for (E2 = 0; E2 < i2; E2++) 0 !== t2[n2 + E2] && (o2[A2[t2[n2 + E2]]++] = E2);
  if (0 === e2 ? (N2 = D2 = o2, f2 = 20) : 1 === e2 ? (N2 = pi, D2 = Ei, f2 = 257) : (N2 = gi, D2 = vi, f2 = 0), T2 = 0, E2 = 0, p2 = g2, _2 = s2, m2 = b2, y2 = 0, h2 = -1, S2 = 1 << b2, d2 = S2 - 1, 1 === e2 && S2 > 852 || 2 === e2 && S2 > 592) return 1;
  for (; ; ) {
    I2 = p2 - y2, o2[E2] + 1 < f2 ? (k2 = 0, O2 = o2[E2]) : o2[E2] >= f2 ? (k2 = D2[o2[E2] - f2], O2 = N2[o2[E2] - f2]) : (k2 = 96, O2 = 0), u2 = 1 << p2 - y2, l2 = 1 << m2, g2 = l2;
    do {
      l2 -= u2, r2[_2 + (T2 >> y2) + l2] = I2 << 24 | k2 << 16 | O2;
    } while (0 !== l2);
    for (u2 = 1 << p2 - 1; T2 & u2; ) u2 >>= 1;
    if (0 !== u2 ? (T2 &= u2 - 1, T2 += u2) : T2 = 0, E2++, 0 == --C2[p2]) {
      if (p2 === v2) break;
      p2 = t2[n2 + o2[E2]];
    }
    if (p2 > b2 && (T2 & d2) !== h2) {
      for (0 === y2 && (y2 = b2), _2 += g2, m2 = p2 - y2, w2 = 1 << m2; m2 + y2 < v2 && (w2 -= C2[m2 + y2], !(w2 <= 0)); ) m2++, w2 <<= 1;
      if (S2 += 1 << m2, 1 === e2 && S2 > 852 || 2 === e2 && S2 > 592) return 1;
      h2 = T2 & d2, r2[h2] = b2 << 24 | m2 << 16 | _2 - s2;
    }
  }
  return 0 !== T2 && (r2[_2 + T2] = p2 - y2 << 24 | 64 << 16), a2.bits = b2, 0;
};
var { Z_FINISH: mi, Z_BLOCK: yi, Z_TREES: wi, Z_OK: Si, Z_STREAM_END: Ti, Z_NEED_DICT: Ni, Z_STREAM_ERROR: Ci, Z_DATA_ERROR: Ai, Z_MEM_ERROR: Ii, Z_BUF_ERROR: ki, Z_DEFLATED: Oi } = Wt;
var Di = 16180;
var Ri = 16190;
var Li = 16191;
var xi = 16192;
var Ui = 16194;
var Pi = 16199;
var Mi = 16200;
var Fi = 16206;
var qi = 16209;
var Vi = (e2) => (e2 >>> 24 & 255) + (e2 >>> 8 & 65280) + ((65280 & e2) << 8) + ((255 & e2) << 24);
function Hi() {
  this.strm = null, this.mode = 0, this.last = false, this.wrap = 0, this.havedict = false, this.flags = 0, this.dmax = 0, this.check = 0, this.total = 0, this.head = null, this.wbits = 0, this.wsize = 0, this.whave = 0, this.wnext = 0, this.window = null, this.hold = 0, this.bits = 0, this.length = 0, this.offset = 0, this.extra = 0, this.lencode = null, this.distcode = null, this.lenbits = 0, this.distbits = 0, this.ncode = 0, this.nlen = 0, this.ndist = 0, this.have = 0, this.next = null, this.lens = new Uint16Array(320), this.work = new Uint16Array(288), this.lendyn = null, this.distdyn = null, this.sane = 0, this.back = 0, this.was = 0;
}
var zi = (e2) => {
  if (!e2) return 1;
  const t2 = e2.state;
  return !t2 || t2.strm !== e2 || t2.mode < Di || t2.mode > 16211 ? 1 : 0;
};
var Gi = (e2) => {
  if (zi(e2)) return Ci;
  const t2 = e2.state;
  return e2.total_in = e2.total_out = t2.total = 0, e2.msg = "", t2.wrap && (e2.adler = 1 & t2.wrap), t2.mode = Di, t2.last = 0, t2.havedict = 0, t2.flags = -1, t2.dmax = 32768, t2.head = null, t2.hold = 0, t2.bits = 0, t2.lencode = t2.lendyn = new Int32Array(852), t2.distcode = t2.distdyn = new Int32Array(592), t2.sane = 1, t2.back = -1, Si;
};
var ji = (e2) => {
  if (zi(e2)) return Ci;
  const t2 = e2.state;
  return t2.wsize = 0, t2.whave = 0, t2.wnext = 0, Gi(e2);
};
var Ki = (e2, t2) => {
  let n2;
  if (zi(e2)) return Ci;
  const i2 = e2.state;
  return t2 < 0 ? (n2 = 0, t2 = -t2) : (n2 = 5 + (t2 >> 4), t2 < 48 && (t2 &= 15)), t2 && (t2 < 8 || t2 > 15) ? Ci : (null !== i2.window && i2.wbits !== t2 && (i2.window = null), i2.wrap = n2, i2.wbits = t2, ji(e2));
};
var Bi = (e2, t2) => {
  if (!e2) return Ci;
  const n2 = new Hi();
  e2.state = n2, n2.strm = e2, n2.window = null, n2.mode = Di;
  const i2 = Ki(e2, t2);
  return i2 !== Si && (e2.state = null), i2;
};
var Qi;
var Wi;
var Zi = true;
var Yi = (e2) => {
  if (Zi) {
    Qi = new Int32Array(512), Wi = new Int32Array(32);
    let t2 = 0;
    for (; t2 < 144; ) e2.lens[t2++] = 8;
    for (; t2 < 256; ) e2.lens[t2++] = 9;
    for (; t2 < 280; ) e2.lens[t2++] = 7;
    for (; t2 < 288; ) e2.lens[t2++] = 8;
    for (bi(1, e2.lens, 0, 288, Qi, 0, e2.work, { bits: 9 }), t2 = 0; t2 < 32; ) e2.lens[t2++] = 5;
    bi(2, e2.lens, 0, 32, Wi, 0, e2.work, { bits: 5 }), Zi = false;
  }
  e2.lencode = Qi, e2.lenbits = 9, e2.distcode = Wi, e2.distbits = 5;
};
var Xi = (e2, t2, n2, i2) => {
  let r2;
  const s2 = e2.state;
  return null === s2.window && (s2.wsize = 1 << s2.wbits, s2.wnext = 0, s2.whave = 0, s2.window = new Uint8Array(s2.wsize)), i2 >= s2.wsize ? (s2.window.set(t2.subarray(n2 - s2.wsize, n2), 0), s2.wnext = 0, s2.whave = s2.wsize) : (r2 = s2.wsize - s2.wnext, r2 > i2 && (r2 = i2), s2.window.set(t2.subarray(n2 - i2, n2 - i2 + r2), s2.wnext), (i2 -= r2) ? (s2.window.set(t2.subarray(n2 - i2, n2), 0), s2.wnext = i2, s2.whave = s2.wsize) : (s2.wnext += r2, s2.wnext === s2.wsize && (s2.wnext = 0), s2.whave < s2.wsize && (s2.whave += r2))), 0;
};
var Ji = { inflateReset: ji, inflateReset2: Ki, inflateResetKeep: Gi, inflateInit: (e2) => Bi(e2, 15), inflateInit2: Bi, inflate: (e2, t2) => {
  let n2, i2, r2, s2, o2, a2, c2, u2, l2, h2, d2, _2, f2, p2, E2, g2, v2, b2, m2, y2, w2, S2, T2 = 0;
  const N2 = new Uint8Array(4);
  let C2, A2;
  const I2 = new Uint8Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);
  if (zi(e2) || !e2.output || !e2.input && 0 !== e2.avail_in) return Ci;
  n2 = e2.state, n2.mode === Li && (n2.mode = xi), o2 = e2.next_out, r2 = e2.output, c2 = e2.avail_out, s2 = e2.next_in, i2 = e2.input, a2 = e2.avail_in, u2 = n2.hold, l2 = n2.bits, h2 = a2, d2 = c2, S2 = Si;
  e: for (; ; ) switch (n2.mode) {
    case Di:
      if (0 === n2.wrap) {
        n2.mode = xi;
        break;
      }
      for (; l2 < 16; ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      if (2 & n2.wrap && 35615 === u2) {
        0 === n2.wbits && (n2.wbits = 15), n2.check = 0, N2[0] = 255 & u2, N2[1] = u2 >>> 8 & 255, n2.check = Bt(n2.check, N2, 2, 0), u2 = 0, l2 = 0, n2.mode = 16181;
        break;
      }
      if (n2.head && (n2.head.done = false), !(1 & n2.wrap) || (((255 & u2) << 8) + (u2 >> 8)) % 31) {
        e2.msg = "incorrect header check", n2.mode = qi;
        break;
      }
      if ((15 & u2) !== Oi) {
        e2.msg = "unknown compression method", n2.mode = qi;
        break;
      }
      if (u2 >>>= 4, l2 -= 4, w2 = 8 + (15 & u2), 0 === n2.wbits && (n2.wbits = w2), w2 > 15 || w2 > n2.wbits) {
        e2.msg = "invalid window size", n2.mode = qi;
        break;
      }
      n2.dmax = 1 << n2.wbits, n2.flags = 0, e2.adler = n2.check = 1, n2.mode = 512 & u2 ? 16189 : Li, u2 = 0, l2 = 0;
      break;
    case 16181:
      for (; l2 < 16; ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      if (n2.flags = u2, (255 & n2.flags) !== Oi) {
        e2.msg = "unknown compression method", n2.mode = qi;
        break;
      }
      if (57344 & n2.flags) {
        e2.msg = "unknown header flags set", n2.mode = qi;
        break;
      }
      n2.head && (n2.head.text = u2 >> 8 & 1), 512 & n2.flags && 4 & n2.wrap && (N2[0] = 255 & u2, N2[1] = u2 >>> 8 & 255, n2.check = Bt(n2.check, N2, 2, 0)), u2 = 0, l2 = 0, n2.mode = 16182;
    case 16182:
      for (; l2 < 32; ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      n2.head && (n2.head.time = u2), 512 & n2.flags && 4 & n2.wrap && (N2[0] = 255 & u2, N2[1] = u2 >>> 8 & 255, N2[2] = u2 >>> 16 & 255, N2[3] = u2 >>> 24 & 255, n2.check = Bt(n2.check, N2, 4, 0)), u2 = 0, l2 = 0, n2.mode = 16183;
    case 16183:
      for (; l2 < 16; ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      n2.head && (n2.head.xflags = 255 & u2, n2.head.os = u2 >> 8), 512 & n2.flags && 4 & n2.wrap && (N2[0] = 255 & u2, N2[1] = u2 >>> 8 & 255, n2.check = Bt(n2.check, N2, 2, 0)), u2 = 0, l2 = 0, n2.mode = 16184;
    case 16184:
      if (1024 & n2.flags) {
        for (; l2 < 16; ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        n2.length = u2, n2.head && (n2.head.extra_len = u2), 512 & n2.flags && 4 & n2.wrap && (N2[0] = 255 & u2, N2[1] = u2 >>> 8 & 255, n2.check = Bt(n2.check, N2, 2, 0)), u2 = 0, l2 = 0;
      } else n2.head && (n2.head.extra = null);
      n2.mode = 16185;
    case 16185:
      if (1024 & n2.flags && (_2 = n2.length, _2 > a2 && (_2 = a2), _2 && (n2.head && (w2 = n2.head.extra_len - n2.length, n2.head.extra || (n2.head.extra = new Uint8Array(n2.head.extra_len)), n2.head.extra.set(i2.subarray(s2, s2 + _2), w2)), 512 & n2.flags && 4 & n2.wrap && (n2.check = Bt(n2.check, i2, _2, s2)), a2 -= _2, s2 += _2, n2.length -= _2), n2.length)) break e;
      n2.length = 0, n2.mode = 16186;
    case 16186:
      if (2048 & n2.flags) {
        if (0 === a2) break e;
        _2 = 0;
        do {
          w2 = i2[s2 + _2++], n2.head && w2 && n2.length < 65536 && (n2.head.name += String.fromCharCode(w2));
        } while (w2 && _2 < a2);
        if (512 & n2.flags && 4 & n2.wrap && (n2.check = Bt(n2.check, i2, _2, s2)), a2 -= _2, s2 += _2, w2) break e;
      } else n2.head && (n2.head.name = null);
      n2.length = 0, n2.mode = 16187;
    case 16187:
      if (4096 & n2.flags) {
        if (0 === a2) break e;
        _2 = 0;
        do {
          w2 = i2[s2 + _2++], n2.head && w2 && n2.length < 65536 && (n2.head.comment += String.fromCharCode(w2));
        } while (w2 && _2 < a2);
        if (512 & n2.flags && 4 & n2.wrap && (n2.check = Bt(n2.check, i2, _2, s2)), a2 -= _2, s2 += _2, w2) break e;
      } else n2.head && (n2.head.comment = null);
      n2.mode = 16188;
    case 16188:
      if (512 & n2.flags) {
        for (; l2 < 16; ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        if (4 & n2.wrap && u2 !== (65535 & n2.check)) {
          e2.msg = "header crc mismatch", n2.mode = qi;
          break;
        }
        u2 = 0, l2 = 0;
      }
      n2.head && (n2.head.hcrc = n2.flags >> 9 & 1, n2.head.done = true), e2.adler = n2.check = 0, n2.mode = Li;
      break;
    case 16189:
      for (; l2 < 32; ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      e2.adler = n2.check = Vi(u2), u2 = 0, l2 = 0, n2.mode = Ri;
    case Ri:
      if (0 === n2.havedict) return e2.next_out = o2, e2.avail_out = c2, e2.next_in = s2, e2.avail_in = a2, n2.hold = u2, n2.bits = l2, Ni;
      e2.adler = n2.check = 1, n2.mode = Li;
    case Li:
      if (t2 === yi || t2 === wi) break e;
    case xi:
      if (n2.last) {
        u2 >>>= 7 & l2, l2 -= 7 & l2, n2.mode = Fi;
        break;
      }
      for (; l2 < 3; ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      switch (n2.last = 1 & u2, u2 >>>= 1, l2 -= 1, 3 & u2) {
        case 0:
          n2.mode = 16193;
          break;
        case 1:
          if (Yi(n2), n2.mode = Pi, t2 === wi) {
            u2 >>>= 2, l2 -= 2;
            break e;
          }
          break;
        case 2:
          n2.mode = 16196;
          break;
        case 3:
          e2.msg = "invalid block type", n2.mode = qi;
      }
      u2 >>>= 2, l2 -= 2;
      break;
    case 16193:
      for (u2 >>>= 7 & l2, l2 -= 7 & l2; l2 < 32; ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      if ((65535 & u2) != (u2 >>> 16 ^ 65535)) {
        e2.msg = "invalid stored block lengths", n2.mode = qi;
        break;
      }
      if (n2.length = 65535 & u2, u2 = 0, l2 = 0, n2.mode = Ui, t2 === wi) break e;
    case Ui:
      n2.mode = 16195;
    case 16195:
      if (_2 = n2.length, _2) {
        if (_2 > a2 && (_2 = a2), _2 > c2 && (_2 = c2), 0 === _2) break e;
        r2.set(i2.subarray(s2, s2 + _2), o2), a2 -= _2, s2 += _2, c2 -= _2, o2 += _2, n2.length -= _2;
        break;
      }
      n2.mode = Li;
      break;
    case 16196:
      for (; l2 < 14; ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      if (n2.nlen = 257 + (31 & u2), u2 >>>= 5, l2 -= 5, n2.ndist = 1 + (31 & u2), u2 >>>= 5, l2 -= 5, n2.ncode = 4 + (15 & u2), u2 >>>= 4, l2 -= 4, n2.nlen > 286 || n2.ndist > 30) {
        e2.msg = "too many length or distance symbols", n2.mode = qi;
        break;
      }
      n2.have = 0, n2.mode = 16197;
    case 16197:
      for (; n2.have < n2.ncode; ) {
        for (; l2 < 3; ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        n2.lens[I2[n2.have++]] = 7 & u2, u2 >>>= 3, l2 -= 3;
      }
      for (; n2.have < 19; ) n2.lens[I2[n2.have++]] = 0;
      if (n2.lencode = n2.lendyn, n2.lenbits = 7, C2 = { bits: n2.lenbits }, S2 = bi(0, n2.lens, 0, 19, n2.lencode, 0, n2.work, C2), n2.lenbits = C2.bits, S2) {
        e2.msg = "invalid code lengths set", n2.mode = qi;
        break;
      }
      n2.have = 0, n2.mode = 16198;
    case 16198:
      for (; n2.have < n2.nlen + n2.ndist; ) {
        for (; T2 = n2.lencode[u2 & (1 << n2.lenbits) - 1], E2 = T2 >>> 24, g2 = T2 >>> 16 & 255, v2 = 65535 & T2, !(E2 <= l2); ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        if (v2 < 16) u2 >>>= E2, l2 -= E2, n2.lens[n2.have++] = v2;
        else {
          if (16 === v2) {
            for (A2 = E2 + 2; l2 < A2; ) {
              if (0 === a2) break e;
              a2--, u2 += i2[s2++] << l2, l2 += 8;
            }
            if (u2 >>>= E2, l2 -= E2, 0 === n2.have) {
              e2.msg = "invalid bit length repeat", n2.mode = qi;
              break;
            }
            w2 = n2.lens[n2.have - 1], _2 = 3 + (3 & u2), u2 >>>= 2, l2 -= 2;
          } else if (17 === v2) {
            for (A2 = E2 + 3; l2 < A2; ) {
              if (0 === a2) break e;
              a2--, u2 += i2[s2++] << l2, l2 += 8;
            }
            u2 >>>= E2, l2 -= E2, w2 = 0, _2 = 3 + (7 & u2), u2 >>>= 3, l2 -= 3;
          } else {
            for (A2 = E2 + 7; l2 < A2; ) {
              if (0 === a2) break e;
              a2--, u2 += i2[s2++] << l2, l2 += 8;
            }
            u2 >>>= E2, l2 -= E2, w2 = 0, _2 = 11 + (127 & u2), u2 >>>= 7, l2 -= 7;
          }
          if (n2.have + _2 > n2.nlen + n2.ndist) {
            e2.msg = "invalid bit length repeat", n2.mode = qi;
            break;
          }
          for (; _2--; ) n2.lens[n2.have++] = w2;
        }
      }
      if (n2.mode === qi) break;
      if (0 === n2.lens[256]) {
        e2.msg = "invalid code -- missing end-of-block", n2.mode = qi;
        break;
      }
      if (n2.lenbits = 9, C2 = { bits: n2.lenbits }, S2 = bi(1, n2.lens, 0, n2.nlen, n2.lencode, 0, n2.work, C2), n2.lenbits = C2.bits, S2) {
        e2.msg = "invalid literal/lengths set", n2.mode = qi;
        break;
      }
      if (n2.distbits = 6, n2.distcode = n2.distdyn, C2 = { bits: n2.distbits }, S2 = bi(2, n2.lens, n2.nlen, n2.ndist, n2.distcode, 0, n2.work, C2), n2.distbits = C2.bits, S2) {
        e2.msg = "invalid distances set", n2.mode = qi;
        break;
      }
      if (n2.mode = Pi, t2 === wi) break e;
    case Pi:
      n2.mode = Mi;
    case Mi:
      if (a2 >= 6 && c2 >= 258) {
        e2.next_out = o2, e2.avail_out = c2, e2.next_in = s2, e2.avail_in = a2, n2.hold = u2, n2.bits = l2, _i(e2, d2), o2 = e2.next_out, r2 = e2.output, c2 = e2.avail_out, s2 = e2.next_in, i2 = e2.input, a2 = e2.avail_in, u2 = n2.hold, l2 = n2.bits, n2.mode === Li && (n2.back = -1);
        break;
      }
      for (n2.back = 0; T2 = n2.lencode[u2 & (1 << n2.lenbits) - 1], E2 = T2 >>> 24, g2 = T2 >>> 16 & 255, v2 = 65535 & T2, !(E2 <= l2); ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      if (g2 && !(240 & g2)) {
        for (b2 = E2, m2 = g2, y2 = v2; T2 = n2.lencode[y2 + ((u2 & (1 << b2 + m2) - 1) >> b2)], E2 = T2 >>> 24, g2 = T2 >>> 16 & 255, v2 = 65535 & T2, !(b2 + E2 <= l2); ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        u2 >>>= b2, l2 -= b2, n2.back += b2;
      }
      if (u2 >>>= E2, l2 -= E2, n2.back += E2, n2.length = v2, 0 === g2) {
        n2.mode = 16205;
        break;
      }
      if (32 & g2) {
        n2.back = -1, n2.mode = Li;
        break;
      }
      if (64 & g2) {
        e2.msg = "invalid literal/length code", n2.mode = qi;
        break;
      }
      n2.extra = 15 & g2, n2.mode = 16201;
    case 16201:
      if (n2.extra) {
        for (A2 = n2.extra; l2 < A2; ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        n2.length += u2 & (1 << n2.extra) - 1, u2 >>>= n2.extra, l2 -= n2.extra, n2.back += n2.extra;
      }
      n2.was = n2.length, n2.mode = 16202;
    case 16202:
      for (; T2 = n2.distcode[u2 & (1 << n2.distbits) - 1], E2 = T2 >>> 24, g2 = T2 >>> 16 & 255, v2 = 65535 & T2, !(E2 <= l2); ) {
        if (0 === a2) break e;
        a2--, u2 += i2[s2++] << l2, l2 += 8;
      }
      if (!(240 & g2)) {
        for (b2 = E2, m2 = g2, y2 = v2; T2 = n2.distcode[y2 + ((u2 & (1 << b2 + m2) - 1) >> b2)], E2 = T2 >>> 24, g2 = T2 >>> 16 & 255, v2 = 65535 & T2, !(b2 + E2 <= l2); ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        u2 >>>= b2, l2 -= b2, n2.back += b2;
      }
      if (u2 >>>= E2, l2 -= E2, n2.back += E2, 64 & g2) {
        e2.msg = "invalid distance code", n2.mode = qi;
        break;
      }
      n2.offset = v2, n2.extra = 15 & g2, n2.mode = 16203;
    case 16203:
      if (n2.extra) {
        for (A2 = n2.extra; l2 < A2; ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        n2.offset += u2 & (1 << n2.extra) - 1, u2 >>>= n2.extra, l2 -= n2.extra, n2.back += n2.extra;
      }
      if (n2.offset > n2.dmax) {
        e2.msg = "invalid distance too far back", n2.mode = qi;
        break;
      }
      n2.mode = 16204;
    case 16204:
      if (0 === c2) break e;
      if (_2 = d2 - c2, n2.offset > _2) {
        if (_2 = n2.offset - _2, _2 > n2.whave && n2.sane) {
          e2.msg = "invalid distance too far back", n2.mode = qi;
          break;
        }
        _2 > n2.wnext ? (_2 -= n2.wnext, f2 = n2.wsize - _2) : f2 = n2.wnext - _2, _2 > n2.length && (_2 = n2.length), p2 = n2.window;
      } else p2 = r2, f2 = o2 - n2.offset, _2 = n2.length;
      _2 > c2 && (_2 = c2), c2 -= _2, n2.length -= _2;
      do {
        r2[o2++] = p2[f2++];
      } while (--_2);
      0 === n2.length && (n2.mode = Mi);
      break;
    case 16205:
      if (0 === c2) break e;
      r2[o2++] = n2.length, c2--, n2.mode = Mi;
      break;
    case Fi:
      if (n2.wrap) {
        for (; l2 < 32; ) {
          if (0 === a2) break e;
          a2--, u2 |= i2[s2++] << l2, l2 += 8;
        }
        if (d2 -= c2, e2.total_out += d2, n2.total += d2, 4 & n2.wrap && d2 && (e2.adler = n2.check = n2.flags ? Bt(n2.check, r2, d2, o2 - d2) : jt(n2.check, r2, d2, o2 - d2)), d2 = c2, 4 & n2.wrap && (n2.flags ? u2 : Vi(u2)) !== n2.check) {
          e2.msg = "incorrect data check", n2.mode = qi;
          break;
        }
        u2 = 0, l2 = 0;
      }
      n2.mode = 16207;
    case 16207:
      if (n2.wrap && n2.flags) {
        for (; l2 < 32; ) {
          if (0 === a2) break e;
          a2--, u2 += i2[s2++] << l2, l2 += 8;
        }
        if (4 & n2.wrap && u2 !== (4294967295 & n2.total)) {
          e2.msg = "incorrect length check", n2.mode = qi;
          break;
        }
        u2 = 0, l2 = 0;
      }
      n2.mode = 16208;
    case 16208:
      S2 = Ti;
      break e;
    case qi:
      S2 = Ai;
      break e;
    case 16210:
      return Ii;
    default:
      return Ci;
  }
  return e2.next_out = o2, e2.avail_out = c2, e2.next_in = s2, e2.avail_in = a2, n2.hold = u2, n2.bits = l2, (n2.wsize || d2 !== e2.avail_out && n2.mode < qi && (n2.mode < Fi || t2 !== mi)) && Xi(e2, e2.output, e2.next_out, d2 - e2.avail_out), h2 -= e2.avail_in, d2 -= e2.avail_out, e2.total_in += h2, e2.total_out += d2, n2.total += d2, 4 & n2.wrap && d2 && (e2.adler = n2.check = n2.flags ? Bt(n2.check, r2, d2, e2.next_out - d2) : jt(n2.check, r2, d2, e2.next_out - d2)), e2.data_type = n2.bits + (n2.last ? 64 : 0) + (n2.mode === Li ? 128 : 0) + (n2.mode === Pi || n2.mode === Ui ? 256 : 0), (0 === h2 && 0 === d2 || t2 === mi) && S2 === Si && (S2 = ki), S2;
}, inflateEnd: (e2) => {
  if (zi(e2)) return Ci;
  let t2 = e2.state;
  return t2.window && (t2.window = null), e2.state = null, Si;
}, inflateGetHeader: (e2, t2) => {
  if (zi(e2)) return Ci;
  const n2 = e2.state;
  return 2 & n2.wrap ? (n2.head = t2, t2.done = false, Si) : Ci;
}, inflateSetDictionary: (e2, t2) => {
  const n2 = t2.length;
  let i2, r2, s2;
  return zi(e2) ? Ci : (i2 = e2.state, 0 !== i2.wrap && i2.mode !== Ri ? Ci : i2.mode === Ri && (r2 = 1, r2 = jt(r2, t2, n2, 0), r2 !== i2.check) ? Ai : (s2 = Xi(e2, t2, n2, n2), s2 ? (i2.mode = 16210, Ii) : (i2.havedict = 1, Si)));
}, inflateInfo: "pako inflate (from Nodeca project)" };
var $i = function() {
  this.text = 0, this.time = 0, this.xflags = 0, this.os = 0, this.extra = null, this.extra_len = 0, this.name = "", this.comment = "", this.hcrc = 0, this.done = false;
};
var er = Object.prototype.toString;
var { Z_NO_FLUSH: tr, Z_FINISH: nr, Z_OK: ir, Z_STREAM_END: rr, Z_NEED_DICT: sr, Z_STREAM_ERROR: or, Z_DATA_ERROR: ar, Z_MEM_ERROR: cr } = Wt;
function ur(e2) {
  this.options = Wn.assign({ chunkSize: 65536, windowBits: 15, to: "" }, e2 || {});
  const t2 = this.options;
  t2.raw && t2.windowBits >= 0 && t2.windowBits < 16 && (t2.windowBits = -t2.windowBits, 0 === t2.windowBits && (t2.windowBits = -15)), !(t2.windowBits >= 0 && t2.windowBits < 16) || e2 && e2.windowBits || (t2.windowBits += 32), t2.windowBits > 15 && t2.windowBits < 48 && (15 & t2.windowBits || (t2.windowBits |= 15)), this.err = 0, this.msg = "", this.ended = false, this.chunks = [], this.strm = new Jn(), this.strm.avail_out = 0;
  let n2 = Ji.inflateInit2(this.strm, t2.windowBits);
  if (n2 !== ir) throw new Error(Qt[n2]);
  if (this.header = new $i(), Ji.inflateGetHeader(this.strm, this.header), t2.dictionary && ("string" == typeof t2.dictionary ? t2.dictionary = Xn.string2buf(t2.dictionary) : "[object ArrayBuffer]" === er.call(t2.dictionary) && (t2.dictionary = new Uint8Array(t2.dictionary)), t2.raw && (n2 = Ji.inflateSetDictionary(this.strm, t2.dictionary), n2 !== ir))) throw new Error(Qt[n2]);
}
function lr(e2, t2) {
  const n2 = new ur(t2);
  if (n2.push(e2), n2.err) throw n2.msg || Qt[n2.err];
  return n2.result;
}
ur.prototype.push = function(e2, t2) {
  const n2 = this.strm, i2 = this.options.chunkSize, r2 = this.options.dictionary;
  let s2, o2, a2;
  if (this.ended) return false;
  for (o2 = t2 === ~~t2 ? t2 : true === t2 ? nr : tr, "[object ArrayBuffer]" === er.call(e2) ? n2.input = new Uint8Array(e2) : n2.input = e2, n2.next_in = 0, n2.avail_in = n2.input.length; ; ) {
    for (0 === n2.avail_out && (n2.output = new Uint8Array(i2), n2.next_out = 0, n2.avail_out = i2), s2 = Ji.inflate(n2, o2), s2 === sr && r2 && (s2 = Ji.inflateSetDictionary(n2, r2), s2 === ir ? s2 = Ji.inflate(n2, o2) : s2 === ar && (s2 = sr)); n2.avail_in > 0 && s2 === rr && n2.state.wrap > 0 && 0 !== e2[n2.next_in]; ) Ji.inflateReset(n2), s2 = Ji.inflate(n2, o2);
    switch (s2) {
      case or:
      case ar:
      case sr:
      case cr:
        return this.onEnd(s2), this.ended = true, false;
    }
    if (a2 = n2.avail_out, n2.next_out && (0 === n2.avail_out || s2 === rr)) if ("string" === this.options.to) {
      let e3 = Xn.utf8border(n2.output, n2.next_out), t3 = n2.next_out - e3, r3 = Xn.buf2string(n2.output, e3);
      n2.next_out = t3, n2.avail_out = i2 - t3, t3 && n2.output.set(n2.output.subarray(e3, e3 + t3), 0), this.onData(r3);
    } else this.onData(n2.output.length === n2.next_out ? n2.output : n2.output.subarray(0, n2.next_out));
    if (s2 !== ir || 0 !== a2) {
      if (s2 === rr) return s2 = Ji.inflateEnd(this.strm), this.onEnd(s2), this.ended = true, true;
      if (0 === n2.avail_in) break;
    }
  }
  return true;
}, ur.prototype.onData = function(e2) {
  this.chunks.push(e2);
}, ur.prototype.onEnd = function(e2) {
  e2 === ir && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = Wn.flattenChunks(this.chunks)), this.chunks = [], this.err = e2, this.msg = this.strm.msg;
};
var hr = { Inflate: ur, inflate: lr, inflateRaw: function(e2, t2) {
  return (t2 = t2 || {}).raw = true, lr(e2, t2);
}, ungzip: lr, constants: Wt };
var { Deflate: dr, deflate: _r, deflateRaw: fr, gzip: pr } = hi;
var { Inflate: Er, inflate: gr, inflateRaw: vr, ungzip: br } = hr;
var mr;
var yr = { Deflate: dr, deflate: _r, deflateRaw: fr, gzip: pr, Inflate: Er, inflate: gr, inflateRaw: vr, ungzip: br, constants: Wt };
var wr = function(e2) {
  return r(void 0, void 0, void 0, function() {
    var t2;
    return s(this, function(n2) {
      return t2 = yr.ungzip(e2), [2, String.fromCharCode.apply(null, t2)];
    });
  });
};
!function(e2) {
  e2.CONNECTING = "CONNECTING", e2.OPEN = "OPEN", e2.CLOSED = "CLOSED";
}(mr || (mr = {}));
var Sr;
var Tr = function(e2) {
  function n2(t2, n3) {
    var i2 = n3.sdkState, r2 = n3.dispatcher, s2 = n3.logger, o2 = e2.call(this) || this;
    return o2.lastActive = 0, o2._iid = t2, o2._sdkState = i2, o2._dispatcher = r2, o2._logger = s2, o2;
  }
  return t(n2, e2), Object.defineProperty(n2.prototype, "isOpen", { get: function() {
    return this.connectionState === mr.OPEN;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "connectionState", { get: function() {
    if (this._ws) switch (this._ws.readyState) {
      case 0:
        return mr.CONNECTING;
      case 1:
        return mr.OPEN;
    }
    return mr.CLOSED;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "ws", { get: function() {
    var e3;
    return null !== (e3 = this._ws) && void 0 !== e3 ? e3 : null;
  }, enumerable: false, configurable: true }), n2.prototype._handleMessage = function(e3) {
    var t2 = this;
    e3.split("\n").forEach(function(e4) {
      if (e4) {
        var n3 = Fe.createFromRawMessage(t2._iid, e4);
        if (t2._logger.debug("receive websocket event", n3), "LOGI" === n3.code) t2.dispatch("message", n3);
        else if ("PONG" === n3.code) t2.dispatch("pong");
        else if ("EXPR" === n3.code) {
          if (n3.payload) {
            var i2 = new Me(n3.payload);
            i2.expiresIn >= 0 && t2._dispatcher.dispatch(i2);
          }
        } else "NOOP" === n3.code || t2.dispatch("message", n3);
      }
    });
  }, n2.prototype.connect = function(e3, t2) {
    return void 0 === t2 && (t2 = ""), r(this, void 0, void 0, function() {
      var n3 = this;
      return s(this, function(i2) {
        return this._ws = new WebSocket(e3, encodeURIComponent(t2)), this._ws.onopen = function() {
          n3._logger.debug("websocket open"), n3.dispatch("open");
        }, this._ws.onmessage = function(e4) {
          return r(n3, void 0, void 0, function() {
            var t3, n4, i3, o2, a2 = this;
            return s(this, function(c2) {
              switch (c2.label) {
                case 0:
                  return (null === (o2 = this._sdkState.websocket) || void 0 === o2 ? void 0 : o2.compression) ? e4.data instanceof Blob ? ((t3 = new FileReader()).readAsArrayBuffer(e4.data), t3.onloadend = function() {
                    return r(a2, void 0, void 0, function() {
                      var e5, n5;
                      return s(this, function(i4) {
                        switch (i4.label) {
                          case 0:
                            return i4.trys.push([0, 2, , 3]), [4, wr(t3.result)];
                          case 1:
                            return e5 = i4.sent(), this._handleMessage(e5), [3, 3];
                          case 2:
                            return n5 = i4.sent(), this.error(n5), [3, 3];
                          case 3:
                            return [2];
                        }
                      });
                    });
                  }, [3, 7]) : [3, 1] : [3, 8];
                case 1:
                  if (!(e4.data instanceof ArrayBuffer)) return [3, 6];
                  c2.label = 2;
                case 2:
                  return c2.trys.push([2, 4, , 5]), [4, wr(new Uint8Array(e4.data))];
                case 3:
                  return n4 = c2.sent(), this._handleMessage(n4), [3, 5];
                case 4:
                  return i3 = c2.sent(), this.error(i3), [3, 5];
                case 5:
                  return [3, 7];
                case 6:
                  "string" == typeof e4.data && this._handleMessage(e4.data), c2.label = 7;
                case 7:
                  return [3, 9];
                case 8:
                  this._handleMessage(e4.data), c2.label = 9;
                case 9:
                  return [2];
              }
            });
          });
        }, this._ws.onerror = function() {
          n3._logger.debug("websocket error"), n3.dispatch("error", v.networkError);
        }, this._ws.onclose = function() {
          n3._logger.debug("websocket close"), n3.dispatch("close");
        }, this.lastActive = Date.now(), [2];
      });
    });
  }, n2.prototype.disconnect = function() {
    var e3 = this;
    return new Promise(function(t2) {
      e3._logger.debug("websocket disconnect"), e3._ws ? (e3._ws.onopen = st, e3._ws.onmessage = st, e3._ws.onerror = st, e3.connectionState !== mr.CLOSED ? (e3._ws.onclose = function() {
        e3.dispatch("close"), t2();
      }, e3._ws.close(), e3._ws = void 0) : t2()) : t2();
    });
  }, n2.prototype.send = function(e3) {
    if (!this._ws) throw v.connectionClosed;
    "PING" !== e3.code ? this.dispatch("ping-refresh") : this._logger.debug("send ping", e3), this._ws.send(e3.convertToMessage());
  }, n2.prototype.error = function(e3) {
    this._logger.debug("websocket error", e3), this.dispatch("error", e3);
  }, n2;
}(te);
var Nr = function(e2) {
  function n2(t2) {
    var n3 = t2.all, i2 = t2.feed, r2 = t2.custom_types, s2 = t2.ts, o2 = e2.call(this) || this;
    return o2.all = n3, o2.feed = i2, o2.customTypes = r2, o2.ts = s2, o2;
  }
  return t(n2, e2), n2;
}(ie);
var Cr = function() {
  function e2(e3, t2) {
    var n2 = t2.session, i2 = t2.sdkState, r2 = t2.dispatcher, s2 = t2.logger, o2 = t2.useFetchCompat, a2 = void 0 !== o2 && o2, c2 = this;
    this._ackStateMap = /* @__PURE__ */ new Map(), this._sdkState = i2, this._dispatcher = r2, this._logger = s2, this.apiClient = new rt(e3, { session: n2, sdkState: i2, dispatcher: r2, logger: s2, useFetchCompat: a2 }), this.websocketClient = new Tr(e3, { sdkState: i2, dispatcher: r2, logger: s2 }), this.websocketClient.on("message", function(e4) {
      if (e4.payload.unread_cnt && c2._dispatcher.dispatch(new Nr(e4.payload.unread_cnt)), e4.requestId) {
        if (c2._ackStateMap.has(e4.requestId)) {
          var t3 = c2._ackStateMap.get(e4.requestId);
          "EROR" !== e4.code ? t3.resolve(e4) : t3.reject(new v({ code: e4.payload.code, message: e4.payload.message }));
        }
      } else c2._dispatcher.dispatch(e4);
    }).on("close", function() {
      c2._ackStateMap.forEach(function(e4) {
        e4.reject(v.connectionClosed);
      }), c2._ackStateMap.clear();
    });
  }
  return e2.prototype._sendApiRequest = function(e3) {
    return r(this, void 0, void 0, function() {
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return [4, this.apiClient.send(e3)];
          case 1:
            return [2, t2.sent()];
        }
      });
    });
  }, e2.prototype._sendWebsocketRequest = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n2, i2, r2 = this;
      return s(this, function(s2) {
        if (!this._sdkState.websocket) throw v.connectionRequired;
        if (t2 = new et(), e3.ackRequired) {
          i2 = function(i3, s3) {
            r2._ackStateMap.has(e3.requestId) && (r2._ackStateMap.delete(e3.requestId), n2 && (clearTimeout(n2), n2 = null), i3 ? (r2._logger.debug("fail websocket request", e3.requestId, i3), t2.reject(i3)) : (r2._logger.debug("receive websocket ack", e3.requestId, e3), r2._logger.debug("receive websocket ack", s3), t2.resolve(s3)));
          };
          try {
            n2 = setTimeout(function() {
              return i2(v.noAckTimeout);
            }, this._sdkState.websocket.responseTimeout), this._ackStateMap.set(e3.requestId, { resolve: function(e4) {
              return i2(void 0, e4);
            }, reject: function(e4) {
              return i2(e4);
            } }), this.websocketClient.send(e3);
          } catch (e4) {
            i2(e4);
          }
        } else try {
          this.websocketClient.send(e3), t2.resolve();
        } catch (e4) {
          t2.reject(e4);
        }
        return [2, t2.promise];
      });
    });
  }, e2.prototype.send = function(e3) {
    return r(this, void 0, void 0, function() {
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return e3 instanceof xe ? [4, this._sendApiRequest(e3)] : [3, 2];
          case 1:
          case 3:
            return [2, t2.sent()];
          case 2:
            return e3 instanceof qe ? [4, this._sendWebsocketRequest(e3)] : [3, 4];
          case 4:
            throw v.invalidParameters;
        }
      });
    });
  }, e2.prototype.cancel = function(e3) {
    this.apiClient.cancel(e3);
  }, e2.prototype.cancelAll = function() {
    this.apiClient.cancelAll();
  }, e2;
}();
!function(e2) {
  e2[e2.NONE = 0] = "NONE", e2[e2.INITIALIZED = 1] = "INITIALIZED", e2[e2.CONNECTING = 2] = "CONNECTING", e2[e2.CONNECTED = 3] = "CONNECTED", e2[e2.RECONNECTING = 4] = "RECONNECTING", e2[e2.INTERNAL_DISCONNECTED = 5] = "INTERNAL_DISCONNECTED", e2[e2.EXTERNAL_DISCONNECTED = 6] = "EXTERNAL_DISCONNECTED", e2[e2.LOGOUT = 7] = "LOGOUT";
}(Sr || (Sr = {}));
var Ar;
var Ir;
var kr = function(e2) {
  function n2(t2) {
    var n3 = t2.stateType, i2 = e2.call(this) || this;
    return i2.stateType = n3, i2;
  }
  return t(n2, e2), n2;
}(ie);
var Or = function(e2) {
  function n2() {
    return null !== e2 && e2.apply(this, arguments) || this;
  }
  return t(n2, e2), n2;
}(ie);
var Dr = function(e2) {
  function n2() {
    return null !== e2 && e2.apply(this, arguments) || this;
  }
  return t(n2, e2), n2;
}(ie);
var Rr = function(e2) {
  function n2() {
    return null !== e2 && e2.apply(this, arguments) || this;
  }
  return t(n2, e2), n2;
}(ie);
var Lr = function() {
  function e2(e3) {
    var t2, n2, i2, r2;
    this.isEnabled = null !== (t2 = e3.enabled) && void 0 !== t2 && t2, this.feedChannels = null !== (n2 = e3.feed_channels) && void 0 !== n2 ? n2 : {}, this.templateListToken = null !== (i2 = e3.template_list_token) && void 0 !== i2 ? i2 : null, this.settingsUpdatedAt = null !== (r2 = e3.settings_updated_at) && void 0 !== r2 ? r2 : 0;
  }
  return e2.payloadify = function(e3) {
    return re(se({ enabled: e3.isEnabled, feed_channels: e3.feedChannels, template_list_token: e3.templateListToken, settings_updated_at: e3.settingsUpdatedAt }));
  }, e2;
}();
var xr = function(e2) {
  return "sendbird@".concat(e2, "/changelog_include_chat_notifications");
};
var Ur = function() {
  function e2(e3) {
    var t2;
    this.lastUpdatedAt = null !== (t2 = e3.last_updated_at) && void 0 !== t2 ? t2 : 0;
  }
  return e2.payloadify = function(e3) {
    return re(se({ last_updated_at: e3.lastUpdatedAt }));
  }, e2;
}();
var Pr = function() {
  function e2(e3) {
    var t2;
    this.token = null !== (t2 = e3.template_list_token) && void 0 !== t2 ? t2 : "";
  }
  return e2.payloadify = function(e3) {
    return re(se({ template_list_token: e3.token }));
  }, e2;
}();
var Mr = function() {
  function e2(e3) {
    void 0 === e3 && (e3 = { min_stat_count: 100, min_interval: 10800, max_stat_count_per_request: 1e3, lower_threshold: 10, request_delay_range: 180 }), this.minStatCount = e3.min_stat_count, this.minInterval = 1e3 * e3.min_interval, this.maxStatCountPerRequest = e3.max_stat_count_per_request, this.lowerThreshold = e3.lower_threshold, this.requestDelayRange = 1e3 * e3.request_delay_range;
  }
  return e2.payloadify = function(e3) {
    return re(se({ min_stat_count: e3.minStatCount, min_interval: e3.minInterval / 1e3, max_stat_count_per_request: e3.maxStatCountPerRequest, lower_threshold: e3.lowerThreshold, request_delay_range: e3.requestDelayRange / 1e3 }));
  }, e2;
}();
var Fr = function() {
  function e2(e3) {
    void 0 === e3 && (e3 = { default: { min_stat_count: 100, min_interval: 10800, max_stat_count_per_request: 1e3, lower_threshold: 10, request_delay_range: 180 } }), this.default = new Mr(e3.default), this.realTime = new Mr(e3.realtime);
  }
  return e2.payloadify = function(e3) {
    return re(se({ default: Mr.payloadify(e3.default), realtime: Mr.payloadify(e3.realTime) }));
  }, e2;
}();
var qr = 1048576;
var Vr = 5;
!function(e2) {
  e2[e2.NONE = 0] = "NONE", e2[e2.INCLUDE_REPLY = 1] = "INCLUDE_REPLY", e2[e2.EXCLUDE_REPLY = 2] = "EXCLUDE_REPLY", e2[e2.INCLUDE_REPLY_TO_CHANNEL = 3] = "INCLUDE_REPLY_TO_CHANNEL";
}(Ar || (Ar = {})), function(e2) {
  e2[e2.NONE = 0] = "NONE", e2[e2.INCLUDE_REPLY = 1] = "INCLUDE_REPLY", e2[e2.EXCLUDE_REPLY = 2] = "EXCLUDE_REPLY", e2[e2.INCLUDE_REPLY_TO_CHANNEL = 3] = "INCLUDE_REPLY_TO_CHANNEL";
}(Ir || (Ir = {}));
var Hr = function() {
  function e2(e3) {
    var t2, n2, i2, r2, s2, o2, a2;
    void 0 === e3 && (e3 = {}), this.emojiHash = e3.emoji_hash || "", this.uploadSizeLimit = e3.file_upload_size_limit ? e3.file_upload_size_limit * qr : Number.MAX_SAFE_INTEGER, this.useReaction = !!e3.use_reaction, this.applicationAttributes = null !== (t2 = e3.application_attributes) && void 0 !== t2 ? t2 : [], this.premiumFeatureList = null !== (n2 = e3.premium_feature_list) && void 0 !== n2 ? n2 : [], this.deviceTokenCache = this.applicationAttributes.includes("sdk_device_token_cache"), this.enabledChannelMemberShipHistory = this.applicationAttributes.includes("channel_membership_history"), this.multipleFilesMessageFileCountLimit = null !== (i2 = e3.multiple_file_send_max_size) && void 0 !== i2 ? i2 : 5, this.allowSdkStatsUpload = null === (r2 = e3.allow_sdk_log_ingestion) || void 0 === r2 || r2, this.unreadCountThreadingPolicy = null !== (s2 = e3.unread_cnt_threading_policy) && void 0 !== s2 ? s2 : Ar.NONE, this.lastMessageThreadingPolicy = null !== (o2 = e3.last_msg_threading_policy) && void 0 !== o2 ? o2 : Ir.NONE, this.uikitConfigInfo = new Ur(null !== (a2 = e3.uikit_config) && void 0 !== a2 ? a2 : {}), this.notificationInfo = e3.notifications ? new Lr(e3.notifications) : null, this.messageTemplateInfo = e3.message_template ? new Pr(e3.message_template) : null, this.statConfigInfo = e3.log_publish_config ? new Fr(e3.log_publish_config) : new Fr();
  }
  return e2.payloadify = function(e3) {
    return re(se({ emoji_hash: e3.emojiHash, file_upload_size_limit: e3.uploadSizeLimit / qr, application_attributes: e3.applicationAttributes, premium_feature_list: e3.premiumFeatureList, use_reaction: e3.useReaction, allow_sdk_log_ingestion: e3.allowSdkStatsUpload, unread_cnt_threading_policy: e3.unreadCountThreadingPolicy, last_msg_threading_policy: e3.lastMessageThreadingPolicy, uikit_config: e3.uikitConfigInfo ? Ur.payloadify(e3.uikitConfigInfo) : null, notifications: e3.notificationInfo ? Lr.payloadify(e3.notificationInfo) : null, message_template: e3.messageTemplateInfo ? Pr.payloadify(e3.messageTemplateInfo) : null, log_publish_config: e3.statConfigInfo ? Fr.payloadify(e3.statConfigInfo) : null }));
  }, e2;
}();
var zr = function() {
  function e2(e3) {
    this._iid = "", this._iid = e3;
  }
  return e2.payloadify = function(e3) {
    return {};
  }, e2;
}();
var Gr = function(e2) {
  function n2(t2) {
    var n3 = t2.userId, i2 = t2.metadata, r2 = e2.call(this) || this;
    return r2.method = oe.POST, r2.path = "".concat(ce, "/").concat(n3, "/metadata"), r2.params = { metadata: i2 }, r2;
  }
  return t(n2, e2), n2;
}(xe);
var jr = function(e2) {
  function n2(t2, n3) {
    var i2 = e2.call(this, t2, n3) || this;
    return i2.metaData = n3, i2;
  }
  return t(n2, e2), n2;
}(Ue);
var Kr = function(e2) {
  function n2(t2) {
    var n3 = t2.userId, i2 = t2.metadata, r2 = t2.upsert, s2 = e2.call(this) || this;
    return s2.method = oe.PUT, s2.path = "".concat(ce, "/").concat(n3, "/metadata"), s2.params = { metadata: i2, upsert: r2 }, s2;
  }
  return t(n2, e2), n2;
}(xe);
var Br = function(e2) {
  function n2(t2, n3) {
    var i2 = e2.call(this, t2, n3) || this;
    return i2.metadata = n3, i2;
  }
  return t(n2, e2), n2;
}(Ue);
var Qr = function(e2) {
  function n2(t2) {
    var n3 = t2.userId, i2 = t2.metadataKey, r2 = e2.call(this) || this;
    return r2.method = oe.DELETE, r2.path = "".concat(ce, "/").concat(n3, "/metadata/").concat(i2), r2;
  }
  return t(n2, e2), n2;
}(xe);
!function(e2) {
  function n2() {
    return null !== e2 && e2.apply(this, arguments) || this;
  }
  t(n2, e2);
}(Ue);
var Wr = function(e2) {
  function n2(t2) {
    var n3 = t2.userId, i2 = e2.call(this) || this;
    return i2.method = oe.DELETE, i2.path = "".concat(ce, "/").concat(n3, "/metadata"), i2;
  }
  return t(n2, e2), n2;
}(xe);
!function(e2) {
  function n2() {
    return null !== e2 && e2.apply(this, arguments) || this;
  }
  t(n2, e2);
}(Ue);
var Zr;
var Yr = function(e2, t2) {
  var n2 = JSON.parse(JSON.stringify(e2));
  return n2._iid && delete n2._iid, t2 && t2(n2), n2;
};
var Xr = function(e2, t2) {
  var n2 = JSON.parse(JSON.stringify(e2));
  return t2 && t2(n2), n2;
};
var Jr = function(e2) {
  return { do: function(t2) {
    e2 || t2();
  }, throw: function(t2) {
    if (!e2) throw t2;
  } };
};
!function(e2) {
  e2.ONLINE = "online", e2.OFFLINE = "offline", e2.NON_AVAILABLE = "nonavailable";
}(Zr || (Zr = {}));
var $r;
var es = function(e2) {
  function i2(t2, n2) {
    var i3, r2, s2, o2, u2, l2, h2, d2, _2, f2, p2, E2, g2 = this;
    return (g2 = e2.call(this, t2) || this).userId = null !== (r2 = null !== (i3 = n2.guest_id) && void 0 !== i3 ? i3 : n2.user_id) && void 0 !== r2 ? r2 : "", g2.nickname = null !== (o2 = null !== (s2 = n2.nickname) && void 0 !== s2 ? s2 : n2.name) && void 0 !== o2 ? o2 : "", g2.plainProfileUrl = null !== (l2 = null !== (u2 = n2.profile_url) && void 0 !== u2 ? u2 : n2.image) && void 0 !== l2 ? l2 : "", g2.requireAuth = null !== (h2 = n2.require_auth_for_profile_image) && void 0 !== h2 && h2, g2.metaData = null !== (d2 = n2.metadata) && void 0 !== d2 ? d2 : {}, g2.connectionStatus = Zr.NON_AVAILABLE, S(Zr, n2.is_online) ? g2.connectionStatus = n2.is_online : w("boolean", n2.is_online) && (g2.connectionStatus = n2.is_online ? Zr.ONLINE : Zr.OFFLINE), g2.isActive = null === (_2 = n2.is_active) || void 0 === _2 || _2, g2.lastSeenAt = null !== (f2 = n2.last_seen_at) && void 0 !== f2 ? f2 : null, g2.preferredLanguages = n2.preferred_languages ? c([], a(n2.preferred_languages), false) : null, g2.friendDiscoveryKey = null !== (p2 = n2.friend_discovery_key) && void 0 !== p2 ? p2 : null, g2.friendName = null !== (E2 = n2.friend_name) && void 0 !== E2 ? E2 : null, g2;
  }
  return t(i2, e2), i2.payloadify = function(t2) {
    return re(se(n(n({}, e2.payloadify.call(this, t2)), { user_id: t2.userId, nickname: t2.nickname, profile_url: t2.plainProfileUrl, require_auth_for_profile_image: t2.requireAuth, metadata: t2.metaData, is_online: t2.connectionStatus, is_active: t2.isActive, last_seen_at: t2.lastSeenAt, preferred_languages: t2.preferredLanguages, friend_discovery_key: t2.friendDiscoveryKey, friend_name: t2.friendName })));
  }, Object.defineProperty(i2.prototype, "profileUrl", { get: function() {
    var e3 = Ws.of(this._iid).sessionManager;
    return this.requireAuth && e3.ekey ? "".concat(this.plainProfileUrl, "?auth=").concat(e3.ekey) : this.plainProfileUrl;
  }, enumerable: false, configurable: true }), i2.prototype.serialize = function() {
    return Yr(this);
  }, i2.prototype._isValidMetaData = function(e3) {
    return !Array.isArray(e3) && Object.keys(e3).length > 0 && Object.keys(e3).map(function(t2) {
      return e3[t2];
    }).every(function(e4) {
      return w("string", e4);
    });
  }, i2.prototype._applyMetaData = function(e3, t2) {
    var n2 = this;
    void 0 === t2 && (t2 = false), Object.keys(e3).forEach(function(i3) {
      t2 ? delete n2.metaData[i3] : n2.metaData[i3] = e3[i3];
    });
  }, i2.prototype.createMetaData = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n2, i3, r2, o2, a2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return Jr(this._isValidMetaData(e3)).throw(v.invalidParameters), t2 = Ws.of(this._iid), n2 = t2.sdkState, i3 = t2.requestQueue, r2 = new Gr({ userId: n2.userId, metadata: e3 }), [4, i3.send(r2)];
          case 1:
            return o2 = s2.sent(), a2 = o2.as(jr).metaData, this._applyMetaData(a2), [2, this.metaData];
        }
      });
    });
  }, i2.prototype.updateMetaData = function(e3, t2) {
    return void 0 === t2 && (t2 = false), r(this, void 0, void 0, function() {
      var n2, i3, r2, o2, a2, c2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return Jr(this._isValidMetaData(e3)).throw(v.invalidParameters), n2 = Ws.of(this._iid), i3 = n2.sdkState, r2 = n2.requestQueue, o2 = new Kr({ userId: i3.userId, metadata: e3, upsert: t2 }), [4, r2.send(o2)];
          case 1:
            return a2 = s2.sent(), c2 = a2.as(Br).metadata, this._applyMetaData(c2), [2, this.metaData];
        }
      });
    });
  }, i2.prototype.deleteMetaData = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n2, i3, r2, o2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return Jr(w("string", e3)).throw(v.invalidParameters), t2 = Ws.of(this._iid), n2 = t2.sdkState, i3 = t2.requestQueue, r2 = new Qr({ userId: n2.userId, metadataKey: e3 }), [4, i3.send(r2)];
          case 1:
            return s2.sent(), this._applyMetaData(((o2 = {})[e3] = true, o2), true), [2, this.metaData];
        }
      });
    });
  }, i2.prototype.deleteAllMetaData = function() {
    return r(this, void 0, void 0, function() {
      var e3, t2, n2, i3;
      return s(this, function(r2) {
        switch (r2.label) {
          case 0:
            return e3 = Ws.of(this._iid), t2 = e3.sdkState, n2 = e3.requestQueue, i3 = new Wr({ userId: t2.userId }), [4, n2.send(i3)];
          case 1:
            return r2.sent(), this.metaData = {}, [2];
        }
      });
    });
  }, i2;
}(zr);
var ts = function(e2) {
  function n2(t2) {
    var n3 = t2.userProfile, i2 = e2.call(this) || this;
    return i2.userProfile = n3, i2;
  }
  return t(n2, e2), n2;
}(ie);
var ns = function() {
  function e2(e3, t2) {
    var n2, i2, r2, s2, o2, a2, c2, u2, l2, h2, d2, _2, f2, p2;
    this._iid = e3, this.appInfo = new Hr(t2), this.user = new es(e3, t2), this.connectedAt = null !== (n2 = t2.login_ts) && void 0 !== n2 ? n2 : 0, this.firstConnectedAt = 0, this.pingInterval = null !== (i2 = t2.ping_interval) && void 0 !== i2 ? i2 : 15e3, this.pongTimeout = null !== (r2 = t2.pong_timeout) && void 0 !== r2 ? r2 : 5e3, this.reconnectInterval = null !== (o2 = null === (s2 = t2.reconnect) || void 0 === s2 ? void 0 : s2.interval) && void 0 !== o2 ? o2 : 3e3, this.reconnectMaxInterval = null !== (c2 = null === (a2 = t2.reconnect) || void 0 === a2 ? void 0 : a2.max_interval) && void 0 !== c2 ? c2 : 6e4, this.reconnectRetryCount = null !== (l2 = null === (u2 = t2.reconnect) || void 0 === u2 ? void 0 : u2.retry_cnt) && void 0 !== l2 ? l2 : 5, this.reconnectIntervalMultiple = null !== (d2 = null === (h2 = t2.reconnect) || void 0 === h2 ? void 0 : h2.mul) && void 0 !== d2 ? d2 : 2, this.maxUnreadCountOnSuperGroup = null !== (_2 = t2.max_unread_cnt_on_super_group) && void 0 !== _2 ? _2 : 100, this.profileImageEncryption = !!t2.profile_image_encryption, this.concurrentCallLimit = null !== (f2 = t2.concurrent_call_limit) && void 0 !== f2 ? f2 : 5, this.backOffDelay = null !== (p2 = t2.back_off_delay) && void 0 !== p2 ? p2 : 100;
  }
  return e2.payloadify = function(e3) {
    return re(se(n(n(n({}, es.payloadify(e3.user)), Hr.payloadify(e3.appInfo)), { login_ts: e3.connectedAt, ping_interval: e3.pingInterval, pong_timeout: e3.pongTimeout, reconnect: { interval: e3.reconnectInterval, max_interval: e3.reconnectMaxInterval, retry_cnt: e3.reconnectRetryCount, mul: e3.reconnectIntervalMultiple }, max_unread_cnt_on_super_group: e3.maxUnreadCountOnSuperGroup, profile_image_encryption: e3.profileImageEncryption, concurrent_call_limit: e3.concurrentCallLimit, back_off_delay: e3.backOffDelay })));
  }, e2.prototype.apply = function() {
    var e3 = this.reconnectInterval, t2 = this.reconnectMaxInterval, n2 = this.reconnectIntervalMultiple, i2 = Ws.of(this._iid);
    i2.sdkState.websocket && (i2.sdkState.websocket.pingInterval = 1e3 * this.pingInterval, i2.sdkState.websocket.pongTimeout = 1e3 * this.pongTimeout, i2.sdkState.websocket.reconnectMaxRetry = this.reconnectRetryCount, i2.sdkState.websocket.reconnectRetryStrategy = { calcTimeout: function(i3) {
      return i3 > 0 ? 1e3 * Math.min(e3 * Math.pow(n2, i3 - 1), t2) : 10;
    } }), i2.appInfo = this.appInfo, i2.sessionManager.currentUser = this.user, i2.connectedAt = this.connectedAt, this.firstConnectedAt || (i2.firstConnectedAt = this.connectedAt), i2.maxSuperGroupChannelUnreadCount = this.maxUnreadCountOnSuperGroup, i2.concurrentCallLimit = this.concurrentCallLimit, i2.backOffDelay = this.backOffDelay, i2.dispatcher.dispatch(new ts({ userProfile: this }));
  }, e2;
}();
var is = function(e2) {
  function i2(t2) {
    var i3 = t2.request, r2 = void 0 === i3 || i3, s2 = t2.features, o2 = void 0 === s2 ? {} : s2, a2 = t2.options, c2 = void 0 === a2 ? {} : a2, u2 = t2.statConfigInfo, l2 = e2.call(this) || this;
    return l2.request = r2, l2.features = n({ localCache: true, notification: true }, o2), l2.options = n({ ingestion: true }, c2), l2.statConfigInfo = u2, l2;
  }
  return t(i2, e2), i2;
}(ie);
var rs = function(e2) {
  function i2(t2, n2, i3) {
    var r2, s2, o2, a2, c2 = this;
    return (c2 = e2.call(this, t2, n2, i3) || this).error = null, c2.services = [], c2.userProfile = new ns(t2, i3), c2.deviceTokenLastDeletedAt = null !== (r2 = i3.device_token_last_deleted_at) && void 0 !== r2 ? r2 : 0, c2.key = null !== (s2 = i3.key) && void 0 !== s2 ? s2 : "", c2.ekey = null !== (o2 = i3.ekey) && void 0 !== o2 ? o2 : "", c2.error = i3.error ? new v(i3) : null, c2.services = null !== (a2 = i3.services) && void 0 !== a2 ? a2 : [], c2;
  }
  return t(i2, e2), i2.asError = function(e3) {
    return new i2("", "LOGI", n({ user_id: "", error: true }, e3));
  }, i2.prototype.applyTo = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n2, i3;
      return s(this, function(r2) {
        switch (r2.label) {
          case 0:
            return this.error ? [3, 4] : (t2 = Ws.of(e3)) ? (n2 = t2.sessionManager, i3 = t2.dispatcher, [4, n2.login(this)]) : [3, 2];
          case 1:
            return r2.sent(), this.userProfile.apply(), i3.dispatch(new is({ request: this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"), features: { localCache: this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish"), notification: this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_noti_stats_log_publish") }, options: { ingestion: this.userProfile.appInfo.allowSdkStatsUpload }, statConfigInfo: this.userProfile.appInfo.statConfigInfo })), [3, 3];
          case 2:
            throw v.lostInstance;
          case 3:
            return [3, 5];
          case 4:
            throw this.error;
          case 5:
            return [2];
        }
      });
    });
  }, i2;
}(Fe);
var ss = function() {
  function e2() {
    this.type = Sr.NONE, this.name = "none";
  }
  return e2.prototype.run = function(e3) {
    return r(this, void 0, void 0, function() {
      return s(this, function(e4) {
        return [2];
      });
    });
  }, e2.prototype.onConnect = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(e4) {
        return [2];
      });
    });
  }, e2.prototype.onReconnect = function(e3, t2) {
    return t2.resetReconnectCount, r(this, void 0, void 0, function() {
      return s(this, function(e4) {
        return [2];
      });
    });
  }, e2.prototype.onDisconnect = function(e3, t2) {
    return t2.error, t2.autoReconnect, t2.cause, r(this, void 0, void 0, function() {
      return s(this, function(e4) {
        return [2];
      });
    });
  }, e2.prototype.onDisconnectWebSocket = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(e4) {
        return [2];
      });
    });
  }, e2.prototype.onLogout = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(e4) {
        return [2];
      });
    });
  }, e2;
}();
var os = function(e2) {
  return r(void 0, void 0, void 0, function() {
    var t2;
    return s(this, function(n2) {
      switch (n2.label) {
        case 0:
          return n2.trys.push([0, 2, , 3]), [4, e2()];
        case 1:
          return n2.sent(), [3, 3];
        case 2:
          if (!((t2 = n2.sent()) instanceof v)) throw t2;
          return t2.throwOutside(), [3, 3];
        case 3:
          return [2];
      }
    });
  });
};
var as = function(e2) {
  return r(void 0, void 0, void 0, function() {
    return s(this, function(t2) {
      switch (t2.label) {
        case 0:
          return t2.trys.push([0, 2, , 3]), [4, e2()];
        case 1:
        case 2:
          return t2.sent(), [3, 3];
        case 3:
          return [2];
      }
    });
  });
};
var cs = function(e2) {
  function n2(t2) {
    void 0 === t2 && (t2 = {});
    var n3, i2 = this;
    return (i2 = e2.call(this) || this).type = Sr.LOGOUT, i2.name = "logout", i2._wasPreviouslyConnected = null === (n3 = t2.wasPreviouslyConnected) || void 0 === n3 || n3, i2;
  }
  return t(n2, e2), n2.prototype.run = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n3, i2 = this;
      return s(this, function(o2) {
        switch (o2.label) {
          case 0:
            return t2 = Date.now(), n3 = e3.sdkState.userId, [4, e3.logout()];
          case 1:
            return o2.sent(), [4, e3.changeState(new ms(), t2)];
          case 2:
            return o2.sent(), this._wasPreviouslyConnected && os(function() {
              return r(i2, void 0, void 0, function() {
                return s(this, function(t3) {
                  return e3.connectionHandlers.forEach(function(e4) {
                    e4.onDisconnected && e4.onDisconnected(n3);
                  }), [2];
                });
              });
            }), [2];
        }
      });
    });
  }, n2;
}(ss);
var us = function(e2) {
  function n2() {
    var t2 = e2.call(this) || this;
    return t2.type = Sr.EXTERNAL_DISCONNECTED, t2.name = "externaldisconnected", t2;
  }
  return t(n2, e2), n2.prototype.run = function(e3) {
    return r(this, void 0, void 0, function() {
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return [4, e3.disconnect()];
          case 1:
            return t2.sent(), [2];
        }
      });
    });
  }, n2.prototype.onConnect = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n3;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return n3 = Date.now(), [4, e3.disconnect()];
          case 1:
            return i2.sent(), [4, e3.changeState(new gs({ authToken: t2 }), n3)];
          case 2:
            return i2.sent(), [2];
        }
      });
    });
  }, n2.prototype.onReconnect = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.changeState(new fs(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2.prototype.onLogout = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.changeState(new cs(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2;
}(ss);
var ls = function(e2) {
  function n2(t2) {
    var n3 = t2.autoReconnect, i2 = e2.call(this) || this;
    return i2.type = Sr.INTERNAL_DISCONNECTED, i2.name = "internaldisconnected", i2._autoReconnect = false, i2._autoReconnect = n3, i2;
  }
  return t(n2, e2), n2.prototype.run = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.disconnect()];
          case 1:
            return n3.sent(), this._autoReconnect ? [4, e3.changeState(new fs(), t2)] : [3, 3];
          case 2:
            n3.sent(), n3.label = 3;
          case 3:
            return [2];
        }
      });
    });
  }, n2.prototype.onConnect = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n3;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return n3 = Date.now(), [4, e3.disconnect()];
          case 1:
            return i2.sent(), [4, e3.changeState(new gs({ authToken: t2 }), n3)];
          case 2:
            return i2.sent(), [2];
        }
      });
    });
  }, n2.prototype.onReconnect = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.changeState(new fs(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2.prototype.onDisconnectWebSocket = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.changeState(new us(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2.prototype.onLogout = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.changeState(new cs(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2;
}(ss);
var hs = function(e2) {
  return r(void 0, void 0, void 0, function() {
    return s(this, function(t2) {
      return [2, new Promise(function(t3) {
        return setTimeout(t3, e2);
      })];
    });
  });
};
var ds = function() {
  function e2() {
  }
  return e2.prototype.calcTimeout = function() {
    return 0;
  }, e2;
}();
var _s = function(e2, t2, n2) {
  return void 0 === n2 && (n2 = new ds()), r(void 0, void 0, void 0, function() {
    var i2, r2, o2, a2, c2, u2;
    return s(this, function(s2) {
      switch (s2.label) {
        case 0:
          i2 = 0, r2 = null, o2 = function(e3) {
            return r2 = null != e3 ? e3 : new Error("Halted");
          }, a2 = function() {
            i2 = 0;
          }, s2.label = 1;
        case 1:
          if (!(-1 === t2 || i2 < t2)) return [3, 9];
          s2.label = 2;
        case 2:
          return s2.trys.push([2, 4, , 8]), [4, e2(o2, a2)];
        case 3:
          if (c2 = s2.sent(), r2) throw r2;
          return [2, c2];
        case 4:
          if (u2 = s2.sent(), r2) return [3, 6];
          if (++i2 === t2) throw u2;
          return [4, hs(n2.calcTimeout(i2))];
        case 5:
          return s2.sent(), [3, 7];
        case 6:
          throw r2;
        case 7:
          return [3, 8];
        case 8:
          return [3, 1];
        case 9:
          throw "It should not happen.";
      }
    });
  });
};
var fs = function(e2) {
  function n2() {
    var t2 = null !== e2 && e2.apply(this, arguments) || this;
    return t2.type = Sr.RECONNECTING, t2.name = "reconnecting", t2._callbacks = [], t2;
  }
  return t(n2, e2), n2.prototype._halt = function(e3) {
    this._haltConnect && (this._haltConnect(e3), this._haltConnect = void 0);
  }, n2.prototype._flushCallbacks = function(e3) {
    this._haltConnect = void 0, this._resetConnect = void 0, this._callbacks.forEach(function(t2) {
      return t2(e3);
    });
  }, n2.prototype.run = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n3, i2, o2, a2, c2, l2 = this;
      return s(this, function(h2) {
        switch (h2.label) {
          case 0:
            t2 = Date.now(), n3 = new et(), this._callbacks.push(function(e4) {
              return e4 ? n3.reject(e4) : n3.resolve();
            }), os(function() {
              return r(l2, void 0, void 0, function() {
                return s(this, function(t3) {
                  return e3.connectionHandlers.forEach(function(e4) {
                    e4.onReconnectStarted && e4.onReconnectStarted();
                  }), [2];
                });
              });
            }), h2.label = 1;
          case 1:
            return h2.trys.push([1, 4, , 9]), i2 = e3.sdkState.websocket, o2 = i2.reconnectMaxRetry, a2 = i2.reconnectRetryStrategy, [4, _s(function(t3, n4) {
              return r(l2, void 0, void 0, function() {
                var i3;
                return s(this, function(r2) {
                  switch (r2.label) {
                    case 0:
                      this._haltConnect = t3, this._resetConnect = n4, r2.label = 1;
                    case 1:
                      return r2.trys.push([1, 3, , 4]), [4, e3.connect()];
                    case 2:
                      return r2.sent(), [3, 4];
                    case 3:
                      if (i3 = r2.sent(), e3.clearLoginTimer(), i3 instanceof v) {
                        if (i3.code === u.CONNECTION_CANCELED) return t3(i3), [2];
                        if (i3.isSessionExpiredError || i3.isSessionInvalidatedError) return t3(i3), [2];
                      }
                      throw i3;
                    case 4:
                      return [2];
                  }
                });
              });
            }, o2, a2)];
          case 2:
            return h2.sent(), [4, e3.changeState(new ps(), t2)];
          case 3:
            return h2.sent(), this._flushCallbacks(), os(function() {
              return r(l2, void 0, void 0, function() {
                return s(this, function(t3) {
                  return e3.connectionHandlers.forEach(function(e4) {
                    e4.onReconnectSucceeded && e4.onReconnectSucceeded();
                  }), [2];
                });
              });
            }), [3, 9];
          case 4:
            return c2 = h2.sent(), g(c2) ? [3, 7] : c2 instanceof v ? c2.code === u.CONNECTION_CANCELED ? [3, 6] : [4, e3.changeState(new ls({ autoReconnect: false }), t2)] : [3, 6];
          case 5:
            h2.sent(), h2.label = 6;
          case 6:
            return this._flushCallbacks(c2), os(function() {
              return r(l2, void 0, void 0, function() {
                return s(this, function(t3) {
                  return e3.connectionHandlers.forEach(function(e4) {
                    e4.onReconnectFailed && e4.onReconnectFailed();
                  }), [2];
                });
              });
            }), [3, 8];
          case 7:
            throw c2;
          case 8:
            return [3, 9];
          case 9:
            return [2, n3.promise];
        }
      });
    });
  }, n2.prototype.onConnect = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n3;
      return s(this, function(i2) {
        return n3 = new et(), this._halt(v.connectionCanceled), e3.cancelConnectForRetry(), this._callbacks.push(function() {
          var i3 = Date.now();
          e3.changeState(new gs({ authToken: t2 }), i3).then(function() {
            n3.resolve();
          }).catch(function(e4) {
            n3.reject(e4);
          });
        }), [2, n3.promise];
      });
    });
  }, n2.prototype.onReconnect = function(e3, t2) {
    var n3 = t2.resetReconnectCount, i2 = void 0 !== n3 && n3;
    return r(this, void 0, void 0, function() {
      var e4;
      return s(this, function(t3) {
        return e4 = new et(), this._resetConnect && i2 && this._resetConnect(), this._callbacks.push(function(t4) {
          return t4 ? e4.reject(t4) : e4.resolve();
        }), [2, e4.promise];
      });
    });
  }, n2.prototype.onDisconnect = function(e3, t2) {
    t2._error;
    var n3 = t2.autoReconnect, i2 = void 0 === n3 || n3;
    return r(this, void 0, void 0, function() {
      var t3;
      return s(this, function(n4) {
        switch (n4.label) {
          case 0:
            return t3 = Date.now(), this._halt(v.connectionCanceled), [4, e3.changeState(new ls({ autoReconnect: i2 }), t3)];
          case 1:
            return n4.sent(), [2];
        }
      });
    });
  }, n2.prototype.onDisconnectWebSocket = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), this._halt(v.connectionCanceled), [4, e3.changeState(new us(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2.prototype.onLogout = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), this._halt(v.connectionCanceled), [4, e3.changeState(new cs(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2;
}(ss);
var ps = function(e2) {
  function n2() {
    var t2 = null !== e2 && e2.apply(this, arguments) || this;
    return t2.type = Sr.CONNECTED, t2.name = "connected", t2;
  }
  return t(n2, e2), n2.prototype.onReconnect = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.disconnect()];
          case 1:
            return n3.sent(), [4, e3.changeState(new fs(), t2)];
          case 2:
            return n3.sent(), [2];
        }
      });
    });
  }, n2.prototype.onDisconnect = function(e3, t2) {
    var n3 = t2.autoReconnect;
    return r(this, void 0, void 0, function() {
      var t3;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return t3 = Date.now(), [4, e3.changeState(new ls({ autoReconnect: n3 }), t3)];
          case 1:
            return i2.sent(), [2];
        }
      });
    });
  }, n2.prototype.onDisconnectWebSocket = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.changeState(new us(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2.prototype.onLogout = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.changeState(new cs(), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2;
}(ss);
!function(e2) {
  e2.ExternalSetBackground = "ExternalSetBackground", e2.ExternalDisconnectWebSocket = "ExternalDisconnectWebSocket";
}($r || ($r = {}));
var Es = function() {
  function e2(e3, t2) {
    var n2 = t2.sdkState, i2 = t2.cacheContext, r2 = t2.connectionHandlers, s2 = t2.sessionManager, o2 = t2.websocketClient, a2 = t2.dispatcher, c2 = t2.logger, u2 = t2.disableWebSocketCloseEventHandling, l2 = void 0 !== u2 && u2;
    this._disableWebSocketCloseEventHandling = false, this._webSocketClosedCause = null, this._logger = c2, this._disableWebSocketCloseEventHandling = l2, this._context = new Ts(e3, { sdkState: n2, cacheContext: i2, connectionHandlers: r2, sessionManager: s2, websocketClient: o2, dispatcher: a2, logger: c2 }), this._sdkState = n2, this._sessionManager = s2, this._websocketClient = o2;
  }
  return e2.prototype._registerEventDispatcher = function() {
    var e3 = this;
    this._disableWebSocketCloseEventHandling || (this._clearEventDispatcher(), this._sessionEventDispatcherContext = this._sessionManager.on("refresh", function() {
      e3.isConnecting || e3.isConnected || (e3._logger.debug("try reconnect by session key refresh"), as(function() {
        return r(e3, void 0, void 0, function() {
          return s(this, function(e4) {
            switch (e4.label) {
              case 0:
                return [4, this.reconnect()];
              case 1:
                return e4.sent(), [2];
            }
          });
        });
      }));
    }), this._websocketEventDispatcherContext = this._websocketClient.on("close", function() {
      "foreground" !== e3._sdkState.appState || e3._webSocketClosedCause || as(function() {
        return r(e3, void 0, void 0, function() {
          return s(this, function(e4) {
            switch (e4.label) {
              case 0:
                return this._sessionManager.isSessionKeyRefreshing ? [3, 2] : (this._logger.debug("try reconnect by websocket connection closed"), [4, this.reconnect()]);
              case 1:
                return e4.sent(), [3, 4];
              case 2:
                return [4, this.disconnectWebSocket()];
              case 3:
                e4.sent(), e4.label = 4;
              case 4:
                return [2];
            }
          });
        });
      });
    }));
  }, e2.prototype._clearEventDispatcher = function() {
    this._sessionEventDispatcherContext && (this._sessionEventDispatcherContext.close(), this._sessionEventDispatcherContext = void 0), this._websocketEventDispatcherContext && (this._websocketEventDispatcherContext.close(), this._websocketEventDispatcherContext = void 0);
  }, Object.defineProperty(e2.prototype, "isConnected", { get: function() {
    return this._context.currentState.type === Sr.CONNECTED;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "isConnecting", { get: function() {
    var e3 = this._context.currentState;
    return e3.type === Sr.CONNECTING || e3.type === Sr.RECONNECTING;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "websocketClient", { get: function() {
    return this._websocketClient;
  }, enumerable: false, configurable: true }), e2.prototype.connect = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return t2 = this._context.currentState, this._webSocketClosedCause = null, [4, t2.onConnect(this._context, e3)];
          case 1:
            return n2.sent(), this._registerEventDispatcher(), [2];
        }
      });
    });
  }, e2.prototype.reconnect = function() {
    return r(this, void 0, void 0, function() {
      var e3;
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return e3 = this._context.currentState, this._webSocketClosedCause = null, [4, e3.onReconnect(this._context, {})];
          case 1:
            return t2.sent(), [2];
        }
      });
    });
  }, e2.prototype.resetAndReconnect = function() {
    return r(this, void 0, void 0, function() {
      var e3;
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return e3 = this._context.currentState, this._webSocketClosedCause = null, [4, e3.onReconnect(this._context, { resetReconnectCount: true })];
          case 1:
            return t2.sent(), [2];
        }
      });
    });
  }, e2.prototype.background = function() {
    return r(this, void 0, void 0, function() {
      var e3;
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return e3 = this._context.currentState, this._webSocketClosedCause = $r.ExternalSetBackground, [4, e3.onDisconnect(this._context, { autoReconnect: false, cause: this._webSocketClosedCause })];
          case 1:
            return t2.sent(), [2];
        }
      });
    });
  }, e2.prototype.disconnect = function(e3) {
    return r(this, void 0, void 0, function() {
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return [4, this._context.currentState.onDisconnect(this._context, { error: e3, autoReconnect: true, cause: this._webSocketClosedCause })];
          case 1:
            return t2.sent(), [2];
        }
      });
    });
  }, e2.prototype.disconnectWebSocket = function(e3) {
    return void 0 === e3 && (e3 = false), r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return t2 = this._context.currentState, e3 && (this._webSocketClosedCause = $r.ExternalDisconnectWebSocket), [4, t2.onDisconnectWebSocket(this._context, { cause: this._webSocketClosedCause })];
          case 1:
            return n2.sent(), [2];
        }
      });
    });
  }, e2.prototype.logout = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return t2 = this._context.currentState, this._clearEventDispatcher(), [4, t2.onLogout(this._context, e3)];
          case 1:
            return n2.sent(), [2];
        }
      });
    });
  }, e2;
}();
var gs = function(e2) {
  function n2(t2) {
    var n3 = t2.authToken, i2 = e2.call(this) || this;
    return i2.type = Sr.CONNECTING, i2.name = "connecting", i2._authToken = "", i2._callbacks = [], i2._authToken = n3, i2;
  }
  return t(n2, e2), n2.prototype._halt = function(e3) {
    this._haltConnect && (this._haltConnect(e3), this._haltConnect = void 0);
  }, n2.prototype._flushCallbacks = function(e3) {
    this._haltConnect = void 0, this._callbacks.forEach(function(t2) {
      return t2(e3);
    });
  }, n2.prototype.run = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n3, i2, o2 = this;
      return s(this, function(a2) {
        switch (a2.label) {
          case 0:
            t2 = Date.now(), n3 = new et(), this._callbacks.push(function(e4) {
              return e4 ? n3.reject(e4) : n3.resolve();
            }), a2.label = 1;
          case 1:
            return a2.trys.push([1, 4, , 10]), [4, _s(function(t3) {
              return r(o2, void 0, void 0, function() {
                var n4;
                return s(this, function(i3) {
                  switch (i3.label) {
                    case 0:
                      this._haltConnect = t3, i3.label = 1;
                    case 1:
                      return i3.trys.push([1, 3, , 4]), [4, e3.connect(this._authToken)];
                    case 2:
                      return i3.sent(), [3, 4];
                    case 3:
                      if (n4 = i3.sent(), e3.clearLoginTimer(), n4 instanceof v && n4.code === u.CONNECTION_CANCELED) return t3(n4), [2];
                      throw n4;
                    case 4:
                      return [2];
                  }
                });
              });
            }, e3.sdkState.websocket.connectMaxRetry)];
          case 2:
            return a2.sent(), [4, e3.changeState(new ps(), t2)];
          case 3:
            return a2.sent(), os(function() {
              return r(o2, void 0, void 0, function() {
                return s(this, function(t3) {
                  return this._flushCallbacks(), e3.connectionHandlers.forEach(function(t4) {
                    t4.onConnected && t4.onConnected(e3.sdkState.userId);
                  }), [2];
                });
              });
            }), [3, 10];
          case 4:
            return i2 = a2.sent(), g(i2) ? [3, 8] : [4, e3.disconnect()];
          case 5:
            return a2.sent(), i2 instanceof v ? i2.code === u.CONNECTION_CANCELED ? [3, 7] : [4, e3.changeState(new ms(), t2)] : [3, 7];
          case 6:
            a2.sent(), a2.label = 7;
          case 7:
            return os(function() {
              return r(o2, void 0, void 0, function() {
                return s(this, function(e4) {
                  return this._flushCallbacks(i2), [2];
                });
              });
            }), [3, 9];
          case 8:
            throw i2;
          case 9:
            return [3, 10];
          case 10:
            return [2, n3.promise];
        }
      });
    });
  }, n2.prototype.onConnect = function(e3) {
    return r(this, void 0, void 0, function() {
      var e4;
      return s(this, function(t2) {
        return e4 = new et(), this._callbacks.push(function(t3) {
          return t3 ? e4.reject(t3) : e4.resolve();
        }), [2, e4.promise];
      });
    });
  }, n2.prototype.onDisconnect = function(e3, t2) {
    var n3 = t2.error, i2 = void 0 === n3 ? null : n3, o2 = t2.autoReconnect, a2 = void 0 !== o2 && o2, c2 = t2.cause, u2 = void 0 === c2 ? null : c2;
    return r(this, void 0, void 0, function() {
      var t3;
      return s(this, function(n4) {
        switch (n4.label) {
          case 0:
            return t3 = Date.now(), this._halt(null != i2 ? i2 : vs(u2)), e3.hasSession ? [4, e3.changeState(new ls({ autoReconnect: a2 }), t3)] : [3, 2];
          case 1:
            return n4.sent(), [3, 4];
          case 2:
            return [4, e3.changeState(new cs(), t3)];
          case 3:
            n4.sent(), n4.label = 4;
          case 4:
            return [2];
        }
      });
    });
  }, n2.prototype.onDisconnectWebSocket = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n3;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return this._halt(vs((null == t2 ? void 0 : t2.cause) || null)), n3 = Date.now(), e3.hasSession ? [4, e3.changeState(new us(), n3)] : [3, 2];
          case 1:
            return i2.sent(), [3, 4];
          case 2:
            return [4, e3.changeState(new cs(), n3)];
          case 3:
            i2.sent(), i2.label = 4;
          case 4:
            return [2];
        }
      });
    });
  }, n2.prototype.onLogout = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n3;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return n3 = Date.now(), this._halt(null != t2 ? t2 : v.connectionCanceled), [4, e3.changeState(new cs(), n3)];
          case 1:
            return i2.sent(), [2];
        }
      });
    });
  }, n2;
}(ss);
function vs(e2) {
  var t2 = v.connectionCanceled;
  if (e2) {
    var n2 = null;
    switch (e2) {
      case $r.ExternalSetBackground:
        n2 = "Connection has been canceled due to the application having externally moved to background while in ConnectingState.";
        break;
      case $r.ExternalDisconnectWebSocket:
        n2 = "Connection has been canceled because sb.disconnectWebSocket() was called while in ConnectingState.";
    }
    n2 && t2.setDetail(n2);
  }
  return t2;
}
var bs;
var ms = function(e2) {
  function n2() {
    var t2 = null !== e2 && e2.apply(this, arguments) || this;
    return t2.type = Sr.INITIALIZED, t2.name = "initialized", t2;
  }
  return t(n2, e2), n2.prototype.onConnect = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n3;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return n3 = Date.now(), [4, e3.changeState(new gs({ authToken: t2 }), n3)];
          case 1:
            return i2.sent(), [2];
        }
      });
    });
  }, n2.prototype.onLogout = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = Date.now(), [4, e3.changeState(new cs({ wasPreviouslyConnected: false }), t2)];
          case 1:
            return n3.sent(), [2];
        }
      });
    });
  }, n2;
}(ss);
var ys = function(e2) {
  function n2() {
    return e2.call(this, { code: "PING", payload: { id: Date.now(), active: 1 }, ackRequired: false }) || this;
  }
  return t(n2, e2), n2;
}(qe);
var ws = function() {
  function e2(e3) {
    var t2 = e3.pingDelegate, n2 = e3.sdkState, i2 = e3.logger;
    this.pingDelegate = t2, this.sdkState = n2, this._logger = i2;
  }
  return Object.defineProperty(e2.prototype, "isWaiting", { get: function() {
    return !!this._pingTimeoutTimer;
  }, enumerable: false, configurable: true }), e2.prototype.ping = function() {
    var e3, t2 = this;
    if (!this.sdkState.websocket) throw v.connectionRequired;
    var n2 = new ys();
    try {
      var i2 = null !== (e3 = this.sdkState.websocket.pongTimeout) && void 0 !== e3 ? e3 : 5e3;
      this._pingTimeoutTimer = setTimeout(function() {
        t2._logger.debug("pinger.ping() timeout"), t2.pingDelegate.error();
      }, i2), this.pingDelegate.send(n2), this._logger.debug("pinger.ping()");
    } catch (e4) {
      this._logger.debug("pinger.ping() error", e4), this._pingTimeoutTimer && (clearTimeout(this._pingTimeoutTimer), this._pingTimeoutTimer = void 0), this.pingDelegate.error();
    }
    return n2;
  }, e2.prototype.pong = function() {
    this._logger.debug("pinger.pong()"), this._pingTimeoutTimer && (clearTimeout(this._pingTimeoutTimer), this._pingTimeoutTimer = void 0);
  }, e2.prototype.refreshTimer = function() {
    var e3, t2 = this;
    if (!this.sdkState.websocket) throw v.connectionRequired;
    this._logger.debug("pinger.refreshTimer()");
    var n2 = null !== (e3 = this.sdkState.websocket.pingInterval) && void 0 !== e3 ? e3 : 15e3;
    this.stop(), this._pingTimer = setInterval(function() {
      t2.ping();
    }, n2);
  }, e2.prototype.start = function() {
    this._logger.debug("pinger.start()"), this.refreshTimer(), this.ping();
  }, e2.prototype.stop = function() {
    this._logger.debug("pinger.stop()"), this._pingTimer && (clearInterval(this._pingTimer), this._pingTimer = void 0), this._pingTimeoutTimer && (clearTimeout(this._pingTimeoutTimer), this._pingTimeoutTimer = void 0);
  }, e2;
}();
var Ss = ["premium_feature_list", "file_upload_size_limit", "application_attributes", "emoji_hash", "multiple_file_send_max_size", "notifications", "message_template"];
var Ts = function(e2) {
  function n2(t2, n3) {
    var i2, r2 = n3.sdkState, s2 = n3.cacheContext, o2 = n3.connectionHandlers, a2 = n3.sessionManager, c2 = n3.websocketClient, u2 = n3.dispatcher, l2 = n3.logger, h2 = n3.entryState, d2 = void 0 === h2 ? new ms() : h2, _2 = this;
    return (_2 = e2.call(this) || this)._stateUpdatedAt = 0, _2._connectingAt = 0, _2._connectionRequestQueue = [], _2._iid = t2, _2.sdkState = r2, _2.cacheContext = s2, _2.connectionHandlers = o2, _2._sessionManager = a2, _2._websocketClient = c2, _2._dispatcher = u2, _2._logger = l2, _2._currentState = d2, (null === (i2 = _2.sdkState.websocket) || void 0 === i2 ? void 0 : i2.pingerDisabled) || (_2._pinger = new ws({ pingDelegate: { send: function(e3) {
      return _2._websocketClient.send(e3);
    }, error: function(e3) {
      return _2._websocketClient.error(e3);
    } }, sdkState: _2.sdkState, logger: l2 })), _2._websocketClient.on("open", function() {
      _2._tryResolveConnectionRequest();
    }).on("message", function(e3) {
      if ("LOGI" === e3.code) _2.clearLoginTimer(), _2._dispatcher.dispatch(e3.as(rs));
    }).on("ping-refresh", function() {
      var e3;
      return null === (e3 = _2._pinger) || void 0 === e3 ? void 0 : e3.refreshTimer();
    }).on("pong", function() {
      var e3;
      return null === (e3 = _2._pinger) || void 0 === e3 ? void 0 : e3.pong();
    }).on("error", function() {
      var e3;
      return null === (e3 = _2._pinger) || void 0 === e3 ? void 0 : e3.stop();
    }).on("close", function() {
      _2._logiProcessingTimer = setTimeout(function() {
        _2._logiProcessingTimer = void 0, _2._unresolvedLogi || _2._rejectConnectionRequest(v.networkError);
      }, 500);
    }), _2._dispatcher.on(function(e3) {
      e3 instanceof rs && (_2._unresolvedLogi = e3, _2._tryResolveConnectionRequest());
    }), _2;
  }
  return t(n2, e2), Object.defineProperty(n2.prototype, "currentState", { get: function() {
    return this._currentState;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "hasSession", { get: function() {
    return this._sessionManager.session.hasSession;
  }, enumerable: false, configurable: true }), n2.prototype.changeState = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 >= this._stateUpdatedAt ? (this._currentState = e3, this._stateUpdatedAt = t2, this._dispatcher.dispatch(new kr({ stateType: e3.type })), this._logger.debug("connection state changes to ".concat(e3.name)), [4, this._currentState.run(this)]) : [3, 2];
          case 1:
            return n3.sent(), [2, true];
          case 2:
            return [2, false];
        }
      });
    });
  }, n2.prototype._tryResolveConnectionRequest = function() {
    var e3;
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return t2 = this._unresolvedLogi, this._websocketClient.isOpen && t2 ? (this._unresolvedLogi = void 0, t2.error ? [3, 2] : [4, t2.applyTo(this._iid)]) : [3, 3];
          case 1:
            return n3.sent(), this._statLogConnection(), null === (e3 = this._pinger) || void 0 === e3 || e3.start(), this._connectionRequestQueue.forEach(function(e4) {
              return e4.resolve();
            }), this._connectionRequestQueue = [], this.sdkState.appState = "foreground", [3, 3];
          case 2:
            this._sessionManager.session.authToken = void 0, (t2.error.isSessionExpiredError || t2.error.isSessionInvalidatedError) && this._dispatcher.dispatch(new Me({ reason: t2.error.code, message: t2.error.message })), this._logger.warn("login failed: ".concat(t2.error)), this._rejectConnectionRequest(t2.error), n3.label = 3;
          case 3:
            return [2];
        }
      });
    });
  }, n2.prototype._rejectConnectionRequest = function(e3) {
    var t2;
    if (null === (t2 = this._pinger) || void 0 === t2 || t2.stop(), this.clearLoginTimer(), this._connectionRequestQueue.length > 0) {
      var n3 = this._connectionRequestQueue;
      this._connectionRequestQueue = [], n3.forEach(function(t3) {
        return t3.reject(e3);
      }), this._statLogConnection(e3);
    }
  }, n2.prototype._url = function() {
    var e3, t2 = this.sdkState, n3 = t2.appId, i2 = t2.appVersion, r2 = t2.userId, s2 = t2.extensions, o2 = t2.sendbirdRuntimeEnvironment, a2 = this.cacheContext.localCacheEnabled, c2 = this._sessionManager.session, u2 = null === (e3 = this.sdkState.websocket) || void 0 === e3 ? void 0 : e3.compression, l2 = !!(null != s2 ? s2 : {}).sb_uikit, d2 = $e.userAgentWithExtension(s2);
    return "".concat(this.sdkState.websocket.host, "/?p=JS&pv=").concat(encodeURIComponent(h.OS_VERSION), "&sv=").concat(encodeURIComponent(h.SDK_VERSION), "&ai=").concat(n3).concat(i2 ? "&av=".concat(i2) : "").concat(c2.hasSession ? "" : "&user_id=".concat(encodeURIComponent(r2)), "&pmce=").concat(u2 ? 1 : 0, "&active=1&device_token_types=").concat(encodeURIComponent(["gcm", "huawei", "apns"].join(",")), "&SB-User-Agent=").concat(d2, "&SB-SDK-User-Agent=").concat(encodeURIComponent($e.sendbirdSdkUserAgentWithExtension(o2)), "&Request-Sent-Timestamp=").concat(Date.now().toString(), "&include_extra_data=").concat(encodeURIComponent(String(Ss))).concat(this._sessionManager.handler ? "&expiring_session=1" : "", "&use_local_cache=").concat(a2 ? 1 : 0, "&include_poll_details=1").concat(l2 ? "&uikit_config=1" : "");
  }, n2.prototype._statLogConnection = function(e3) {
    var t2;
    this._dispatcher.dispatch(new je(new Ze({ type: Le.WEBSOCKET_CONNECT, data: { host_url: null === (t2 = this.sdkState.websocket) || void 0 === t2 ? void 0 : t2.host, success: !e3, latency: Date.now() - this._connectingAt, error_code: null == e3 ? void 0 : e3.code, error_description: null == e3 ? void 0 : e3.message } })));
  }, n2.prototype.connect = function(e3) {
    var t2;
    return void 0 === e3 && (e3 = ""), r(this, void 0, void 0, function() {
      var n3, i2, r2, o2 = this;
      return s(this, function(s2) {
        return this._logiProcessingTimer && (clearTimeout(this._logiProcessingTimer), this._logiProcessingTimer = void 0, this._rejectConnectionRequest(v.connectionCanceled)), n3 = new et(), this._connectionRequestQueue.push(n3), 1 === this._connectionRequestQueue.length && (this._connectingAt = Date.now(), this._loginTimer = setTimeout(function() {
          o2._loginTimer = void 0, o2._rejectConnectionRequest(v.loginTimeout);
        }, null === (t2 = this.sdkState.websocket) || void 0 === t2 ? void 0 : t2.responseTimeout), i2 = this._sessionManager.session, e3 && (i2.authToken = e3, i2.sessionKey = void 0), r2 = this._url(), i2.sessionKey || i2.authToken ? this._websocketClient.connect(r2, JSON.stringify(i2.hasSession ? { auth: i2.sessionKey } : { token: i2.authToken })) : this._websocketClient.connect(r2, JSON.stringify({}))), [2, n3.promise];
      });
    });
  }, n2.prototype.cancelConnectForRetry = function() {
    this._dispatcher.dispatch(rs.asError(v.connectionRenew));
  }, n2.prototype.disconnect = function() {
    return r(this, void 0, void 0, function() {
      return s(this, function(e3) {
        switch (e3.label) {
          case 0:
            return [4, this._websocketClient.disconnect()];
          case 1:
            return e3.sent(), [2];
        }
      });
    });
  }, n2.prototype.logout = function() {
    return r(this, void 0, void 0, function() {
      return s(this, function(e3) {
        switch (e3.label) {
          case 0:
            return this.sdkState.userId = void 0, this._unresolvedLogi = void 0, [4, this.disconnect()];
          case 1:
            return e3.sent(), [4, this._sessionManager.clear()];
          case 2:
            return e3.sent(), [2];
        }
      });
    });
  }, n2.prototype.clearLoginTimer = function() {
    this._loginTimer && (clearTimeout(this._loginTimer), this._loginTimer = void 0);
  }, n2;
}(te);
var Ns = function(e2) {
  function n2(t2) {
    var n3 = t2.appId, i2 = t2.userId, r2 = t2.includeUIKitConfig, s2 = void 0 !== r2 && r2, o2 = t2.localCacheEnabled, a2 = void 0 === o2 || o2, c2 = t2.expiringSession, u2 = void 0 === c2 || c2, l2 = e2.call(this) || this;
    return l2.path = "".concat(ue, "/").concat(i2, "/authentication"), l2.method = oe.POST, l2.params = re({ expiring_session: !!u2, include_logi: true, include_extra_data: String(Ss), uikit_config: s2, use_local_cache: a2, app_id: n3 }), l2.requireAuth = false, l2;
  }
  return t(n2, e2), n2;
}(xe);
var Cs = function(e2) {
  function n2(t2, n3) {
    var i2 = e2.call(this, t2, n3) || this;
    return i2.logi = new rs(t2, "LOGI", n3), i2;
  }
  return t(n2, e2), n2;
}(Ue);
!function(e2) {
  e2[e2.ALL = 0] = "ALL", e2[e2.WEBSOCKET = 1] = "WEBSOCKET", e2[e2.API = 2] = "API";
}(bs || (bs = {}));
var As;
var Is;
var ks = [Ve, Ns];
var Os = function() {
  function e2(e3, t2) {
    var n2 = t2.session, i2 = t2.sdkState, r2 = t2.dispatcher, s2 = t2.logger, a2 = t2.useFetchCompat, c2 = void 0 !== a2 && a2, u2 = this;
    this._currentConnectionStateType = Sr.INITIALIZED, this._lazyCallQueue = [], this.commandRouter = new Cr(e3, { session: n2, sdkState: i2, dispatcher: r2, logger: s2, useFetchCompat: c2 }), this._session = n2, this._logger = s2, this._dispatcher = r2, this._dispatcher.on(function(e4) {
      var t3, n3, i3;
      if (e4 instanceof kr) {
        var r3 = e4.stateType;
        switch (u2._currentConnectionStateType = r3, r3) {
          case Sr.CONNECTED:
            u2._resolveLazyCallQueue();
            break;
          case Sr.INITIALIZED:
          case Sr.INTERNAL_DISCONNECTED:
          case Sr.EXTERNAL_DISCONNECTED:
          case Sr.LOGOUT:
            u2._rejectLazyCallQueue((null === (i3 = u2._session) || void 0 === i3 ? void 0 : i3.hasSession) ? v.connectionClosed : v.connectionRequired);
        }
      } else if (e4 instanceof Or) u2._session.hasChatServicePermission || u2._resolveLazyCallQueue(bs.API);
      else if (e4 instanceof Dr || e4 instanceof Rr) u2._rejectLazyCallQueue(v.connectionClosed);
      else if (e4 instanceof Ke) {
        var s3 = e4.request, a3 = e4.deferred, c3 = e4.error;
        try {
          for (var l2 = o(ks), h2 = l2.next(); !h2.done; h2 = l2.next()) {
            if (s3 instanceof h2.value) return void a3.reject(c3);
          }
        } catch (e5) {
          t3 = { error: e5 };
        } finally {
          try {
            h2 && !h2.done && (n3 = l2.return) && n3.call(l2);
          } finally {
            if (t3) throw t3.error;
          }
        }
        u2._lazyCallQueue.push({ command: s3, deferred: a3 });
      }
    });
  }
  return Object.defineProperty(e2.prototype, "isReady", { get: function() {
    return this._currentConnectionStateType === Sr.CONNECTED;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "isLazyCallActivated", { get: function() {
    return this._currentConnectionStateType === Sr.CONNECTING || this._currentConnectionStateType === Sr.RECONNECTING || this._session.isRefreshing;
  }, enumerable: false, configurable: true }), e2.prototype._classifyLazyCallQueueByScope = function(e3) {
    var t2, n2 = [], i2 = [];
    switch (e3) {
      case bs.ALL:
        t2 = null;
        break;
      case bs.WEBSOCKET:
        t2 = qe;
        break;
      case bs.API:
        t2 = xe;
    }
    var r2 = false;
    return this._lazyCallQueue.forEach(function(e4) {
      !t2 || e4.command instanceof t2 || (r2 = true), r2 ? i2.push(e4) : n2.push(e4);
    }), [n2, i2];
  }, e2.prototype._resolveLazyCallQueue = function(e3) {
    var t2 = this;
    void 0 === e3 && (e3 = bs.ALL);
    var n2 = a(this._classifyLazyCallQueueByScope(e3), 2), i2 = n2[0], o2 = n2[1];
    this._lazyCallQueue = o2, i2.forEach(function(e4) {
      return r(t2, void 0, void 0, function() {
        var t3, n3, i3, r2, o3;
        return s(this, function(s2) {
          switch (s2.label) {
            case 0:
              t3 = e4.command, n3 = e4.deferred, (i3 = e4.timeout) && clearTimeout(i3), s2.label = 1;
            case 1:
              return s2.trys.push([1, 3, , 4]), [4, this.send(t3)];
            case 2:
              return r2 = s2.sent(), n3.resolve(r2), [3, 4];
            case 3:
              return o3 = s2.sent(), n3.reject(o3), [3, 4];
            case 4:
              return [2];
          }
        });
      });
    });
  }, e2.prototype._rejectLazyCallQueue = function(e3, t2) {
    var n2 = this;
    void 0 === t2 && (t2 = bs.ALL);
    var i2 = a(this._classifyLazyCallQueueByScope(t2), 2), o2 = i2[0], c2 = i2[1];
    this._lazyCallQueue = c2, o2.forEach(function(t3) {
      return r(n2, void 0, void 0, function() {
        var n3, i3;
        return s(this, function(r2) {
          return n3 = t3.deferred, i3 = t3.timeout, clearTimeout(i3), n3.reject(e3), [2];
        });
      });
    });
  }, e2.prototype.send = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n2, i2 = this;
      return s(this, function(r2) {
        switch (r2.label) {
          case 0:
            return e3 instanceof qe ? this.isReady ? (this._logger.debug("send websocket request", e3), [4, this.commandRouter.send(e3)]) : [3, 2] : [3, 4];
          case 1:
          case 5:
          case 7:
            return [2, r2.sent()];
          case 2:
            if (this.isLazyCallActivated) return this._logger.debug("wait websocket request", e3), t2 = new et(), this._lazyCallQueue.push({ command: e3, deferred: t2, timeout: setTimeout(function() {
              return i2.timeout(e3.requestId);
            }, 1e4) }), [2, t2.promise];
            throw this._logger.debug("fail websocket request"), v.connectionRequired;
          case 3:
          case 9:
            return [3, 11];
          case 4:
            return e3 instanceof xe ? this._session.hasSession ? (this._logger.debug("send api request", e3), [4, this.commandRouter.send(e3)]) : [3, 6] : [3, 10];
          case 6:
            return e3.hasSessionKey ? (this._logger.debug("send api request with tmp session key", e3), [4, this.commandRouter.send(e3)]) : [3, 8];
          case 8:
            if (this.isLazyCallActivated) return this._logger.debug("wait api request", e3), t2 = new et(), this._lazyCallQueue.push({ command: e3, deferred: t2, timeout: setTimeout(function() {
              return i2.timeout(e3.requestId);
            }, 1e4) }), [2, t2.promise];
            throw n2 = v.connectionRequired, this._logger.debug("fail api request", n2), n2;
          case 10:
            throw v.invalidCommand;
          case 11:
            return [2];
        }
      });
    });
  }, e2.prototype.forceSend = function(e3) {
    return r(this, void 0, void 0, function() {
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return this._logger.debug("send forced request", e3), e3 instanceof qe || e3 instanceof xe ? [4, this.commandRouter.send(e3)] : [3, 2];
          case 1:
            return [2, t2.sent()];
          case 2:
            throw v.invalidCommand;
        }
      });
    });
  }, e2.prototype.timeout = function(e3) {
    this._logger.debug("timeout request", e3);
    var t2 = this._lazyCallQueue.findIndex(function(t3) {
      return t3.command.requestId === e3;
    });
    t2 > -1 && (this._lazyCallQueue[t2].deferred.reject(v.connectionRequired), this._lazyCallQueue.splice(t2, 1));
  }, e2.prototype.cancel = function(e3) {
    this._logger.debug("cancel api request", e3), this.commandRouter.cancel(e3);
  }, e2.prototype.cancelAll = function() {
    this._logger.debug("cancel all api requests"), this.commandRouter.cancelAll();
  }, e2;
}();
var Ds = "sendbird@devicetokens";
var Rs = function() {
  function e2(e3) {
    var t2 = e3.type, n2 = e3.token, i2 = e3.device_os, r2 = e3.device_manufacturer, s2 = e3.system_push_enabled;
    this.type = t2, this.token = n2, this.deviceOS = i2, this.deviceManufacturer = r2, this.systemPushEnabled = s2;
  }
  return e2.payloadify = function(e3) {
    return re(se({ type: e3.type, token: e3.token, device_os: e3.deviceOS, device_manufacturer: e3.deviceManufacturer, system_push_enabled: e3.systemPushEnabled }));
  }, e2;
}();
var Ls = /* @__PURE__ */ new WeakMap();
var xs = function(e2) {
  function n2(t2) {
    var n3 = t2._iid, i2 = t2.session, r2 = t2.cacheContext, s2 = t2.sdkState, o2 = t2.dispatcher, a2 = t2.requestQueue, c2 = t2.logger, u2 = t2.pushNotificationAckManager, l2 = e2.call(this) || this;
    return l2._currentConnectionStateType = Sr.INITIALIZED, l2._isRefreshingAuthToken = false, l2.currentUser = null, l2.session = i2, l2._iid = n3, l2._cacheContext = r2, l2._sdkState = s2, l2._dispatcher = o2, l2._requestQueue = a2, l2._logger = c2, l2._pushNotificationAckManager = u2, l2._deviceTokens = [], l2._dispatcher.on(function(e3) {
      var t3, n4, i3;
      if (e3 instanceof kr) {
        var r3 = e3.stateType;
        l2._currentConnectionStateType = r3;
      } else if (e3 instanceof Me && l2.handler && !l2.isSessionKeyRefreshing) {
        if (l2._currentConnectionStateType === Sr.CONNECTING) return;
        (null === (t3 = e3.error) || void 0 === t3 ? void 0 : t3.isSessionInvalidatedError) ? l2.close() : ((null === (n4 = e3.error) || void 0 === n4 ? void 0 : n4.isSessionTokenExpiredError) && l2.refreshAuthToken().catch(function(e4) {
          if (g(e4) && "foreground" === l2._sdkState.appState) throw e4;
        }), (null === (i3 = e3.error) || void 0 === i3 ? void 0 : i3.isSessionKeyExpiredError) && (l2._logger.debug("session expired"), l2.handler.onSessionExpired && l2.handler.onSessionExpired(), l2.refreshSessionKey().catch(function(e4) {
          if (g(e4) && "foreground" === l2._sdkState.appState) throw e4;
        })));
      }
    }), l2;
  }
  return t(n2, e2), Object.defineProperty(n2.prototype, "ekey", { get: function() {
    return Ls.get(this);
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "deviceTokens", { get: function() {
    return this._deviceTokens;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "deviceTokenLastDeletedAt", { get: function() {
    return this._deviceTokenLastDeletedAt;
  }, enumerable: false, configurable: true }), n2.prototype.indexOfDeviceToken = function(e3, t2) {
    return this._deviceTokens.findIndex(function(n3) {
      return n3.type === e3 && n3.token === t2;
    });
  }, n2.prototype.hasDeviceToken = function(e3, t2) {
    return this.indexOfDeviceToken(e3, t2) >= 0;
  }, n2.prototype.createRefreshWebsocketCommand = function(e3, t2) {
    return new He({ authToken: e3, expiringSession: true, requestId: t2 });
  }, n2.prototype._refreshSessionKeyByWebSocket = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n3, i2, r2, o2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return t2 = this.createRefreshWebsocketCommand(e3), [4, this._requestQueue.forceSend(t2)];
          case 1:
            if (n3 = s2.sent(), i2 = n3.as(Ge), r2 = i2.newKey, o2 = i2.error) throw o2;
            return this.session.sessionKey = null != r2 ? r2 : this.session.sessionKey, [2];
        }
      });
    });
  }, n2.prototype._refreshSessionKeyByApi = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n3 = this;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return t2 = new Ve({ userId: this._sdkState.userId, authToken: e3, services: this.session.services && this.session.services.length > 0 ? this.session.services : void 0, expiringSession: true }), [4, _s(function(e4) {
              return r(n3, void 0, void 0, function() {
                var n4, i3, r2, o2, a2;
                return s(this, function(s2) {
                  switch (s2.label) {
                    case 0:
                      return s2.trys.push([0, 2, , 3]), [4, this._requestQueue.forceSend(t2)];
                    case 1:
                      return n4 = s2.sent(), i3 = n4.as(ze), r2 = i3.key, o2 = i3.services, this.session.sessionKey = r2, this.session.services = o2, [3, 3];
                    case 2:
                      if (a2 = s2.sent(), !this._isSessionRelatedError(a2)) throw a2;
                      return e4(a2), [3, 3];
                    case 3:
                      return [2];
                  }
                });
              });
            }, 3)];
          case 1:
            return i2.sent(), [2];
        }
      });
    });
  }, n2.prototype._refreshSessionKey = function(e3, t2) {
    return void 0 === t2 && (t2 = true), r(this, void 0, void 0, function() {
      var n3, i2;
      return s(this, function(r2) {
        switch (r2.label) {
          case 0:
            if (this._currentConnectionStateType !== Sr.CONNECTED) return [3, 8];
            r2.label = 1;
          case 1:
            return r2.trys.push([1, 3, , 8]), [4, this._refreshSessionKeyByWebSocket(e3)];
          case 2:
            return r2.sent(), this.complete(), [2];
          case 3:
            n3 = r2.sent(), r2.label = 4;
          case 4:
            return r2.trys.push([4, 6, , 7]), [4, this._handleSessionRefreshError(n3, t2)];
          case 5:
            return r2.sent(), [2];
          case 6:
            return r2.sent(), [3, 7];
          case 7:
            return [3, 8];
          case 8:
            return r2.trys.push([8, 10, , 12]), [4, this._refreshSessionKeyByApi(e3)];
          case 9:
            return r2.sent(), this.complete(), [3, 12];
          case 10:
            return i2 = r2.sent(), [4, this._handleSessionRefreshError(i2, t2)];
          case 11:
            return r2.sent(), [3, 12];
          case 12:
            return [2];
        }
      });
    });
  }, n2.prototype._receiveNewAuthToken = function() {
    var e3, t2 = this, n3 = new et();
    if (this._isRefreshingAuthToken = true, this.session.sessionKey = void 0, this.session.authToken = void 0, null === (e3 = this.handler) || void 0 === e3 ? void 0 : e3.onSessionTokenRequired) {
      var i2 = null, o2 = function() {
        i2 && (clearTimeout(i2), i2 = null);
      }, a2 = function(e4) {
        o2(), t2._isRefreshingAuthToken && (t2._isRefreshingAuthToken = false, n3.resolve(e4));
      }, c2 = function(e4) {
        o2(), t2._isRefreshingAuthToken && (t2._isRefreshingAuthToken = false, n3.reject(e4));
      };
      i2 = setTimeout(function() {
        return c2();
      }, 1e3 * this._sdkState.sessionTokenRefreshTimeout), os(function() {
        return r(t2, void 0, void 0, function() {
          var e4;
          return s(this, function(t3) {
            return (null === (e4 = this.handler) || void 0 === e4 ? void 0 : e4.onSessionTokenRequired) && this.handler.onSessionTokenRequired(a2, c2), [2];
          });
        });
      });
    } else n3.resolve(null);
    return n3.promise;
  }, n2.prototype._handleSessionRefreshError = function(e3, t2) {
    return void 0 === t2 && (t2 = false), r(this, void 0, void 0, function() {
      var n3;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return e3 instanceof v && (e3.isSessionTokenExpiredError || e3.code === u.APPLICATION_NOT_FOUND) ? (this.session.authToken = void 0, t2 ? [4, this._receiveNewAuthToken()] : [3, 6]) : [3, 6];
          case 1:
            return (n3 = i2.sent()) ? (this.session.authToken = n3, [4, this._refreshSessionKey(this.session.authToken, false)]) : [3, 3];
          case 2:
            return i2.sent(), [3, 5];
          case 3:
            return [4, this.clear()];
          case 4:
            i2.sent(), i2.label = 5;
          case 5:
            return [2];
          case 6:
            throw e3;
        }
      });
    });
  }, n2.prototype._isSessionRelatedError = function(e3) {
    return e3 instanceof v && (e3.isSessionExpiredError || e3.isSessionInvalidatedError);
  }, Object.defineProperty(n2.prototype, "isSessionKeyRefreshing", { get: function() {
    return this.session.isRefreshing;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isRefreshingAuthToken", { get: function() {
    return this._isRefreshingAuthToken;
  }, enumerable: false, configurable: true }), Object.defineProperty(n2.prototype, "isSessionExpiring", { get: function() {
    return !!this.handler;
  }, enumerable: false, configurable: true }), n2.prototype.authenticate = function(e3, t2) {
    var n3;
    return r(this, void 0, void 0, function() {
      var i2, r2, o2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return this.session.authToken = t2, i2 = new Ns({ appId: this._sdkState.appId, userId: e3, includeUIKitConfig: !!(null !== (n3 = this._sdkState.extensions) && void 0 !== n3 ? n3 : {}).sb_uikit, localCacheEnabled: this._cacheContext.localCacheEnabled, expiringSession: !t2 || this.isSessionExpiring }), [4, this._requestQueue.commandRouter.send(i2)];
          case 1:
            return r2 = s2.sent(), (o2 = r2.as(Cs).logi).error ? [3, 4] : this.session.hasChatServicePermission ? [3, 3] : [4, o2.applyTo(this._iid)];
          case 2:
            s2.sent(), s2.label = 3;
          case 3:
            return [3, 5];
          case 4:
            throw o2.error;
          case 5:
            return [2];
        }
      });
    });
  }, n2.prototype.login = function(e3) {
    var t2;
    return r(this, void 0, void 0, function() {
      var n3, i2, r2, o2, a2, c2, u2, l2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return n3 = e3.key, i2 = e3.ekey, r2 = e3.services, o2 = e3.userProfile, a2 = e3.deviceTokenLastDeletedAt, c2 = void 0 === a2 ? 0 : a2, this.session.sessionKey = n3, this.session.services = r2, Ls.set(this, i2), this._deviceTokenCacheEnabled = null === (t2 = null == o2 ? void 0 : o2.appInfo) || void 0 === t2 ? void 0 : t2.deviceTokenCache, u2 = this._cacheContext.preference, this._deviceTokenCacheEnabled ? [4, u2.get(Ds)] : [3, 5];
          case 1:
            return !(l2 = s2.sent()) || l2.lastDeletedAt < c2 ? (this._deviceTokens = [], this._deviceTokenLastDeletedAt = c2, [4, this.saveDeviceToken()]) : [3, 3];
          case 2:
            return s2.sent(), [3, 4];
          case 3:
            this._deviceTokens = l2.tokens.map(function(e4) {
              return new Rs(Rs.payloadify(e4));
            }), this._deviceTokenLastDeletedAt = l2.lastDeletedAt, s2.label = 4;
          case 4:
            return [3, 7];
          case 5:
            return [4, u2.remove(Ds)];
          case 6:
            s2.sent(), s2.label = 7;
          case 7:
            return [2];
        }
      });
    });
  }, n2.prototype.complete = function() {
    var e3 = this;
    this.dispatch("refresh"), this._dispatcher.dispatch(new Or()), os(function() {
      return r(e3, void 0, void 0, function() {
        var e4;
        return s(this, function(t2) {
          return this._logger.debug("session refreshed"), (null === (e4 = this.handler) || void 0 === e4 ? void 0 : e4.onSessionRefreshed) && this.handler.onSessionRefreshed(), [2];
        });
      });
    });
  }, n2.prototype.error = function(e3) {
    var t2 = this;
    os(function() {
      return r(t2, void 0, void 0, function() {
        var t3;
        return s(this, function(n3) {
          return (null === (t3 = this.handler) || void 0 === t3 ? void 0 : t3.onSessionError) && this.handler.onSessionError(e3), [2];
        });
      });
    });
  }, n2.prototype.close = function() {
    var e3 = this;
    this.dispatch("close"), this._dispatcher.dispatch(new Rr()), os(function() {
      return r(e3, void 0, void 0, function() {
        var e4;
        return s(this, function(t2) {
          return this._logger.debug("session closed"), (null === (e4 = this.handler) || void 0 === e4 ? void 0 : e4.onSessionClosed) && this.handler.onSessionClosed(), [2];
        });
      });
    });
  }, n2.prototype.refreshAuthToken = function() {
    return r(this, void 0, void 0, function() {
      var e3, t2;
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            if (e3 = null, !this.isSessionExpiring || this.session.isRefreshing) return [3, 9];
            this.session.isRefreshing = true, n3.label = 1;
          case 1:
            return n3.trys.push([1, 7, 8, 9]), [4, this._receiveNewAuthToken()];
          case 2:
            return (e3 = n3.sent()) ? (this._logger.debug("session refreshing.."), this.session.authToken = e3, [4, this._refreshSessionKey(this.session.authToken)]) : [3, 4];
          case 3:
            return n3.sent(), [3, 6];
          case 4:
            return [4, this.clear()];
          case 5:
            n3.sent(), n3.label = 6;
          case 6:
            return [3, 9];
          case 7:
            throw n3.sent(), t2 = e3 ? v.sessionTokenRefreshFailed : v.sessionTokenRequestFailed, this._dispatcher.dispatch(new Dr()), this.error(t2), this._logger.debug("refresh auth token error = ", t2), t2;
          case 8:
            return this.session.isRefreshing = false, [7];
          case 9:
            return [2];
        }
      });
    });
  }, n2.prototype.refreshSessionKey = function() {
    return r(this, void 0, void 0, function() {
      var e3;
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            if (!this.isSessionExpiring || this.session.isRefreshing) return [3, 5];
            this.session.isRefreshing = true, t2.label = 1;
          case 1:
            return t2.trys.push([1, 3, 4, 5]), [4, this._refreshSessionKey(this.session.authToken)];
          case 2:
            return t2.sent(), [3, 5];
          case 3:
            throw t2.sent(), e3 = v.sessionTokenRefreshFailed, this._dispatcher.dispatch(new Dr()), this.error(e3), e3;
          case 4:
            return this.session.isRefreshing = false, [7];
          case 5:
            return [2];
        }
      });
    });
  }, n2.prototype.setDeviceToken = function(e3, t2, n3) {
    if (this._deviceTokenCacheEnabled && this.indexOfDeviceToken(e3, t2) < 0) {
      var i2 = new Rs({ type: e3, token: t2, device_os: null == n3 ? void 0 : n3.deviceOS, device_manufacturer: null == n3 ? void 0 : n3.deviceManufacturer, system_push_enabled: null == n3 ? void 0 : n3.systemPushEnabled });
      return this._deviceTokens.push(i2), true;
    }
    return false;
  }, n2.prototype.unsetDeviceToken = function(e3, t2) {
    if (this._deviceTokenCacheEnabled) {
      var n3 = this.indexOfDeviceToken(e3, t2);
      n3 >= 0 && this._deviceTokens.splice(n3, 1);
    }
  }, n2.prototype.unsetDeviceTokens = function(e3) {
    this._deviceTokenCacheEnabled && (this._deviceTokens = e3 ? this._deviceTokens.filter(function(t2) {
      return t2.type !== e3;
    }) : []);
  }, n2.prototype.setDeviceTokenDeletedAt = function(e3) {
    e3 > 0 && (this._deviceTokenLastDeletedAt = e3);
  }, n2.prototype.saveDeviceToken = function() {
    return r(this, void 0, void 0, function() {
      return s(this, function(e3) {
        switch (e3.label) {
          case 0:
            return this._deviceTokenCacheEnabled ? [4, this._cacheContext.preference.set(Ds, { tokens: this._deviceTokens, lastDeletedAt: this._deviceTokenLastDeletedAt })] : [3, 2];
          case 1:
            e3.sent(), e3.label = 2;
          case 2:
            return [2];
        }
      });
    });
  }, n2.prototype.clear = function() {
    return r(this, void 0, void 0, function() {
      return s(this, function(e3) {
        switch (e3.label) {
          case 0:
            return this.currentUser = null, this.session.clear(), this.close(), Ls.delete(this), this._deviceTokens = [], this._deviceTokenLastDeletedAt = 0, [4, this.saveDeviceToken()];
          case 1:
            return e3.sent(), this._pushNotificationAckManager.clear(), [2];
        }
      });
    });
  }, n2;
}(te);
var Us = function(e2, t2) {
  var n2, i2;
  if (null !== e2 && null !== t2) {
    var r2 = Object.keys(e2), s2 = Object.keys(t2), u2 = c([], a(new Set(c(c([], a(r2), false), a(s2), false))), false), l2 = {};
    try {
      for (var h2 = o(u2), d2 = h2.next(); !d2.done; d2 = h2.next()) {
        var _2 = d2.value, f2 = typeof e2[_2], p2 = typeof t2[_2];
        "undefined" === f2 ? l2[_2] = t2[_2] : "undefined" === p2 ? l2[_2] = e2[_2] : f2 !== p2 ? l2[_2] = t2[_2] : "object" === f2 && e2[_2] && t2[_2] ? l2[_2] = Us(e2[_2], t2[_2]) : l2[_2] = t2[_2];
      }
    } catch (e3) {
      n2 = { error: e3 };
    } finally {
      try {
        d2 && !d2.done && (i2 = h2.return) && i2.call(h2);
      } finally {
        if (n2) throw n2.error;
      }
    }
    return l2;
  }
  return t2;
};
!function(e2) {
  e2[e2.PENDING = 0] = "PENDING", e2[e2.COLLECT_ONLY = 1] = "COLLECT_ONLY", e2[e2.ENABLED = 2] = "ENABLED", e2[e2.DISABLED = 3] = "DISABLED";
}(As || (As = {})), function(e2) {
  e2.DAILY = "daily", e2.DEFAULT = "default", e2.REALTIME = "realtime";
}(Is || (Is = {}));
var Ps;
var Ms = function(e2) {
  function n2(t2) {
    var n3 = t2.deviceId, i2 = t2.statLogs, r2 = e2.call(this) || this;
    return r2.method = oe.POST, r2.path = "".concat(we), r2.params = { device_id: n3, log_entries: i2.map(function(e3) {
      return Ze.payloadify(e3);
    }) }, r2;
  }
  return t(n2, e2), n2;
}(xe);
var Fs = function() {
  function e2(e3) {
    var t2 = e3.deviceId, n2 = e3.cacheContext, i2 = e3.requestQueue;
    this.queue = [], this.flushWaitQueue = [], this.enabledState = As.PENDING, this.isFlushing = false, this._sentLogStats = [], this.deviceId = t2, this.cacheContext = n2, this.requestQueue = i2, this.logInfo = { deviceId: t2, statLogs: [], generation: 1, lastFlushedAt: 0 }, this.limit = 100;
  }
  return Object.defineProperty(e2.prototype, "isEnabled", { get: function() {
    return this.enabledState === As.ENABLED;
  }, enumerable: false, configurable: true }), e2.prototype.init = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return this.key = e3, [4, this.cacheContext.preference.get(this.key)];
          case 1:
            return (t2 = n2.sent()) && (this.logInfo = t2), [2];
        }
      });
    });
  }, e2.prototype._mergeQueue = function() {
    this.flushWaitQueue.length > 0 && (this.queue = this.queue.concat(this.flushWaitQueue), this.flushWaitQueue = []);
  }, e2.prototype._isDuplicateStat = function(e3) {
    var t2 = this._sentLogStats.find(function(t3) {
      var n2;
      return t3.channelUrl === e3.data.channel_url && t3.messageId === (null !== (n2 = e3.data.notificationId) && void 0 !== n2 ? n2 : e3.data.message_id) && t3.action === e3.data.action;
    });
    return t2 || this._sentLogStats.push({ channelUrl: e3.data.channel_url, messageId: e3.data.message_id, action: e3.data.action }), !!t2;
  }, e2.prototype._flush = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n2, i2, r2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            if (t2 = true, !(e3.length > 0)) return [3, 10];
            if (this.isFlushing) return [3, 9];
            this.isFlushing = true, s2.label = 1;
          case 1:
            return s2.trys.push([1, 4, 8, 9]), n2 = c([], a(e3), false).slice(0, Math.min(this.limit, this.statConfig.maxStatCountPerRequest)), i2 = new Ms({ deviceId: this.deviceId, statLogs: n2 }), [4, this.requestQueue.send(i2)];
          case 2:
            return s2.sent(), this.queue = c([], a(e3), false).slice(n2.length).concat(this.flushWaitQueue), this.flushWaitQueue = [], this.limit = 100, this.logInfo.lastFlushedAt = Date.now(), [4, this._save()];
          case 3:
            return s2.sent(), [3, 9];
          case 4:
            return (r2 = s2.sent()) instanceof v ? r2.code !== u.NON_AUTHORIZED ? [3, 6] : [4, this.clear()] : [3, 7];
          case 5:
            return s2.sent(), this.enabledState = As.DISABLED, [3, 7];
          case 6:
            r2.code === u.STAT_UPLOAD_NOT_ALLOWED && (this.enabledState = As.COLLECT_ONLY), s2.label = 7;
          case 7:
            return this.limit = this.limit + 20, t2 = false, [3, 9];
          case 8:
            return this.isFlushing = false, [7];
          case 9:
            return [3, 11];
          case 10:
            this.isFlushing = false, s2.label = 11;
          case 11:
            return [2, t2];
        }
      });
    });
  }, e2.prototype._save = function() {
    return r(this, void 0, void 0, function() {
      var e3;
      return s(this, function(t2) {
        switch (t2.label) {
          case 0:
            return e3 = c(c([], a(this.queue), false), a(this.flushWaitQueue), false), [4, this.cacheContext.preference.set(this.key, { deviceId: this.logInfo.deviceId, statLogs: e3.map(function(e4) {
              return Ze.payloadify(e4);
            }), generation: this.logInfo.generation++, lastFlushedAt: this.logInfo.lastFlushedAt })];
          case 1:
            return t2.sent(), [2];
        }
      });
    });
  }, e2.prototype.clear = function() {
    return r(this, void 0, void 0, function() {
      return s(this, function(e3) {
        return this.queue = [], this.flushWaitQueue = [], this.logInfo.generation = 1, this._save(), [2];
      });
    });
  }, e2;
}();
var qs = function(e2) {
  function n2(t2) {
    var n3, i2, r2, s2, o2 = t2.type, a2 = t2.data, c2 = t2.ts, u2 = void 0 === c2 ? Date.now() : c2, l2 = e2.call(this, { type: o2, data: a2, ts: u2 }) || this;
    return l2.date = new Date(u2), l2.key = "".concat((n3 = l2.date, i2 = n3.getFullYear(), r2 = String(n3.getMonth() + 1).padStart(2, "0"), s2 = String(n3.getDate()).padStart(2, "0"), "".concat(i2).concat(r2).concat(s2)), "_").concat(o2), l2;
  }
  return t(n2, e2), n2;
}(Ze);
var Vs = function(e2) {
  function n2(t2) {
    var n3 = t2.deviceId, i2 = t2.cacheContext, r2 = t2.requestQueue;
    return e2.call(this, { deviceId: n3, cacheContext: i2, requestQueue: r2 }) || this;
  }
  return t(n2, e2), Object.defineProperty(n2.prototype, "_isSendable", { get: function() {
    return 0 !== this.queue.length && Date.now() - this.logInfo.lastFlushedAt >= this.statConfig.minInterval;
  }, enumerable: false, configurable: true }), n2.prototype.init = function(t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(n3) {
        switch (n3.label) {
          case 0:
            return [4, e2.prototype.init.call(this, t2 + ".daily")];
          case 1:
            return n3.sent(), this.queue = this.logInfo.statLogs.map(function(e3) {
              return new Ze({ type: e3.stat_type, ts: e3.ts, data: e3.data });
            }), [2];
        }
      });
    });
  }, n2.prototype.setConfig = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n3, i2, r2, o2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return this.statConfig = e3, this.statConfig.minInterval = 864e5, this._mergeQueue(), t2.localCacheStat ? (this.enabledState = t2.enabledStat ? As.ENABLED : As.COLLECT_ONLY, [3, 3]) : [3, 1];
          case 1:
            return this.enabledState = As.DISABLED, [4, this.clear()];
          case 2:
            s2.sent(), s2.label = 3;
          case 3:
            return this.isEnabled && this._isSendable ? [4, this._getUploadStats()] : [3, 9];
          case 4:
            n3 = s2.sent(), i2 = Math.max(Math.floor(Math.random() * this.statConfig.requestDelayRange), 100), r2 = 0, s2.label = 5;
          case 5:
            return r2 < n3.length ? (o2 = n3.slice(r2, 1 + this.statConfig.maxStatCountPerRequest), [4, hs(i2)]) : [3, 9];
          case 6:
            return s2.sent(), [4, this._flush(o2)];
          case 7:
            s2.sent(), s2.label = 8;
          case 8:
            return r2 += this.statConfig.maxStatCountPerRequest, [3, 5];
          case 9:
            return [2];
        }
      });
    });
  }, n2.prototype.put = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, n3, i2, r2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return this.enabledState === As.DISABLED ? [2, true] : (t2 = this.enabledState === As.PENDING || this.isFlushing ? this.flushWaitQueue : this.queue, n3 = a(t2.filter(function(t3) {
              return t3 instanceof qs && t3.key === e3.key;
            }), 1), (i2 = n3[0]) ? i2.data = Us(i2.data, e3.data) : t2.push(e3), this.enabledState === As.PENDING ? [3, 2] : [4, this._save()]);
          case 1:
            s2.sent(), s2.label = 2;
          case 2:
            return this.isEnabled ? (this._mergeQueue(), this._isSendable ? [4, this._getUploadStats()] : [3, 5]) : [3, 5];
          case 3:
            return r2 = s2.sent(), [4, this._flush(r2)];
          case 4:
            return [2, s2.sent()];
          case 5:
            return [2, true];
        }
      });
    });
  }, n2.prototype._getUploadStats = function() {
    return r(this, void 0, void 0, function() {
      var e3;
      return s(this, function(t2) {
        return e3 = this.queue.filter(function(e4) {
          if (e4 instanceof qs) {
            var t3 = /* @__PURE__ */ new Date(), n3 = a([e4.date.getFullYear(), t3.getFullYear()], 2), i2 = n3[0], r2 = n3[1];
            if (i2 < r2) return true;
            if (i2 === r2) {
              var s2 = a([e4.date.getMonth(), t3.getMonth()], 2), o2 = s2[0], c2 = s2[1];
              if (o2 < c2) return true;
              if (o2 === c2) {
                var u2 = a([e4.date.getDate(), t3.getDate()], 2);
                return u2[0] < u2[1];
              }
            }
          }
          return false;
        }), [2, e3];
      });
    });
  }, n2;
}(Fs);
var Hs = function(e2) {
  function i2(t2) {
    var n2 = t2.deviceId, i3 = t2.cacheContext, r2 = t2.requestQueue;
    return e2.call(this, { deviceId: n2, cacheContext: i3, requestQueue: r2 }) || this;
  }
  return t(i2, e2), i2.prototype._isSendable = function(e3) {
    if (void 0 === e3 && (e3 = false), this.queue.length < this.statConfig.lowerThreshold) return false;
    if (e3) {
      if (Date.now() - this.logInfo.lastFlushedAt < this.statConfig.minInterval) return false;
    } else if (this.queue.length < this.statConfig.minStatCount) return false;
    return true;
  }, i2.prototype._filterQueueByType = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(n2) {
        return [2, t2 ? e3.filter(function(e4) {
          return e4.type !== Le.FEATURE_LOCALCACHE_EVENT;
        }) : e3.filter(function(e4) {
          return e4.type === Le.FEATURE_LOCALCACHE_EVENT;
        })];
      });
    });
  }, i2.prototype.init = function(t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(i3) {
        switch (i3.label) {
          case 0:
            return [4, e2.prototype.init.call(this, t2 + ".default")];
          case 1:
            return i3.sent(), this.queue = this.logInfo.statLogs.map(function(e3) {
              return e3.data = n({ message_init_policy: "", starting_point: 0 }, e3.data), new Ze({ type: e3.stat_type, ts: e3.ts, data: e3.data });
            }), [2];
        }
      });
    });
  }, i2.prototype.setConfig = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n2, i3, r2, o2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return this.statConfig = e3, this._mergeQueue(), t2.requestStat || t2.localCacheStat ? (this.enabledState = t2.enabledStat ? As.ENABLED : As.COLLECT_ONLY, n2 = void 0, t2.requestStat || (n2 = false), t2.localCacheStat || (n2 = true), void 0 === n2 ? [3, 3] : (i3 = this, [4, this._filterQueueByType(this.queue, n2)])) : [3, 4];
          case 1:
            return i3.queue = s2.sent(), r2 = this, [4, this._filterQueueByType(this.flushWaitQueue, n2)];
          case 2:
            r2.flushWaitQueue = s2.sent(), this._save(), s2.label = 3;
          case 3:
            return [3, 6];
          case 4:
            return this.enabledState = As.DISABLED, [4, this.clear()];
          case 5:
            s2.sent(), s2.label = 6;
          case 6:
            return this.isEnabled && this._isSendable(true) ? (o2 = Math.max(Math.floor(Math.random() * this.statConfig.requestDelayRange), 100), [4, hs(o2)]) : [3, 9];
          case 7:
            return s2.sent(), [4, this._flush(this.queue)];
          case 8:
            s2.sent(), s2.label = 9;
          case 9:
            return [2];
        }
      });
    });
  }, i2.prototype.put = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return this.enabledState === As.DISABLED ? [2, true] : ((t2 = this.enabledState === As.PENDING || this.isFlushing ? this.flushWaitQueue : this.queue).push(e3), this.enabledState === As.PENDING ? [3, 2] : [4, this._save()]);
          case 1:
            n2.sent(), n2.label = 2;
          case 2:
            return this.isEnabled ? (this._mergeQueue(), this._isSendable() ? [4, this._flush(t2)] : [3, 4]) : [3, 4];
          case 3:
            return [2, n2.sent()];
          case 4:
            return [2, true];
        }
      });
    });
  }, i2;
}(Fs);
var zs = function(e2) {
  function i2(t2) {
    var n2 = t2.deviceId, i3 = t2.cacheContext, r2 = t2.requestQueue;
    return e2.call(this, { deviceId: n2, cacheContext: i3, requestQueue: r2 }) || this;
  }
  return t(i2, e2), Object.defineProperty(i2.prototype, "_isSendable", { get: function() {
    return this.queue.length >= this.statConfig.minStatCount && this.queue.length > this.statConfig.lowerThreshold || this.logInfo.lastFlushedAt > 0 && Date.now() - this.logInfo.lastFlushedAt >= this.statConfig.minInterval;
  }, enumerable: false, configurable: true }), i2.prototype.init = function(t2) {
    return r(this, void 0, void 0, function() {
      return s(this, function(i3) {
        switch (i3.label) {
          case 0:
            return [4, e2.prototype.init.call(this, t2 + ".realtime")];
          case 1:
            return i3.sent(), this.queue = this.logInfo.statLogs.map(function(e3) {
              var t3;
              return e3.data = re(n(n({}, e3.data), { message_id: null !== (t3 = e3.data.notificationId) && void 0 !== t3 ? t3 : e3.data.message_id, notificationId: void 0 })), new Ze({ type: e3.stat_type, ts: e3.ts, data: e3.data });
            }), this._sentLogStats = this.queue.map(function(e3) {
              var t3;
              return { channelUrl: e3.data.channelUrl, messageId: null !== (t3 = e3.data.notificationId) && void 0 !== t3 ? t3 : e3.data.message_id, action: e3.data.action };
            }), [2];
        }
      });
    });
  }, i2.prototype.setConfig = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n2;
      return s(this, function(i3) {
        switch (i3.label) {
          case 0:
            return this.statConfig = e3, this._mergeQueue(), t2.notificationStat ? (this.enabledState = t2.enabledStat ? As.ENABLED : As.COLLECT_ONLY, [3, 3]) : [3, 1];
          case 1:
            return this.enabledState = As.DISABLED, [4, this.clear()];
          case 2:
            i3.sent(), i3.label = 3;
          case 3:
            return this.isEnabled && this._isSendable ? (n2 = Math.max(Math.floor(Math.random() * this.statConfig.requestDelayRange), 100), [4, hs(n2)]) : [3, 6];
          case 4:
            return i3.sent(), [4, this._flush(this.queue)];
          case 5:
            i3.sent(), i3.label = 6;
          case 6:
            return [2];
        }
      });
    });
  }, i2.prototype.put = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return this.enabledState === As.DISABLED ? [2, true] : (t2 = this.enabledState === As.PENDING || this.isFlushing ? this.flushWaitQueue : this.queue, this._isDuplicateStat(e3) ? [2, true] : (t2.push(e3), this.enabledState === As.PENDING ? [3, 2] : [4, this._save()]));
          case 1:
            n2.sent(), n2.label = 2;
          case 2:
            return this.isEnabled ? (this._mergeQueue(), this.isEnabled && this._isSendable ? [4, this._flush(t2)] : [3, 4]) : [3, 4];
          case 3:
            return [2, n2.sent()];
          case 4:
            return [2, true];
        }
      });
    });
  }, i2;
}(Fs);
var Gs = function() {
  function e2(e3) {
    var t2 = e3.cacheContext, n2 = e3.requestQueue, i2 = e3.dispatcher, r2 = e3.logger;
    this._collectRequestStat = true, this._collectFeatureLocalCacheStat = true, this._collectionNotificationStat = true, this._retryCount = 0, this.deviceId = $(), this.cacheContext = t2, this.requestQueue = n2, this.dispatcher = i2, this.logger = r2, this._dailyStatCollector = new Vs({ deviceId: this.deviceId, cacheContext: this.cacheContext, requestQueue: this.requestQueue }), this._defaultStatCollector = new Hs({ deviceId: this.deviceId, cacheContext: this.cacheContext, requestQueue: this.requestQueue }), this._realTimeStatCollector = new zs({ deviceId: this.deviceId, cacheContext: this.cacheContext, requestQueue: this.requestQueue });
  }
  return e2.prototype._migration = function() {
    return r(this, void 0, void 0, function() {
      var e3, t2, i2, r2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return [4, this.cacheContext.preference.get(this.key)];
          case 1:
            return (e3 = s2.sent()) ? (t2 = [], e3.statLogs.forEach(function(e4) {
              e4.stat_type === Le.FEATURE_LOCALCACHE && t2.push(new Ze({ type: e4.stat_type, ts: e4.ts, data: e4.data }));
            }), [4, this.cacheContext.preference.set(this.key + ".daily", { deviceId: e3.deviceId, statLogs: t2.map(function(e4) {
              return Ze.payloadify(e4);
            }), generation: e3.generation, lastFlushedAt: e3.lastFlushedAt })]) : [3, 6];
          case 2:
            return s2.sent(), i2 = [], e3.statLogs.forEach(function(e4) {
              e4.stat_type !== Le.FEATURE_LOCALCACHE && e4.stat_type !== Le.NOTIFICATION && (e4.stat_type === Le.FEATURE_LOCALCACHE_EVENT && (e4.data = n({ message_init_policy: "", starting_point: 0 }, e4.data)), i2.push(new Ze({ type: e4.stat_type, ts: e4.ts, data: e4.data })));
            }), [4, this.cacheContext.preference.set(this.key + ".default", { deviceId: e3.deviceId, statLogs: i2.map(function(e4) {
              return Ze.payloadify(e4);
            }), generation: e3.generation, lastFlushedAt: e3.lastFlushedAt })];
          case 3:
            return s2.sent(), r2 = [], e3.statLogs.forEach(function(e4) {
              var t3;
              e4.stat_type === Le.NOTIFICATION && (e4.data = re(n(n({}, e4.data), { message_id: null !== (t3 = e4.data.notificationId) && void 0 !== t3 ? t3 : e4.data.message_id, notificationId: void 0 })), r2.push(new Ze({ type: e4.stat_type, ts: e4.ts, data: e4.data })));
            }), [4, this.cacheContext.preference.set(this.key + ".realtime", { deviceId: e3.deviceId, statLogs: r2.map(function(e4) {
              return Ze.payloadify(e4);
            }), generation: e3.generation, lastFlushedAt: e3.lastFlushedAt })];
          case 4:
            return s2.sent(), [4, this.cacheContext.preference.remove(this.key)];
          case 5:
            s2.sent(), s2.label = 6;
          case 6:
            return [2];
        }
      });
    });
  }, e2.prototype.init = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2 = this;
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return this.key = e3, [4, this._migration()];
          case 1:
            return n2.sent(), [4, this._dailyStatCollector.init(this.key)];
          case 2:
            return n2.sent(), [4, this._defaultStatCollector.init(this.key)];
          case 3:
            return n2.sent(), [4, this._realTimeStatCollector.init(this.key)];
          case 4:
            return n2.sent(), this.commandEventContext || (this.commandEventContext = this.dispatcher.on(function(e4) {
              return r(t2, void 0, void 0, function() {
                var t3, n3, i2, r2, o2, a2;
                return s(this, function(s2) {
                  return e4 instanceof je ? (t3 = e4.statLog, this.put(t3)) : e4 instanceof is && (n3 = e4.request, i2 = e4.features, r2 = e4.options, o2 = e4.statConfigInfo, this._retryCount = 0, this._collectRequestStat = n3, this._collectFeatureLocalCacheStat = null == i2 ? void 0 : i2.localCache, this._collectionNotificationStat = null == i2 ? void 0 : i2.notification, this._statConfig = o2, this._dailyStatCollector.setConfig(this._statConfig.default, { localCacheStat: this._collectFeatureLocalCacheStat, enabledStat: r2.ingestion }), this._defaultStatCollector.setConfig(this._statConfig.default, { requestStat: this._collectRequestStat, localCacheStat: this._collectFeatureLocalCacheStat, enabledStat: r2.ingestion }), this._realTimeStatCollector.setConfig(null !== (a2 = this._statConfig.realTime) && void 0 !== a2 ? a2 : this._statConfig.default, { notificationStat: this._collectionNotificationStat, enabledStat: r2.ingestion })), [2];
                });
              });
            })), [2];
        }
      });
    });
  }, e2.prototype.put = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2;
      return s(this, function(n2) {
        switch (n2.label) {
          case 0:
            return t2 = true, e3 instanceof qs ? this._collectFeatureLocalCacheStat ? [4, this._dailyStatCollector.put(e3)] : [3, 2] : [3, 3];
          case 1:
            t2 = n2.sent(), n2.label = 2;
          case 2:
            return [3, 13];
          case 3:
            switch (e3.type) {
              case Le.API_RESULT:
              case Le.WEBSOCKET_CONNECT:
                return [3, 4];
              case Le.FEATURE_LOCALCACHE:
              case Le.FEATURE_LOCALCACHE_EVENT:
                return [3, 7];
              case Le.NOTIFICATION:
                return [3, 10];
            }
            return [3, 13];
          case 4:
            return this._collectRequestStat ? [4, this._defaultStatCollector.put(e3)] : [3, 6];
          case 5:
            t2 = n2.sent(), n2.label = 6;
          case 6:
            return [3, 13];
          case 7:
            return this._collectFeatureLocalCacheStat ? [4, this._defaultStatCollector.put(e3)] : [3, 9];
          case 8:
            t2 = n2.sent(), n2.label = 9;
          case 9:
            return [3, 13];
          case 10:
            return this._collectionNotificationStat ? [4, this._realTimeStatCollector.put(e3)] : [3, 12];
          case 11:
            t2 = n2.sent(), n2.label = 12;
          case 12:
            return [3, 13];
          case 13:
            return t2 ? this._retryCount = 0 : (this._retryCount++, this._retryCount > 20 && (this._dailyStatCollector.enabledState = As.COLLECT_ONLY, this._defaultStatCollector.enabledState = As.COLLECT_ONLY, this._realTimeStatCollector.enabledState = As.COLLECT_ONLY, this.logger.debug(v.statLogUploadLimitExceededError))), [2];
        }
      });
    });
  }, e2.prototype.close = function() {
    this.commandEventContext && (this.commandEventContext.close(), this.commandEventContext = void 0);
  }, e2;
}();
var js = function() {
  function e2(e3) {
    var t2 = e3.limit, n2 = void 0 === t2 ? 5 : t2;
    this.workersByKey = {}, this.limit = n2;
  }
  return e2.prototype.run = function(e3, t2) {
    return r(this, void 0, void 0, function() {
      var n2;
      return s(this, function(i2) {
        switch (i2.label) {
          case 0:
            return this.workersByKey[e3] || (this.workersByKey[e3] = []), this.workersByKey[e3].length < this.limit ? (this.workersByKey[e3].push(t2), [4, t2()]) : [3, 2];
          case 1:
            return n2 = i2.sent(), this.workersByKey[e3].pop(), [2, n2];
          case 2:
            throw v.tooManyRequests;
        }
      });
    });
  }, e2.prototype.clear = function(e3) {
    this.workersByKey[e3] = [];
  }, e2;
}();
!function(e2) {
  e2.DELIVERY_RECEIPT = "delivery_receipt", e2.PUSH_ACKNOWLEDGEMENT = "push_acknowledgement";
}(Ps || (Ps = {}));
var Ks;
var Bs = function(e2) {
  function n2() {
    var t2 = null !== e2 && e2.apply(this, arguments) || this;
    return t2._pushAckedCache = {}, t2;
  }
  return t(n2, e2), n2.prototype.isAcked = function(e3, t2) {
    var n3, i2 = "".concat(e3, "_").concat(t2);
    return null !== (n3 = this._pushAckedCache[i2]) && void 0 !== n3 && n3;
  }, n2.prototype.markAsAcked = function(e3, t2) {
    var n3 = "".concat(e3, "_").concat(t2);
    this._pushAckedCache[n3] = true;
  }, n2.prototype.clear = function() {
    Ws.of(this._iid).logger.debug("clear push acked cache"), this._pushAckedCache = {};
  }, n2.prototype.parseData = function(e3) {
    var t2, n3, i2, r2, s2 = Ws.of(this._iid).logger, o2 = e3.sendbird;
    if ("string" == typeof o2) try {
      o2 = JSON.parse(o2);
    } catch (e4) {
      throw s2.info("push notification payload does not contain sendbird payload in JSON format."), v.malformedDataError;
    }
    if (!o2 || "object" != typeof o2) throw s2.info("push notification payload does not contain sendbird payload in JSON format."), v.malformedDataError;
    var a2 = null !== (t2 = o2.push_tracking_id) && void 0 !== t2 ? t2 : "", c2 = o2.notification_message_id, u2 = o2.notification_channel_key, l2 = o2.notification_template_key, h2 = o2.notification_event_deadline, d2 = null !== (n3 = o2.session_key) && void 0 !== n3 ? n3 : {}, _2 = null !== (i2 = null == d2 ? void 0 : d2.key) && void 0 !== i2 ? i2 : "", f2 = null !== (r2 = null == d2 ? void 0 : d2.topics) && void 0 !== r2 ? r2 : [];
    if ("string" != typeof a2 || 0 === a2.length) throw s2.info("push tracking id is not available"), v.malformedDataError;
    if ("string" != typeof c2 || 0 === c2.length) throw s2.info("message id is not available"), v.malformedDataError;
    return { pushTrackingId: a2, sessionKey: _2, sessionTopics: f2, messageId: c2, channelKey: u2, templateKey: l2, notificationEventDeadline: h2 };
  }, n2;
}(zr);
var Qs = {};
var Ws = function() {
  function e2(e3, t2) {
    var n2, i2, r2, s2, o2, a2, c2, u2, l2;
    if (this.connectedAt = 0, this.firstConnectedAt = 0, this.connectionHandlers = /* @__PURE__ */ new Map(), this.userEventHandlers = /* @__PURE__ */ new Map(), !Qs[e3]) {
      Qs[e3] = this;
      var d2 = null !== (n2 = t2.options) && void 0 !== n2 ? n2 : new R(), _2 = this.sdkState = { appId: t2.appId, appVersion: null !== (i2 = t2.appVersion) && void 0 !== i2 ? i2 : "", appState: "foreground", userId: void 0, extensions: {}, api: { host: null !== (r2 = t2.apiHost) && void 0 !== r2 ? r2 : "https://api-".concat(t2.appId, ".sendbird.com") }, websocket: { host: null !== (s2 = t2.websocketHost) && void 0 !== s2 ? s2 : "wss://ws-".concat(t2.appId, ".sendbird.com"), pingerDisabled: !!t2.noPingpong, pingInterval: void 0, pongTimeout: void 0, connectMaxRetry: 2, compression: true, reconnectMaxRetry: -1, reconnectRetryStrategy: new ds(), responseTimeout: d2.websocketResponseTimeout }, sessionTokenRefreshTimeout: d2.sessionTokenRefreshTimeout };
      this.appInfo = void 0, this.subscribedUnreadMessageCount = { all: 0, feed: 0, customTypes: {}, ts: 0 };
      var f2 = this.logger = t2.logger;
      this.connectedAt = 0, this.firstConnectedAt = 0, this.connectionHandlers = /* @__PURE__ */ new Map(), this.userEventHandlers = /* @__PURE__ */ new Map();
      var p2 = this.cacheContext = new U({ encryption: t2.encryption, store: t2.store, localCacheEnabled: null !== (o2 = t2.localCacheEnabled) && void 0 !== o2 && o2, localCacheConfig: null !== (a2 = t2.localCacheConfig) && void 0 !== a2 ? a2 : new F() });
      this.debugMode = null !== (c2 = t2.debugMode) && void 0 !== c2 && c2, this.maxSuperGroupChannelUnreadCount = h.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL, this.useMemberInfoInMessage = d2.useMemberInfoInMessage, this.typingIndicatorInvalidateTime = d2.typingIndicatorInvalidateTime, this.typingIndicatorThrottle = d2.typingIndicatorThrottle, this.concurrentCallLimit = void 0, this.backOffDelay = void 0;
      var E2 = this.dispatcher = new ne(), g2 = new J();
      this.requestQueue = new Os(e3, { session: g2, sdkState: _2, dispatcher: E2, logger: f2, useFetchCompat: t2.useFetchCompat }), this.pushNotificationAckManager = new Bs(e3), this.sessionManager = new xs({ _iid: e3, session: g2, cacheContext: p2, sdkState: _2, dispatcher: E2, requestQueue: this.requestQueue, logger: f2, pushNotificationAckManager: this.pushNotificationAckManager }), this.connectionManager = new Es(e3, { sdkState: _2, cacheContext: this.cacheContext, connectionHandlers: this.connectionHandlers, dispatcher: E2, sessionManager: this.sessionManager, websocketClient: this.requestQueue.commandRouter.websocketClient, disableWebSocketCloseEventHandling: null !== (u2 = t2.disableWebSocketCloseEventHandling) && void 0 !== u2 && u2, logger: f2 }), this.statManager = new Gs({ cacheContext: this.cacheContext, requestQueue: this.requestQueue, dispatcher: this.dispatcher, logger: f2 }), this.appStateToggleEnabled = null === (l2 = t2.appStateToggleEnabled) || void 0 === l2 || l2, this.messageBackgroundSyncThrottleController = new js({ limit: 5 });
    }
    return Qs[e3];
  }
  return e2.of = function(e3) {
    if (Qs[e3]) return Qs[e3];
    throw v.lostInstance;
  }, e2.clear = function(e3) {
    Qs[e3] && delete Qs[e3];
  }, e2.prototype.hasExtension = function(e3) {
    return this.sdkState.extensions && this.sdkState.extensions[e3];
  }, e2;
}();
var Zs = function() {
  function e2() {
  }
  return e2.prototype.init = function(e3, t2) {
    var n2 = t2.sdkState, i2 = t2.dispatcher, r2 = t2.sessionManager, s2 = t2.requestQueue, o2 = t2.logger;
    t2.onlineDetector;
    var a2 = t2.cacheContext;
    this._iid = e3, this._cacheContext = a2, this._sdkState = n2, this._dispatcher = i2, this._sessionManager = r2, this._requestQueue = s2, this._logger = o2;
  }, e2;
}();
!function(e2) {
  e2.UNKNOWN = "UNKNOWN", e2.EVENT_CHANNEL_CREATED = "EVENT_CHANNEL_CREATED", e2.EVENT_CHANNEL_UPDATED = "EVENT_CHANNEL_UPDATED", e2.EVENT_CHANNEL_DELETED = "EVENT_CHANNEL_DELETED", e2.EVENT_CHANNEL_READ = "EVENT_CHANNEL_READ", e2.EVENT_CHANNEL_DELIVERED = "EVENT_CHANNEL_DELIVERED", e2.EVENT_CHANNEL_INVITED = "EVENT_CHANNEL_INVITED", e2.EVENT_CHANNEL_JOINED = "EVENT_CHANNEL_JOINED", e2.EVENT_CHANNEL_LEFT = "EVENT_CHANNEL_LEFT", e2.EVENT_CHANNEL_ACCEPTED_INVITE = "EVENT_CHANNEL_ACCEPTED_INVITE", e2.EVENT_CHANNEL_DECLINED_INVITE = "EVENT_CHANNEL_DECLINED_INVITE", e2.EVENT_CHANNEL_OPERATOR_UPDATED = "EVENT_CHANNEL_OPERATOR_UPDATED", e2.EVENT_CHANNEL_BANNED = "EVENT_CHANNEL_BANNED", e2.EVENT_CHANNEL_UNBANNED = "EVENT_CHANNEL_UNBANNED", e2.EVENT_CHANNEL_MUTED = "EVENT_CHANNEL_MUTED", e2.EVENT_CHANNEL_UNMUTED = "EVENT_CHANNEL_UNMUTED", e2.EVENT_CHANNEL_FROZEN = "EVENT_CHANNEL_FROZEN", e2.EVENT_CHANNEL_UNFROZEN = "EVENT_CHANNEL_UNFROZEN", e2.EVENT_CHANNEL_HIDDEN = "EVENT_CHANNEL_HIDDEN", e2.EVENT_CHANNEL_UNHIDDEN = "EVENT_CHANNEL_UNHIDDEN", e2.EVENT_CHANNEL_RESET_HISTORY = "EVENT_CHANNEL_RESET_HISTORY", e2.EVENT_CHANNEL_TYPING_STATUS_UPDATE = "EVENT_CHANNEL_TYPING_STATUS_UPDATE", e2.EVENT_CHANNEL_MEMBER_COUNT_UPDATED = "EVENT_CHANNEL_MEMBER_COUNT_UPDATED", e2.EVENT_CHANNEL_METADATA_CREATED = "EVENT_CHANNEL_METADATA_CREATED", e2.EVENT_CHANNEL_METADATA_UPDATED = "EVENT_CHANNEL_METADATA_UPDATED", e2.EVENT_CHANNEL_METADATA_DELETED = "EVENT_CHANNEL_METADATA_DELETED", e2.EVENT_CHANNEL_METACOUNTER_CREATED = "EVENT_CHANNEL_METACOUNTER_CREATED", e2.EVENT_CHANNEL_METACOUNTER_UPDATED = "EVENT_CHANNEL_METACOUNTER_UPDATED", e2.EVENT_CHANNEL_METACOUNTER_DELETED = "EVENT_CHANNEL_METACOUNTER_DELETED", e2.EVENT_MESSAGE_SENT = "EVENT_MESSAGE_SENT", e2.EVENT_MESSAGE_RECEIVED = "EVENT_MESSAGE_RECEIVED", e2.EVENT_MESSAGE_UPDATED = "EVENT_MESSAGE_UPDATED", e2.EVENT_PINNED_MESSAGE_UPDATED = "EVENT_PINNED_MESSAGE_UPDATED", e2.REQUEST_CHANNEL = "REQUEST_CHANNEL", e2.REQUEST_CHANNEL_CHANGELOGS = "REQUEST_CHANNEL_CHANGELOGS", e2.REFRESH_CHANNEL = "REFRESH_CHANNEL", e2.CHANNEL_LASTACCESSEDAT_UPDATED = "CHANNEL_LASTACCESSEDAT_UPDATED", e2.SYNC_CHANNEL_BACKGROUND = "SYNC_CHANNEL_BACKGROUND", e2.SYNC_CHANNEL_CHANGELOGS = "SYNC_CHANNEL_CHANGELOGS", e2.EVENT_MESSAGE_SENT_SUCCESS = "EVENT_MESSAGE_SENT_SUCCESS", e2.EVENT_MESSAGE_SENT_FAILED = "EVENT_MESSAGE_SENT_FAILED", e2.EVENT_MESSAGE_SENT_PENDING = "EVENT_MESSAGE_SENT_PENDING", e2.EVENT_MESSAGE_DELETED = "EVENT_MESSAGE_DELETED", e2.EVENT_MESSAGE_FEEDBACK_ADDED = "EVENT_MESSAGE_FEEDBACK_ADDED", e2.EVENT_MESSAGE_FEEDBACK_UPDATED = "EVENT_MESSAGE_FEEDBACK_UPDATED", e2.EVENT_MESSAGE_FEEDBACK_DELETED = "EVENT_MESSAGE_FEEDBACK_DELETED", e2.EVENT_MESSAGE_READ = "EVENT_MESSAGE_READ", e2.EVENT_MESSAGE_DELIVERED = "EVENT_MESSAGE_DELIVERED", e2.EVENT_MESSAGE_REACTION_UPDATED = "EVENT_MESSAGE_REACTION_UPDATED", e2.EVENT_MESSAGE_THREADINFO_UPDATED = "EVENT_MESSAGE_THREADINFO_UPDATED", e2.EVENT_MESSAGE_OFFSET_UPDATED = "EVENT_MESSAGE_OFFSET_UPDATED", e2.REQUEST_MESSAGE = "REQUEST_MESSAGE", e2.EVENT_THREAD_INFO_UPDATED = "EVENT_THREADINFO_UPDATED", e2.EVENT_POLL_UPDATED = "EVENT_POLL_UPDATED", e2.EVENT_POLL_VOTED = "EVENT_POLL_VOTED", e2.SYNC_POLL_CHANGELOGS = "SYNC_POLL_CHANGELOGS", e2.REQUEST_RESEND_MESSAGE = "REQUEST_RESEND_MESSAGE", e2.REQUEST_THREADED_MESSAGE = "REQUEST_THREADED_MESSAGE", e2.REQUEST_MESSAGE_CHANGELOGS = "REQUEST_MESSAGE_CHANGELOGS", e2.SYNC_MESSAGE_FILL = "SYNC_MESSAGE_FILL", e2.SYNC_MESSAGE_BACKGROUND = "SYNC_MESSAGE_BACKGROUND", e2.SYNC_MESSAGE_CHANGELOGS = "SYNC_MESSAGE_CHANGELOGS", e2.LOCAL_MESSAGE_PENDING_CREATED = "LOCAL_MESSAGE_PENDING_CREATED", e2.LOCAL_MESSAGE_FAILED = "LOCAL_MESSAGE_FAILED", e2.LOCAL_MESSAGE_CANCELED = "LOCAL_MESSAGE_CANCELED", e2.LOCAL_MESSAGE_RESEND_STARTED = "LOCAL_MESSAGE_RESEND_STARTED";
}(Ks || (Ks = {}));
var Ys;
var Xs = n({}, Ks);
var Js = function(e2) {
  return e2.startsWith("EVENT_") || e2.startsWith("LOCAL_MESSAGE_") || e2 === Ks.SYNC_MESSAGE_FILL || e2 === Ks.SYNC_MESSAGE_CHANGELOGS || e2 === Ks.SYNC_POLL_CHANGELOGS;
};
var $s = function(e2) {
  function n2(t2) {
    var n3 = t2.messages, i2 = t2.source, r2 = t2.isWebSocketEventComing, s2 = void 0 !== r2 && r2, o2 = e2.call(this) || this;
    return o2.messages = n3, o2.source = i2, o2.isWebSocketEventComing = s2, o2;
  }
  return t(n2, e2), n2;
}(ie);
var eo = function(e2) {
  function n2(t2) {
    var n3 = t2.messageIds, i2 = t2.source, r2 = t2.isWebSocketEventComing, s2 = void 0 !== r2 && r2, o2 = e2.call(this) || this;
    return o2.messageIds = n3, o2.source = i2, o2.isWebSocketEventComing = s2, o2;
  }
  return t(n2, e2), n2;
}(ie);
var to = function(e2) {
  function n2(t2) {
    var n3 = t2.event, i2 = t2.source, r2 = t2.isWebSocketEventComing, s2 = void 0 !== r2 && r2, o2 = e2.call(this) || this;
    return o2.event = n3, o2.source = i2, o2.isWebSocketEventComing = s2, o2;
  }
  return t(n2, e2), n2;
}(ie);
var no = function(e2) {
  function n2(t2) {
    var n3 = t2.event, i2 = t2.source, r2 = t2.isWebSocketEventComing, s2 = void 0 !== r2 && r2, o2 = e2.call(this) || this;
    return o2.event = n3, o2.source = i2, o2.isWebSocketEventComing = s2, o2;
  }
  return t(n2, e2), n2;
}(ie);
var io = function(e2) {
  function n2(t2) {
    var n3 = t2.reqId, i2 = t2.source, r2 = e2.call(this) || this;
    return r2.reqId = n3, r2.source = i2, r2;
  }
  return t(n2, e2), n2;
}(ie);
var ro = function(e2) {
  function n2(t2) {
    var n3 = t2.polls, i2 = t2.source, r2 = e2.call(this) || this;
    return r2.polls = n3, r2.source = i2, r2;
  }
  return t(n2, e2), n2;
}(ie);
var so = function(e2) {
  function n2(t2) {
    var n3 = t2.event, i2 = t2.source, r2 = e2.call(this) || this;
    return r2.event = n3, r2.source = i2, r2;
  }
  return t(n2, e2), n2;
}(ie);
var oo = function(e2) {
  function n2(t2) {
    var n3 = t2.event, i2 = t2.source, r2 = e2.call(this) || this;
    return r2.event = n3, r2.source = i2, r2;
  }
  return t(n2, e2), n2;
}(ie);
!function(e2) {
  e2.OPEN = "open", e2.CLOSED = "closed";
}(Ys || (Ys = {}));
var ao = "removed";
var co = function(e2) {
  switch (e2) {
    case "open":
      return Ys.OPEN;
    case "closed":
      return Ys.CLOSED;
    default:
      return null;
  }
};
var uo = function(e2) {
  return !e2 || !!e2.text && w("string", e2.text);
};
var lo = function(e2) {
  function i2(t2, n2) {
    var i3, r2, s2, o2, a2, c2, u2, l2 = this;
    return (l2 = e2.call(this, t2) || this).pollId = 0, l2.id = 0, l2.text = null, l2.voteCount = 0, l2.createdBy = null, l2.createdAt = 0, l2.updatedAt = 0, l2._lastVotedAt = 0, l2.pollId = null !== (i3 = n2.poll_id) && void 0 !== i3 ? i3 : 0, l2.id = null !== (r2 = n2.id) && void 0 !== r2 ? r2 : 0, l2.text = null !== (s2 = n2.text) && void 0 !== s2 ? s2 : null, l2.voteCount = null !== (o2 = n2.vote_count) && void 0 !== o2 ? o2 : 0, l2.createdBy = null !== (a2 = n2.created_by) && void 0 !== a2 ? a2 : null, l2.createdAt = null !== (c2 = n2.created_at) && void 0 !== c2 ? c2 : 0, l2.updatedAt = null !== (u2 = n2.updated_at) && void 0 !== u2 ? u2 : 0, l2;
  }
  return t(i2, e2), i2.payloadify = function(t2) {
    return re(se(n(n({}, e2.payloadify.call(this, t2)), { vote_count: t2.voteCount, poll_id: t2.pollId, text: t2.text, created_at: t2.createdAt, id: t2.id, created_by: t2.createdBy, updated_at: t2.updatedAt })));
  }, i2;
}(zr);
var ho = function(e2) {
  function i2(t2, n2) {
    var i3, r2, s2, o2, a2, c2, u2, l2, h2, d2, _2, f2, p2, E2 = this;
    return (E2 = e2.call(this, t2) || this).id = 0, E2.title = null, E2.createdAt = 0, E2.updatedAt = 0, E2.closeAt = -1, E2.status = Ys.CLOSED, E2.messageId = 0, E2.data = null, E2.voterCount = -1, E2.options = [], E2.createdBy = null, E2.allowUserSuggestion = false, E2.allowMultipleVotes = false, E2.votedPollOptionIds = [], E2.id = null !== (i3 = n2.id) && void 0 !== i3 ? i3 : 0, E2.title = null !== (r2 = n2.title) && void 0 !== r2 ? r2 : null, E2.createdAt = null !== (s2 = n2.created_at) && void 0 !== s2 ? s2 : 0, E2.updatedAt = null !== (o2 = n2.updated_at) && void 0 !== o2 ? o2 : 0, E2.closeAt = null !== (a2 = n2.close_at) && void 0 !== a2 ? a2 : -1, E2.status = null !== (c2 = co(n2.status)) && void 0 !== c2 ? c2 : Ys.CLOSED, E2.messageId = null !== (u2 = n2.message_id) && void 0 !== u2 ? u2 : 0, E2.data = null !== (l2 = n2.data) && void 0 !== l2 ? l2 : null, E2.voterCount = null !== (h2 = n2.voter_count) && void 0 !== h2 ? h2 : -1, E2.options = n2.options ? n2.options.map(function(e3) {
      return new lo(E2._iid, e3);
    }) : [], E2.createdBy = null !== (d2 = n2.created_by) && void 0 !== d2 ? d2 : null, E2.allowUserSuggestion = null !== (_2 = n2.allow_user_suggestion) && void 0 !== _2 && _2, E2.allowMultipleVotes = null !== (f2 = n2.allow_multiple_votes) && void 0 !== f2 && f2, E2.votedPollOptionIds = null !== (p2 = n2.voted_option_ids) && void 0 !== p2 ? p2 : [], E2;
  }
  return t(i2, e2), i2.prototype._applyPollUpdatePayload = function(e3) {
    var t2, n2, i3, r2, s2, o2, a2, c2, u2 = this;
    this.title = null !== (t2 = e3.title) && void 0 !== t2 ? t2 : this.title, this.updatedAt = null !== (n2 = e3.updated_at) && void 0 !== n2 ? n2 : this.updatedAt, this.closeAt = null !== (i3 = e3.close_at) && void 0 !== i3 ? i3 : this.closeAt, this.status = null !== (r2 = co(e3.status)) && void 0 !== r2 ? r2 : this.status, this.data = null !== (s2 = e3.data) && void 0 !== s2 ? s2 : this.data, this.voterCount = null !== (o2 = e3.voter_count) && void 0 !== o2 ? o2 : this.voterCount, e3.options && (this.options = e3.options.map(function(e4) {
      return new lo(u2._iid, e4);
    }), this.votedPollOptionIds = e3.options.filter(function(e4) {
      return e4.vote_count > 0;
    }).map(function(e4) {
      return e4.id;
    })), this.allowUserSuggestion = null !== (a2 = e3.allow_user_suggestion) && void 0 !== a2 ? a2 : this.allowUserSuggestion, this.allowMultipleVotes = null !== (c2 = e3.allow_multiple_votes) && void 0 !== c2 ? c2 : this.allowMultipleVotes;
  }, i2.payloadify = function(t2) {
    return re(se(n(n({}, e2.payloadify.call(this, t2)), { id: t2.id, title: t2.title, created_at: t2.createdAt, updated_at: t2.updatedAt, close_at: t2.closeAt, status: t2.status, message_id: t2.messageId, data: t2.data, voter_count: t2.voterCount, options: t2.options.map(function(e3) {
      return lo.payloadify(e3);
    }), created_by: t2.createdBy, allow_user_suggestion: t2.allowUserSuggestion, allow_multiple_votes: t2.allowMultipleVotes, voted_option_ids: t2.votedPollOptionIds })));
  }, i2.prototype.applyPollUpdateEvent = function(e3) {
    var t2 = e3._payload.poll;
    return !(!t2 || this.id !== t2.id || t2.updated_at < this.updatedAt) && (this._applyPollUpdatePayload(t2), true);
  }, i2.prototype.applyPollVoteEvent = function(e3) {
    if (this.id !== e3.pollId) return false;
    var t2 = this.options, n2 = t2.map(function(e4) {
      return e4.id;
    }), i3 = e3._payload, r2 = Math.floor(i3.ts / 1e3);
    return i3.updated_vote_counts.forEach(function(e4) {
      var i4 = n2.indexOf(e4.option_id);
      if (i4 > -1) {
        var s2 = t2[i4];
        r2 >= s2._lastVotedAt && (s2.voteCount = e4.vote_count, s2._lastVotedAt = r2);
      }
    }), i3.req_id && i3.voted_option_ids && (this.votedPollOptionIds = i3.voted_option_ids), "number" == typeof i3.voter_count && (this.voterCount = i3.voter_count), true;
  }, i2.prototype.serialize = function() {
    return Yr(this);
  }, i2;
}(zr);
var _o = function() {
  function e2(e3, t2) {
    var n2;
    this.limit = 20, this._isLoading = false, this._hasNext = true, this._token = "", this._iid = e3, this.limit = null !== (n2 = t2.limit) && void 0 !== n2 ? n2 : 20;
  }
  return Object.defineProperty(e2.prototype, "hasNext", { get: function() {
    return this._hasNext;
  }, enumerable: false, configurable: true }), Object.defineProperty(e2.prototype, "isLoading", { get: function() {
    return this._isLoading;
  }, enumerable: false, configurable: true }), e2.prototype._validate = function() {
    return w("number", this.limit) && this.limit > 0;
  }, e2;
}();
var fo = function(e2) {
  function n2(t2, n3, i2, r2) {
    var s2 = e2.call(this, t2, r2) || this;
    return s2.channelUrl = n3, s2.channelType = i2, s2;
  }
  return t(n2, e2), n2.prototype._validate = function() {
    return e2.prototype._validate.call(this) && w("string", this.channelUrl) && S(q, this.channelType);
  }, n2;
}(_o);
var po = function(e2) {
  this.pollId = 0, this.messageId = 0, this.pollId = e2.poll_id, this.messageId = e2.message_id, this._payload = e2;
};
var Eo = function(e2) {
  function n2(t2) {
    var n3 = t2.title, i2 = t2.optionTexts, r2 = t2.data, s2 = t2.allowUserSuggestion, o2 = t2.allowMultipleVotes, a2 = t2.closeAt, c2 = e2.call(this) || this;
    return c2.method = oe.POST, c2.path = be, c2.params = { title: n3, options: i2, data: r2, allow_user_suggestion: s2, allow_multiple_votes: o2, close_at: a2 }, c2;
  }
  return t(n2, e2), n2;
}(xe);
var go = function(e2) {
  function n2(t2, n3) {
    var i2 = e2.call(this, t2, n3) || this;
    return i2.poll = new ho(t2, n3), i2;
  }
  return t(n2, e2), n2;
}(Ue);
var vo = function(e2) {
  function n2(t2) {
    var n3 = t2.channelUrl, i2 = t2.channelType, r2 = t2.pollId, s2 = e2.call(this) || this;
    return s2.method = oe.GET, s2.path = "".concat(be, "/").concat(encodeURIComponent(r2)), s2.params = { channel_url: n3, channel_type: i2 }, s2;
  }
  return t(n2, e2), n2;
}(xe);
var bo = function(e2) {
  function n2(t2, n3) {
    var i2 = e2.call(this, t2, n3) || this;
    return i2.poll = new ho(t2, n3), i2;
  }
  return t(n2, e2), n2;
}(Ue);
var mo = function(e2) {
  function n2(t2) {
    var n3 = t2.channelUrl, i2 = t2.channelType, r2 = t2.pollId, s2 = t2.pollOptionId, o2 = e2.call(this) || this;
    return o2.method = oe.GET, o2.path = "".concat(be, "/").concat(encodeURIComponent(r2), "/options/").concat(encodeURIComponent(s2)), o2.params = { channel_url: n3, channel_type: i2 }, o2;
  }
  return t(n2, e2), n2;
}(xe);
var yo = function(e2) {
  function n2(t2, n3) {
    var i2 = e2.call(this, t2, n3) || this;
    return i2.pollOption = new lo(t2, n3), i2;
  }
  return t(n2, e2), n2;
}(Ue);
var wo = function(e2) {
  function n2(t2) {
    var n3 = t2.channelType, i2 = t2.channelUrl, r2 = t2.timestamp, s2 = t2.token, o2 = e2.call(this) || this;
    return o2.method = oe.GET, o2.path = "".concat(Ie(n3), "/").concat(encodeURIComponent(i2), "/polls/changelogs"), o2.params = re({ change_ts: r2, token: s2 }), o2;
  }
  return t(n2, e2), n2;
}(xe);
var So = function(e2) {
  function n2(t2, n3) {
    var i2 = e2.call(this, t2, n3) || this;
    return i2.updatedPolls = n3.updated.map(function(e3) {
      return function(e4, t3) {
        return new ho(e4, t3);
      }(t2, e3);
    }), i2.deletedPollIds = n3.deleted.map(function(e3) {
      return e3;
    }), i2.hasMore = n3.has_more, i2.nextToken = n3.next, i2;
  }
  return t(n2, e2), n2;
}(Ue);
var To = { title: "", optionTexts: [], data: void 0, allowUserSuggestion: void 0, allowMultipleVotes: void 0, closeAt: -1 };
var No = function(e2) {
  return w("string", e2.title) && (t2 = e2.optionTexts, N("string", t2) && t2.every(function(e3) {
    return "" !== e3.trim();
  })) && uo(e2.data) && w("boolean", e2.allowUserSuggestion, true) && w("boolean", e2.allowMultipleVotes, true) && w("number", e2.closeAt, true);
  var t2;
};
var Co = { channelUrl: "", channelType: q.BASE, pollId: 0, pollOptionId: 0 };
var Ao = function(e2) {
  return w("string", e2.channelUrl) && "" !== e2.channelUrl && S(q, e2.channelType) && w("number", e2.pollId) && e2.pollId > 0 && w("number", e2.pollOptionId) && e2.pollOptionId > 0;
};
var Io = { channelUrl: "", channelType: q.BASE, pollId: 0 };
var ko = function(e2) {
  return w("string", e2.channelUrl) && "" !== e2.channelUrl && S(q, e2.channelType) && w("number", e2.pollId);
};
var Oo = {};
var Do = function() {
  function e2(e3, t2) {
    var n2 = t2.sdkState, i2 = t2.dispatcher, r2 = t2.sessionManager, s2 = t2.requestQueue, o2 = t2.logger;
    this._iid = e3, this._sdkState = n2, this._sessionManager = r2, this._requestQueue = s2, this._dispatcher = i2, this._logger = o2, Oo[e3] = this;
  }
  return e2.of = function(e3) {
    return Oo[e3];
  }, e2.prototype.buildPollFromSerializedData = function(e3) {
    var t2 = Xr(e3);
    return new ho(this._iid, ho.payloadify(t2));
  }, e2.prototype.get = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, i2;
      return s(this, function(r2) {
        switch (r2.label) {
          case 0:
            return Jr(ko(e3)).throw(v.invalidParameters), t2 = new vo(n({}, e3)), [4, this._requestQueue.send(t2)];
          case 1:
            return i2 = r2.sent(), [2, i2.as(bo).poll];
        }
      });
    });
  }, e2.prototype.create = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, i2;
      return s(this, function(r2) {
        switch (r2.label) {
          case 0:
            return Jr(No(e3)).throw(v.invalidParameters), t2 = new Eo(n({}, e3)), [4, this._requestQueue.send(t2)];
          case 1:
            return i2 = r2.sent(), [2, i2.as(go).poll];
        }
      });
    });
  }, e2.prototype.getOption = function(e3) {
    return r(this, void 0, void 0, function() {
      var t2, i2;
      return s(this, function(r2) {
        switch (r2.label) {
          case 0:
            return Jr(Ao(e3)).throw(v.invalidParameters), t2 = new mo(n({}, e3)), [4, this._requestQueue.send(t2)];
          case 1:
            return i2 = r2.sent(), [2, i2.as(yo).pollOption];
        }
      });
    });
  }, e2.prototype.getPollChangeLogs = function(e3, t2, n2, i2) {
    return void 0 === i2 && (i2 = Ks.SYNC_POLL_CHANGELOGS), r(this, void 0, void 0, function() {
      var r2, o2, a2, c2, u2, l2, h2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return r2 = new wo(se({ channelType: t2, channelUrl: e3, timestamp: "number" == typeof n2 ? n2 : null, token: "string" == typeof n2 ? n2 : null })), [4, this._requestQueue.send(r2)];
          case 1:
            return o2 = s2.sent(), a2 = o2.as(So), c2 = a2.updatedPolls, u2 = a2.deletedPollIds, l2 = a2.hasMore, h2 = a2.nextToken, c2.length > 0 && this._dispatcher.dispatch(new ro({ polls: c2, source: i2 })), [2, { updatedPolls: c2, deletedPollIds: u2, hasMore: l2, token: h2 }];
        }
      });
    });
  }, e2;
}();
var Ro = function(e2) {
  function n2(t2) {
    var n3 = t2.channelUrl, i2 = t2.channelType, r2 = t2.token, s2 = t2.limit, o2 = e2.call(this) || this;
    return o2.method = oe.GET, o2.path = be, o2.params = { channel_url: n3, channel_type: i2, token: r2, limit: s2 }, o2;
  }
  return t(n2, e2), n2;
}(xe);
var Lo = function(e2) {
  function n2(t2, n3) {
    var i2, r2 = this;
    return (r2 = e2.call(this, t2, n3) || this).polls = (null !== (i2 = n3.polls) && void 0 !== i2 ? i2 : []).map(function(e3) {
      return new ho(t2, e3);
    }), r2.token = n3.next, r2;
  }
  return t(n2, e2), n2;
}(Ue);
var xo = function(e2) {
  function i2(t2, n2) {
    return e2.call(this, t2, n2.channelUrl, n2.channelType, n2) || this;
  }
  return t(i2, e2), i2.prototype.next = function() {
    return r(this, void 0, void 0, function() {
      var e3, t2, i3, r2, o2, a2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = true, e3 = Ws.of(this._iid).requestQueue, t2 = new Ro(n(n({}, this), { token: this._token })), [4, e3.send(t2)]) : [3, 2] : [3, 5];
          case 1:
            return i3 = s2.sent(), r2 = i3.as(Lo), o2 = r2.polls, a2 = r2.token, this._token = a2, this._hasNext = !!a2, this._isLoading = false, [2, o2];
          case 2:
            return [2, []];
          case 3:
            throw v.queryInProgress;
          case 4:
            return [3, 6];
          case 5:
            throw v.invalidParameters;
          case 6:
            return [2];
        }
      });
    });
  }, i2;
}(fo);
var Uo = function(e2) {
  function n2(t2) {
    var n3 = t2.channelUrl, i2 = t2.channelType, r2 = t2.pollId, s2 = t2.pollOptionId, o2 = t2.token, a2 = t2.limit, c2 = e2.call(this) || this;
    return c2.method = oe.GET, c2.path = "".concat(be, "/").concat(encodeURIComponent(r2), "/options/").concat(encodeURIComponent(s2), "/voters"), c2.params = { channel_url: n3, channel_type: i2, token: o2, limit: a2 }, c2;
  }
  return t(n2, e2), n2;
}(xe);
var Po = function(e2) {
  function n2(t2, n3) {
    var i2, r2 = this;
    return (r2 = e2.call(this, t2, n3) || this).voters = (null !== (i2 = n3.voters) && void 0 !== i2 ? i2 : []).map(function(e3) {
      return new es(t2, e3);
    }), r2.token = n3.next, r2;
  }
  return t(n2, e2), n2;
}(Ue);
var Mo = function(e2) {
  function i2(t2, n2) {
    var i3 = e2.call(this, t2, n2.channelUrl, n2.channelType, n2) || this;
    return i3.pollId = n2.pollId, i3.pollOptionId = n2.pollOptionId, i3;
  }
  return t(i2, e2), i2.prototype._validate = function() {
    return e2.prototype._validate.call(this) && w("number", this.pollId) && w("number", this.pollOptionId);
  }, i2.prototype.next = function() {
    return r(this, void 0, void 0, function() {
      var e3, t2, i3, r2, o2, a2;
      return s(this, function(s2) {
        switch (s2.label) {
          case 0:
            return this._validate() ? this._isLoading ? [3, 3] : this._hasNext ? (this._isLoading = true, e3 = Ws.of(this._iid).requestQueue, t2 = new Uo(n(n({}, this), { pollId: this.pollId, pollOptionId: this.pollOptionId, token: this._token })), [4, e3.send(t2)]) : [3, 2] : [3, 5];
          case 1:
            return i3 = s2.sent(), r2 = i3.as(Po), o2 = r2.voters, a2 = r2.token, this._token = a2, this._hasNext = !!a2, this._isLoading = false, [2, o2];
          case 2:
            return [2, []];
          case 3:
            throw v.queryInProgress;
          case 4:
            return [3, 6];
          case 5:
            throw v.invalidParameters;
          case 6:
            return [2];
        }
      });
    });
  }, i2;
}(fo);

export {
  t,
  n,
  i,
  r,
  s,
  o,
  a,
  c,
  u,
  l,
  d,
  _,
  f,
  p,
  g,
  v,
  y,
  w,
  S,
  N,
  C,
  A,
  I,
  k,
  O,
  R,
  L,
  P,
  M,
  F,
  q,
  V,
  H,
  z,
  G,
  j,
  K,
  B,
  Q,
  W,
  Y,
  X,
  $,
  te,
  ie,
  re,
  se,
  oe,
  ce,
  le,
  he,
  de,
  _e,
  fe,
  pe,
  Ee,
  ge,
  ve,
  be,
  me,
  ye,
  Ne,
  Ce,
  Ae,
  Ie,
  ke,
  Oe,
  De,
  Le,
  xe,
  Ue,
  Me,
  Fe,
  qe,
  Ve,
  Ke,
  Be,
  Qe,
  We,
  Ze,
  Ye,
  Je,
  et,
  tt,
  nt,
  it,
  st,
  mr,
  Sr,
  Nr,
  Ar,
  Ir,
  kr,
  xr,
  Vr,
  zr,
  Yr,
  Xr,
  Jr,
  es,
  ts,
  ns,
  os,
  as,
  hs,
  _s,
  Ps,
  qs,
  Ks,
  Ws,
  Zs,
  Js,
  $s,
  eo,
  to,
  no,
  io,
  ro,
  so,
  oo,
  ao,
  co,
  uo,
  ho,
  _o,
  fo,
  po,
  To,
  No,
  Co,
  Ao,
  Io,
  ko,
  Do,
  xo,
  Mo
};
//# sourceMappingURL=chunk-OQ72IX5E.js.map
