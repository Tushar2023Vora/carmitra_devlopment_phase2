import {
  Ke,
  Me,
  Ue,
  Ve,
  Ws,
  et,
  tt,
  v
} from "./chunk-OQ72IX5E.js";
import "./chunk-2TUXWMP5.js";

// node_modules/@sendbird/chat/lib/__bundle-91b5ecea.js
var i = function(i2, u) {
  return new Promise(function(c, p) {
    if ("undefined" != typeof XMLHttpRequest) {
      var f = Ws.of(i2), l = f.dispatcher, g = f.logger, h = u.requestId, m = u.method, q = u.url, v2 = u.headers, w = void 0 === v2 ? {} : v2, b = u.data, E = void 0 === b ? "" : b, x = u.uploadProgressHandler, y = false, H = new XMLHttpRequest();
      H.open(m, q), Object.keys(w).forEach(function(e) {
        H.setRequestHeader(e, w[e]);
      }), x && H.upload.addEventListener("progress", function(e) {
        e.lengthComputable ? x(h, e.loaded, e.total) : g.debug("Progress computing failed: `Content-Length` header is not given.");
      }), H.onabort = function() {
        p(v.requestCanceled);
      }, H.onerror = function(e) {
        p(v.networkError);
      }, H.onreadystatechange = function() {
        if (H.readyState === XMLHttpRequest.DONE && !y) if (0 === H.status || H.status >= 200 && H.status < 400) try {
          var e = JSON.parse(H.responseText);
          c(new Ue(i2, e));
        } catch (u3) {
          p(v.networkError);
        }
        else try {
          var d = JSON.parse(H.responseText);
          if (d) {
            var u2 = new v(d);
            if (u2.isSessionExpiredError) {
              if (l.dispatch(new Me({ reason: u2.code, message: u2.message })), !(H instanceof Ve)) {
                var f2 = new et();
                return l.dispatch(new Ke({ request: H, deferred: f2, error: u2 })), f2.promise;
              }
            } else u2.isSessionInvalidatedError && l.dispatch(new Me({ reason: u2.code, message: u2.message }));
            p(u2);
          } else p(v.requestFailed);
        } catch (u3) {
          p(v.requestFailed);
        }
      }, l.on(function(e) {
        e instanceof tt && (e.requestId && e.requestId !== h || (y = true, H.abort()));
      }), H.send(E);
    } else p(v.xmlHttpRequestNotSupported);
  });
};
export {
  i as xmlHttpRequest
};
//# sourceMappingURL=__bundle-91b5ecea-WUMNPU6A.js.map
